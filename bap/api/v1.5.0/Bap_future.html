<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Ogre.html">
<link rel="next" href="Graphlib.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class attributes" rel=Appendix href="index_attributes.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of class types" rel=Appendix href="index_class_types.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Bap" rel="Chapter" href="Bap.html">
<link title="Bap_bundle" rel="Chapter" href="Bap_bundle.html">
<link title="Bap_config" rel="Chapter" href="Bap_config.html">
<link title="Core_printers" rel="Chapter" href="Core_printers.html">
<link title="Bap_plugins" rel="Chapter" href="Bap_plugins.html">
<link title="Regular" rel="Chapter" href="Regular.html">
<link title="Monads" rel="Chapter" href="Monads.html">
<link title="Ogre" rel="Chapter" href="Ogre.html">
<link title="Bap_future" rel="Chapter" href="Bap_future.html">
<link title="Graphlib" rel="Chapter" href="Graphlib.html">
<link title="Bap_taint" rel="Chapter" href="Bap_taint.html">
<link title="Bap_primus" rel="Chapter" href="Bap_primus.html">
<link title="Bare" rel="Chapter" href="Bare.html">
<link title="Arm_insn" rel="Chapter" href="Arm_insn.html">
<link title="Arm_mul" rel="Chapter" href="Arm_mul.html">
<link title="Arm_utils" rel="Chapter" href="Arm_utils.html">
<link title="Arm_mem_shift" rel="Chapter" href="Arm_mem_shift.html">
<link title="Arm_flags" rel="Chapter" href="Arm_flags.html">
<link title="Arm_env" rel="Chapter" href="Arm_env.html">
<link title="Arm_mem" rel="Chapter" href="Arm_mem.html">
<link title="Arm_op" rel="Chapter" href="Arm_op.html">
<link title="Arm_bit" rel="Chapter" href="Arm_bit.html">
<link title="Arm_branch" rel="Chapter" href="Arm_branch.html">
<link title="ARM" rel="Chapter" href="ARM.html">
<link title="Arm_shift" rel="Chapter" href="Arm_shift.html">
<link title="Arm_mov" rel="Chapter" href="Arm_mov.html">
<link title="Arm_cond" rel="Chapter" href="Arm_cond.html">
<link title="Arm_types" rel="Chapter" href="Arm_types.html">
<link title="Arm_reg" rel="Chapter" href="Arm_reg.html">
<link title="Arm_helpers" rel="Chapter" href="Arm_helpers.html">
<link title="Arm_lifter" rel="Chapter" href="Arm_lifter.html">
<link title="X86_asm_reg" rel="Chapter" href="X86_asm_reg.html">
<link title="X86_types" rel="Chapter" href="X86_types.html">
<link title="X86_env" rel="Chapter" href="X86_env.html">
<link title="X86_llvm_env" rel="Chapter" href="X86_llvm_env.html">
<link title="X86_asm" rel="Chapter" href="X86_asm.html">
<link title="X86_cpu" rel="Chapter" href="X86_cpu.html">
<link title="X86_asm_reg_types" rel="Chapter" href="X86_asm_reg_types.html">
<link title="Bap_api" rel="Chapter" href="Bap_api.html">
<link title="Bap_abi" rel="Chapter" href="Bap_abi.html">
<link title="Bap_c_type" rel="Chapter" href="Bap_c_type.html">
<link title="Bap_c_data" rel="Chapter" href="Bap_c_data.html">
<link title="Bap_c_attr" rel="Chapter" href="Bap_c_attr.html">
<link title="Bap_c_type_mapper_intf" rel="Chapter" href="Bap_c_type_mapper_intf.html">
<link title="Bap_c_type_printer" rel="Chapter" href="Bap_c_type_printer.html">
<link title="Bap_c_term_attributes" rel="Chapter" href="Bap_c_term_attributes.html">
<link title="Bap_c_abi" rel="Chapter" href="Bap_c_abi.html">
<link title="Bap_c_type_mapper" rel="Chapter" href="Bap_c_type_mapper.html">
<link title="Bap_c" rel="Chapter" href="Bap_c.html">
<link title="Bap_c_parser" rel="Chapter" href="Bap_c_parser.html">
<link title="Bap_c_size" rel="Chapter" href="Bap_c_size.html">
<link title="Bap_bml" rel="Chapter" href="Bap_bml.html">
<link title="Bap_build" rel="Chapter" href="Bap_build.html">
<link title="Bap_byteweight_signatures" rel="Chapter" href="Bap_byteweight_signatures.html">
<link title="Bap_byteweight" rel="Chapter" href="Bap_byteweight.html">
<link title="Bap_demangle" rel="Chapter" href="Bap_demangle.html">
<link title="Bap_dwarf" rel="Chapter" href="Bap_dwarf.html">
<link title="Bap_ida" rel="Chapter" href="Bap_ida.html">
<link title="Bap_llvm" rel="Chapter" href="Bap_llvm.html">
<link title="Bap_llvm_loader" rel="Chapter" href="Bap_llvm_loader.html">
<link title="Bap_traces" rel="Chapter" href="Bap_traces.html">
<link title="Bap_strings_index" rel="Chapter" href="Bap_strings_index.html">
<link title="Bap_strings_scanner" rel="Chapter" href="Bap_strings_scanner.html">
<link title="Bap_strings" rel="Chapter" href="Bap_strings.html">
<link title="Bap_strings_detector" rel="Chapter" href="Bap_strings_detector.html">
<link title="Bap_strings_unscrambler" rel="Chapter" href="Bap_strings_unscrambler.html">
<link title="Text_tags" rel="Chapter" href="Text_tags.html"><title>BAR: BAP Annotated Reference : Bap_future</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Ogre.html" title="Ogre">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Graphlib.html" title="Graphlib">Next</a>
</div>
<h1>Module <a href="type_Bap_future.html">Bap_future</a></h1>

<pre><span class="keyword">module</span> Bap_future: <code class="code"><span class="keyword">sig</span></code> <a href="Bap_future.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
Future library.
<p>

    <h1 id="1_Overview">Overview</h1>
<p>

    The purpose of the library is to provide mechanisms for reasoning
    about state based dynamic system. Due to a separation of concerns,
    the library allows to reason about such system purely
    mathematically, without any dependency on the actual
    representation of the state, or how the dynamism is
    handled. Putting it more simple, the library allows to reason
    about mathematical objects, whose value changes with time.  Such
    objects, are usually model some complex systems with a hidden
    state, that can be only observed. This kind of systems is hard and
    practically impossible to describe using inductive types. We reify
    such systems with coinduction. The library defines two main
    coinductive types: <code class="code">future</code> and <code class="code">stream</code>. The <code class="code">future</code> type is
    dual of the option type (a co-option), and <code class="code">stream</code> is a dual of
    the list (co-list).
<p>

    A value of type <code class="code">future</code> is an object, with some observable state,
    that is not yet defined. We know, that it might happen, but it is not
    guaranteed. The <code class="code">future</code> can be defined only once. Once it is
    defined, it cannot be changed. Basically, the time line of the
    <code class="code">future</code> object is separated into two phases: on a first phase the
    value of the object is undefined, and on the second it is defined
    and fixed. Both phases can be empty, i.e., an object can be
    brought into life with a defined value, and an undefined future,
    might be never defined.
<p>

    A value of type <code class="code">stream</code> is an infinite sequence of finite
    values. More precisely, a stream can be viewed as an object, whose
    value varies in time.
<p>

    The library can be also seen as a common denominator between
    different async libraries and methods, e.g., lwt, async, threads,
    forthcoming effective programming in multicore OCaml, etc. For
    example, the <code class="code">future</code> are quite similar to the <code class="code"><span class="constructor">Lwt</span>.t</code> in <code class="code"><span class="constructor">Lwt</span></code>
    library and to the <code class="code"><span class="constructor">Deferred</span>.t</code> of the <code class="code"><span class="constructor">Async</span></code> library. There are
    few differences, however. The <code class="code">future</code> library tries to separate
    concerns, so unlike <code class="code"><span class="constructor">Lwt</span></code> or <code class="code"><span class="constructor">Async</span></code> libraries, future can't fail.
    In other words, if a computation that computes the <code class="code">future</code> fails,
    that just means, that this particular future has never
    occurred. If a user wants to represent a future value, that can
    fail or succeed, that he is welcome to use sum types, e.g.,
    <code class="code">(<span class="keywordsign">'</span>a,<span class="keywordsign">'</span>b)&nbsp;<span class="constructor">Result</span>.t&nbsp;future</code>. The same is true for the async library.
<p>

    <h1 id="1_Notionoftime">Notion of time</h1>
<p>

    The future library handles time in a special way. The notion of
    physical time is replaced with the notion of order. We consider
    only the precedence of events. There is no notion of simultaneity
    built into the model of the library. Every event occurs in its own
    separate time slot, i.e., all events are serialized in the time.
<p>

    That is not to say, that simultaneous events are not
    representable. The library just allows a user, to engineer its own
    timescale and define, what is simultaneous and what is not. For
    example, a clock timer can be represented as a stream of seconds,
    and everything that occurs after the start of the <code class="code">n</code>'th second,
    but before the start of the <code class="code">n+1</code>'th second, is simultaneous.
<p>

    <h1 id="1_Mainloop">Main-loop</h1>
<p>

    Since the internal state of the dynamic system is usually
    impossible to represent, it is modeled by a notion of primitive
    signals and promises. When a future is created a corresponding
    promise is made. The system, that models the dynamic system is
    responsible to fulfill the promise. A signal is akin to the
    promise, with only difference, that it can (and should) be
    fulfilled, or signaled, more than once.
<p>

    The use of promises and signals is totally under a user control
    and is separated from the rest of the library. They can be
    signaled from event loops, such as Lwt or Async main loops, or from
    a window system event loop. The only requirement, is that this
    calls should be serialized, if it is possible that they are made
    from different threads.
<p>

    A common way to bind <code class="code"><span class="constructor">Lwt</span></code> thread with <code class="code"><span class="constructor">Future</span></code> is to use
    <code class="code">on_success</code> function (or <code class="code">upon</code> function for <code class="code"><span class="constructor">Async</span></code>'s <code class="code"><span class="constructor">Deferred</span></code>):
<p>

    <pre class="codepre"><code class="code">      <span class="keyword">let</span> future_of_thread t =
        <span class="keyword">let</span> future,promise = <span class="constructor">Future</span>.create () <span class="keyword">in</span>
        <span class="constructor">Lwt</span>.on_success t (<span class="constructor">Promise</span>.fulfill promise);
        future
    </code></pre><br>
</div>
<hr width="100%">

<pre><span class="keyword">module</span> <a href="Bap_future.Std.html">Std</a>: <code class="code"><span class="keyword">sig</span></code> <a href="Bap_future.Std.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Future library.
</div>
</body></html>