<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Bap_strings.html">
<link rel="next" href="Bap_strings_unscrambler.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of class types" rel=Appendix href="index_class_types.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Bap" rel="Chapter" href="Bap.html">
<link title="Bap_bundle" rel="Chapter" href="Bap_bundle.html">
<link title="Bap_config" rel="Chapter" href="Bap_config.html">
<link title="Core_printers" rel="Chapter" href="Core_printers.html">
<link title="Bap_plugins" rel="Chapter" href="Bap_plugins.html">
<link title="Regular" rel="Chapter" href="Regular.html">
<link title="Monads" rel="Chapter" href="Monads.html">
<link title="Ogre" rel="Chapter" href="Ogre.html">
<link title="Bap_future" rel="Chapter" href="Bap_future.html">
<link title="Graphlib" rel="Chapter" href="Graphlib.html">
<link title="Bap_taint" rel="Chapter" href="Bap_taint.html">
<link title="Bap_primus" rel="Chapter" href="Bap_primus.html">
<link title="Bare" rel="Chapter" href="Bare.html">
<link title="Arm_insn" rel="Chapter" href="Arm_insn.html">
<link title="Arm_mul" rel="Chapter" href="Arm_mul.html">
<link title="Arm_utils" rel="Chapter" href="Arm_utils.html">
<link title="Arm_mem_shift" rel="Chapter" href="Arm_mem_shift.html">
<link title="Arm_flags" rel="Chapter" href="Arm_flags.html">
<link title="Arm_env" rel="Chapter" href="Arm_env.html">
<link title="Arm_mem" rel="Chapter" href="Arm_mem.html">
<link title="Arm_op" rel="Chapter" href="Arm_op.html">
<link title="Arm_bit" rel="Chapter" href="Arm_bit.html">
<link title="Arm_branch" rel="Chapter" href="Arm_branch.html">
<link title="ARM" rel="Chapter" href="ARM.html">
<link title="Arm_shift" rel="Chapter" href="Arm_shift.html">
<link title="Arm_mov" rel="Chapter" href="Arm_mov.html">
<link title="Arm_cond" rel="Chapter" href="Arm_cond.html">
<link title="Arm_types" rel="Chapter" href="Arm_types.html">
<link title="Arm_reg" rel="Chapter" href="Arm_reg.html">
<link title="Arm_helpers" rel="Chapter" href="Arm_helpers.html">
<link title="Arm_lifter" rel="Chapter" href="Arm_lifter.html">
<link title="X86_asm_reg" rel="Chapter" href="X86_asm_reg.html">
<link title="X86_types" rel="Chapter" href="X86_types.html">
<link title="X86_env" rel="Chapter" href="X86_env.html">
<link title="X86_llvm_env" rel="Chapter" href="X86_llvm_env.html">
<link title="X86_asm" rel="Chapter" href="X86_asm.html">
<link title="X86_cpu" rel="Chapter" href="X86_cpu.html">
<link title="X86_asm_reg_types" rel="Chapter" href="X86_asm_reg_types.html">
<link title="Bap_api" rel="Chapter" href="Bap_api.html">
<link title="Bap_abi" rel="Chapter" href="Bap_abi.html">
<link title="Bap_c_type" rel="Chapter" href="Bap_c_type.html">
<link title="Bap_c_data" rel="Chapter" href="Bap_c_data.html">
<link title="Bap_c_attr" rel="Chapter" href="Bap_c_attr.html">
<link title="Bap_c_type_mapper_intf" rel="Chapter" href="Bap_c_type_mapper_intf.html">
<link title="Bap_c_type_printer" rel="Chapter" href="Bap_c_type_printer.html">
<link title="Bap_c_term_attributes" rel="Chapter" href="Bap_c_term_attributes.html">
<link title="Bap_c_abi" rel="Chapter" href="Bap_c_abi.html">
<link title="Bap_c_type_mapper" rel="Chapter" href="Bap_c_type_mapper.html">
<link title="Bap_c" rel="Chapter" href="Bap_c.html">
<link title="Bap_c_parser" rel="Chapter" href="Bap_c_parser.html">
<link title="Bap_c_size" rel="Chapter" href="Bap_c_size.html">
<link title="Bap_bml" rel="Chapter" href="Bap_bml.html">
<link title="Bap_build" rel="Chapter" href="Bap_build.html">
<link title="Bap_byteweight_signatures" rel="Chapter" href="Bap_byteweight_signatures.html">
<link title="Bap_byteweight" rel="Chapter" href="Bap_byteweight.html">
<link title="Bap_demangle" rel="Chapter" href="Bap_demangle.html">
<link title="Bap_dwarf" rel="Chapter" href="Bap_dwarf.html">
<link title="Bap_ida" rel="Chapter" href="Bap_ida.html">
<link title="Bap_llvm" rel="Chapter" href="Bap_llvm.html">
<link title="Bap_llvm_loader" rel="Chapter" href="Bap_llvm_loader.html">
<link title="Bap_traces" rel="Chapter" href="Bap_traces.html">
<link title="Bap_strings_index" rel="Chapter" href="Bap_strings_index.html">
<link title="Bap_strings_scanner" rel="Chapter" href="Bap_strings_scanner.html">
<link title="Bap_strings" rel="Chapter" href="Bap_strings.html">
<link title="Bap_strings_detector" rel="Chapter" href="Bap_strings_detector.html">
<link title="Bap_strings_unscrambler" rel="Chapter" href="Bap_strings_unscrambler.html">
<link title="Text_tags" rel="Chapter" href="Text_tags.html"><title>BAR: BAP Annotated Reference : Bap_strings_detector</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Bap_strings.html" title="Bap_strings">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Bap_strings_unscrambler.html" title="Bap_strings_unscrambler">Next</a>
</div>
<h1>Module <a href="type_Bap_strings_detector.html">Bap_strings_detector</a></h1>

<pre><span class="keyword">module</span> Bap_strings_detector: <code class="code"><span class="keyword">sig</span></code> <a href="Bap_strings_detector.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
String computation detector.
<p>

    The detector uses maximum aposteriori likelihood estimator (MAP)
    to detect code that operates with textual data.
<p>

    We define textual data as a contigious blocks of characters from
    a specified alphabet.
<p>

    In our model a code is a sequence of instructions. Each
    instruction reads or writes characters. We're observing a set of
    characters accessed by an instruction (without any distinguishing
    whether it was a write or a read operation). The characters are
    produced by unknown values that are used during the
    computation. Some of these values are textual data. Any particular
    instruction either works with data produced by textual values or
    not. Moreover, we're looking for contigious sequences of
    instructions that work with textual value.
<p>

    The detector doesn't depend on a particular instruction
    implementation, instead it should be called after each instruction
    (or whatever granularity a user prefers) with a sequence of
    characters that were observed on that step.
<p>

    The detector distinguishes between two competing hypotheses. The
    null hypothesis is that we are observing a subsequence of
    instructions that doesn't interact with textual values. The
    alternative hypothesis states that the observed subsequence
    operates with one or more textual values.
<p>

    The detector operates in two different modes. In the search mode
    it looks for a subsequence that operates with textual values. Once
    it is found it switches to the second mode, and tries to find the
    end of this sequence, under an assumption that textual values have
    finite lengths. At the second mode we're switching hypotheses. We
    now assume as H0 a hypothesis that we're still processing textual
    values, and the H1 is that there are no longer textual
    values. Once we found the start and the end of the sequence, as
    well as all the characters that we attribute to the textual values
    the detection is considered finished.
<p>

    The detection relies on a fact, that when a code processes textual
    values, built from a specified alphabet, the characters from this
    alphabet occurs slightly more often, then the it is prescribed by
    the uniform distribution.<br>
</div>
<hr width="100%">

<pre><span id="TYPEt"><span class="keyword">type</span> <code class="type">+'a</code> t</span> </pre>
<div class="info ">
<code class="code">detector</code><br>
</div>


<pre><span id="TYPEdecision"><span class="keyword">type</span> <code class="type">+'a</code> decision</span> </pre>


<pre><span id="VALcreate"><span class="keyword">val</span> create</span> : <code class="type">?alpha:float -><br>       ?beta:float -><br>       ?p1:float -><br>       ?ps:float -><br>       ?len_pdf:(float -> float) -><br>       Char.Set.t -> 'a <a href="Bap_strings_detector.html#TYPEt">t</a></code></pre><div class="info ">
<code class="code">create&nbsp;alphabet</code> creates a detector.<br>
</div>
<div class="param_info"><code class="code">alpha</code> : a desired probability of the false positive error;</div>
<div class="param_info"><code class="code">beta</code> : a desired probability of the false negative error;</div>
<div class="param_info"><code class="code">p1</code> : posterior probability of the H1 hypothesis;</div>
<div class="param_info"><code class="code">ps</code> : probability of an alphabet character;</div>
<div class="param_info"><code class="code">len_pdf</code> : probability distribution function of textual values
           lengths.</div>
<br>
<code class="code">run&nbsp;detector&nbsp;trace</code> runs a <code class="code">detector</code> on a sequence on a <code class="code">trace</code>
    represented as a sequence of bytes accessed during an exection.
    Returns a sequence of char sequences, where each subsequence is
    represented as a string and contains characters that were assumed
    to belong to the textual data.<br>

<pre><span id="VALstep"><span class="keyword">val</span> step</span> : <code class="type">'a <a href="Bap_strings_detector.html#TYPEt">t</a> -> 'a -> char -> 'a <a href="Bap_strings_detector.html#TYPEt">t</a></code></pre><div class="info ">
<code class="code">step&nbsp;t&nbsp;data&nbsp;char</code> performs one observation.<br>
</div>
</body></html>