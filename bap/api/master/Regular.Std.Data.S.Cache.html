<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Regular.Std.Data.S.Io.html">
<link rel="Up" href="Regular.Std.Data.S.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class attributes" rel=Appendix href="index_attributes.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of class types" rel=Appendix href="index_class_types.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Bap" rel="Chapter" href="Bap.html">
<link title="Bap_bundle" rel="Chapter" href="Bap_bundle.html">
<link title="Bap_plugins" rel="Chapter" href="Bap_plugins.html">
<link title="Bap_config" rel="Chapter" href="Bap_config.html">
<link title="Core_printers" rel="Chapter" href="Core_printers.html">
<link title="Regular" rel="Chapter" href="Regular.html">
<link title="Monads" rel="Chapter" href="Monads.html">
<link title="Ogre" rel="Chapter" href="Ogre.html">
<link title="Bap_future" rel="Chapter" href="Bap_future.html">
<link title="Graphlib" rel="Chapter" href="Graphlib.html">
<link title="Arm_cond" rel="Chapter" href="Arm_cond.html">
<link title="Arm_reg" rel="Chapter" href="Arm_reg.html">
<link title="Arm_types" rel="Chapter" href="Arm_types.html">
<link title="Arm_mov" rel="Chapter" href="Arm_mov.html">
<link title="Arm_mul" rel="Chapter" href="Arm_mul.html">
<link title="Arm_flags" rel="Chapter" href="Arm_flags.html">
<link title="Arm_helpers" rel="Chapter" href="Arm_helpers.html">
<link title="Arm_mem" rel="Chapter" href="Arm_mem.html">
<link title="Arm_op" rel="Chapter" href="Arm_op.html">
<link title="Arm_env" rel="Chapter" href="Arm_env.html">
<link title="Arm_shift" rel="Chapter" href="Arm_shift.html">
<link title="Arm_insn" rel="Chapter" href="Arm_insn.html">
<link title="Arm_bit" rel="Chapter" href="Arm_bit.html">
<link title="Arm_utils" rel="Chapter" href="Arm_utils.html">
<link title="Arm_mem_shift" rel="Chapter" href="Arm_mem_shift.html">
<link title="Arm_lifter" rel="Chapter" href="Arm_lifter.html">
<link title="ARM" rel="Chapter" href="ARM.html">
<link title="Arm_branch" rel="Chapter" href="Arm_branch.html">
<link title="X86_env" rel="Chapter" href="X86_env.html">
<link title="X86_types" rel="Chapter" href="X86_types.html">
<link title="X86_cpu" rel="Chapter" href="X86_cpu.html">
<link title="Bap_api" rel="Chapter" href="Bap_api.html">
<link title="Bap_abi" rel="Chapter" href="Bap_abi.html">
<link title="Bap_c_type_mapper" rel="Chapter" href="Bap_c_type_mapper.html">
<link title="Bap_c_data" rel="Chapter" href="Bap_c_data.html">
<link title="Bap_c_type_printer" rel="Chapter" href="Bap_c_type_printer.html">
<link title="Bap_c_attr" rel="Chapter" href="Bap_c_attr.html">
<link title="Bap_c_parser" rel="Chapter" href="Bap_c_parser.html">
<link title="Bap_c_size" rel="Chapter" href="Bap_c_size.html">
<link title="Bap_c_type" rel="Chapter" href="Bap_c_type.html">
<link title="Bap_c_abi" rel="Chapter" href="Bap_c_abi.html">
<link title="Bap_c_term_attributes" rel="Chapter" href="Bap_c_term_attributes.html">
<link title="Bap_c" rel="Chapter" href="Bap_c.html">
<link title="Bap_c_type_mapper_intf" rel="Chapter" href="Bap_c_type_mapper_intf.html">
<link title="Bap_primus" rel="Chapter" href="Bap_primus.html">
<link title="Bap_traces" rel="Chapter" href="Bap_traces.html">
<link title="Bap_bml" rel="Chapter" href="Bap_bml.html">
<link title="Bap_byteweight_signatures" rel="Chapter" href="Bap_byteweight_signatures.html">
<link title="Bap_byteweight" rel="Chapter" href="Bap_byteweight.html">
<link title="Bap_demangle" rel="Chapter" href="Bap_demangle.html">
<link title="Bap_ida" rel="Chapter" href="Bap_ida.html">
<link title="Bap_elf" rel="Chapter" href="Bap_elf.html">
<link title="Bap_dwarf" rel="Chapter" href="Bap_dwarf.html">
<link title="Bap_build" rel="Chapter" href="Bap_build.html">
<link title="Text_tags" rel="Chapter" href="Text_tags.html"><title>BAR: BAP Annotated Reference : Regular.Std.Data.S.Cache</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Regular.Std.Data.S.Io.html" title="Regular.Std.Data.S.Io">Previous</a>
&nbsp;<a class="up" href="Regular.Std.Data.S.html" title="Regular.Std.Data.S">Up</a>
&nbsp;</div>
<h1>Module <a href="type_Regular.Std.Data.S.Cache.html">Regular.Std.Data.S.Cache</a></h1>

<pre><span class="keyword">module</span> Cache: <code class="code"><span class="keyword">sig</span></code> <a href="Regular.Std.Data.S.Cache.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
Data cache.
<p>

          Store and retrieve data from cache. The cache can seen as a
          persistant weak key-value storage. Data stored here can
          disappear at any time, but can survive for a long time
          (outliving the program). The library by itself doesn't provide
          a caching service for any type, only the interface. The
          caching service can be added externally (e.g., via a plugin).
<p>

          The caching infrastructure provides only facilities for
          storing and loading data. In fact this is just a weak
          key-value storage. A weak, because storage is allowed to
          to loose data.
<p>

          As a key, we use <code class="code">digest</code> that is underneath the hood is and
          md5 sum of arguments used to build the cached data.
<p>

          Let's take for example a function that builds some control
          flow graphs. It has three parameters, one is an optional
          <code class="code">debug</code>, that doesn't affect the algorithm, and the rest two
          has type <code class="code">string</code> and <code class="code">int</code> correspondingly. The following
          code will try to load result from a cache, using a digest of
          the arguments, and if is not available, the the graph will be
          computed and stored in the cache. This function will work even
          if there is no caching service. Of course, there will be no
          benefits, since the <code class="code">save</code> function will just immediately
          forget its argument.
<p>

          <pre class="codepre"><code class="code">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;compute_graph&nbsp;?(debug=<span class="keyword">false</span>)&nbsp;x&nbsp;y&nbsp;:&nbsp;<span class="constructor">Graphs</span>.<span class="constructor">Cfg</span>.t&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;digest&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Data</span>.<span class="constructor">Cache</span>.digest&nbsp;~namespace:<span class="string">"example"</span>&nbsp;<span class="string">"%s%d"</span>&nbsp;x&nbsp;y&nbsp;<span class="keyword">in</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">match</span>&nbsp;<span class="constructor">Graphs</span>.<span class="constructor">Cfg</span>.<span class="constructor">Cache</span>.load&nbsp;digest&nbsp;<span class="keyword">with</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">Some</span>&nbsp;g&nbsp;<span class="keywordsign">-&gt;</span>&nbsp;g
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keywordsign">|</span>&nbsp;<span class="constructor">None</span>&nbsp;<span class="keywordsign">-&gt;</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">let</span>&nbsp;g&nbsp;=&nbsp;build_graph&nbsp;?debug&nbsp;x&nbsp;y&nbsp;<span class="keyword">in</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="constructor">Graphs</span>.<span class="constructor">Cfg</span>.<span class="constructor">Cache</span>.save&nbsp;digest&nbsp;g;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></pre>
<p>

          Note: it is only reasonable to use caching for data types,
          that take significant amount of time to create.<br>
</div>
<hr width="100%">

<pre><span id="VALload"><span class="keyword">val</span> load</span> : <code class="type"><a href="Regular.Std.html#TYPEdigest">digest</a> -> <a href="Regular.Std.Data.S.html#TYPEt">Data.S.t</a> option</code></pre><div class="info ">
<code class="code">load id</code> load data previously stored under give <code class="code">id</code><br>
</div>

<pre><span id="VALsave"><span class="keyword">val</span> save</span> : <code class="type"><a href="Regular.Std.html#TYPEdigest">digest</a> -> <a href="Regular.Std.Data.S.html#TYPEt">Data.S.t</a> -> unit</code></pre><div class="info ">
<code class="code">save id data</code> store data under given <code class="code">id</code>. If something is
            already stored, then it will be overwritten.<br>
</div>
</body></html>