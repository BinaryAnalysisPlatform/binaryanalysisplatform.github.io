<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="Up" href="Bap_taint.Std.Taint.Tracker.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class attributes" rel=Appendix href="index_attributes.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of class types" rel=Appendix href="index_class_types.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Bap" rel="Chapter" href="Bap.html">
<link title="Bap_bundle" rel="Chapter" href="Bap_bundle.html">
<link title="Bap_config" rel="Chapter" href="Bap_config.html">
<link title="Core_printers" rel="Chapter" href="Core_printers.html">
<link title="Bap_plugins" rel="Chapter" href="Bap_plugins.html">
<link title="Regular" rel="Chapter" href="Regular.html">
<link title="Monads" rel="Chapter" href="Monads.html">
<link title="Ogre" rel="Chapter" href="Ogre.html">
<link title="Bap_future" rel="Chapter" href="Bap_future.html">
<link title="Graphlib" rel="Chapter" href="Graphlib.html">
<link title="Bap_taint" rel="Chapter" href="Bap_taint.html">
<link title="Bap_primus" rel="Chapter" href="Bap_primus.html">
<link title="Bare" rel="Chapter" href="Bare.html">
<link title="Arm_insn" rel="Chapter" href="Arm_insn.html">
<link title="Arm_mul" rel="Chapter" href="Arm_mul.html">
<link title="Arm_utils" rel="Chapter" href="Arm_utils.html">
<link title="Arm_mem_shift" rel="Chapter" href="Arm_mem_shift.html">
<link title="Arm_flags" rel="Chapter" href="Arm_flags.html">
<link title="Arm_env" rel="Chapter" href="Arm_env.html">
<link title="Arm_mem" rel="Chapter" href="Arm_mem.html">
<link title="Arm_op" rel="Chapter" href="Arm_op.html">
<link title="Arm_bit" rel="Chapter" href="Arm_bit.html">
<link title="Arm_branch" rel="Chapter" href="Arm_branch.html">
<link title="ARM" rel="Chapter" href="ARM.html">
<link title="Arm_shift" rel="Chapter" href="Arm_shift.html">
<link title="Arm_mov" rel="Chapter" href="Arm_mov.html">
<link title="Arm_cond" rel="Chapter" href="Arm_cond.html">
<link title="Arm_types" rel="Chapter" href="Arm_types.html">
<link title="Arm_reg" rel="Chapter" href="Arm_reg.html">
<link title="Arm_helpers" rel="Chapter" href="Arm_helpers.html">
<link title="Arm_lifter" rel="Chapter" href="Arm_lifter.html">
<link title="X86_asm_reg" rel="Chapter" href="X86_asm_reg.html">
<link title="X86_types" rel="Chapter" href="X86_types.html">
<link title="X86_env" rel="Chapter" href="X86_env.html">
<link title="X86_llvm_env" rel="Chapter" href="X86_llvm_env.html">
<link title="X86_asm" rel="Chapter" href="X86_asm.html">
<link title="X86_cpu" rel="Chapter" href="X86_cpu.html">
<link title="X86_asm_reg_types" rel="Chapter" href="X86_asm_reg_types.html">
<link title="Bap_api" rel="Chapter" href="Bap_api.html">
<link title="Bap_abi" rel="Chapter" href="Bap_abi.html">
<link title="Bap_c_type" rel="Chapter" href="Bap_c_type.html">
<link title="Bap_c_data" rel="Chapter" href="Bap_c_data.html">
<link title="Bap_c_attr" rel="Chapter" href="Bap_c_attr.html">
<link title="Bap_c_type_mapper_intf" rel="Chapter" href="Bap_c_type_mapper_intf.html">
<link title="Bap_c_type_printer" rel="Chapter" href="Bap_c_type_printer.html">
<link title="Bap_c_term_attributes" rel="Chapter" href="Bap_c_term_attributes.html">
<link title="Bap_c_abi" rel="Chapter" href="Bap_c_abi.html">
<link title="Bap_c_type_mapper" rel="Chapter" href="Bap_c_type_mapper.html">
<link title="Bap_c" rel="Chapter" href="Bap_c.html">
<link title="Bap_c_parser" rel="Chapter" href="Bap_c_parser.html">
<link title="Bap_c_size" rel="Chapter" href="Bap_c_size.html">
<link title="Bap_bml" rel="Chapter" href="Bap_bml.html">
<link title="Bap_build" rel="Chapter" href="Bap_build.html">
<link title="Bap_byteweight_signatures" rel="Chapter" href="Bap_byteweight_signatures.html">
<link title="Bap_byteweight" rel="Chapter" href="Bap_byteweight.html">
<link title="Bap_demangle" rel="Chapter" href="Bap_demangle.html">
<link title="Bap_dwarf" rel="Chapter" href="Bap_dwarf.html">
<link title="Bap_ida" rel="Chapter" href="Bap_ida.html">
<link title="Bap_llvm" rel="Chapter" href="Bap_llvm.html">
<link title="Bap_llvm_loader" rel="Chapter" href="Bap_llvm_loader.html">
<link title="Bap_traces" rel="Chapter" href="Bap_traces.html">
<link title="Bap_strings_index" rel="Chapter" href="Bap_strings_index.html">
<link title="Bap_strings_scanner" rel="Chapter" href="Bap_strings_scanner.html">
<link title="Bap_strings" rel="Chapter" href="Bap_strings.html">
<link title="Bap_strings_detector" rel="Chapter" href="Bap_strings_detector.html">
<link title="Bap_strings_unscrambler" rel="Chapter" href="Bap_strings_unscrambler.html">
<link title="Text_tags" rel="Chapter" href="Text_tags.html"><link title="The low-level interface" rel="Section" href="#3_Thelowlevelinterface">
<link title="High-level interface" rel="Section" href="#3_Highlevelinterface">
<title>BAR: BAP Annotated Reference : Bap_taint.Std.Taint.Tracker.Make</title>
</head>
<body>
<div class="navbar">&nbsp;<a class="up" href="Bap_taint.Std.Taint.Tracker.html" title="Bap_taint.Std.Taint.Tracker">Up</a>
&nbsp;</div>
<h1>Functor <a href="type_Bap_taint.Std.Taint.Tracker.Make.html">Bap_taint.Std.Taint.Tracker.Make</a></h1>

<pre><span id="MODULEMake"><span class="keyword">module</span> Make</span> <code class="code">(</code><code class="code"><span class="constructor">Machine</span></code><code class="code">&nbsp;:&nbsp;</code><code class="type"><a href="Bap_primus.Std.Primus.Machine.S.html">Std.Primus.Machine.S</a></code><code class="code">)&nbsp;</code>: <code class="code"><span class="keyword">sig</span></code> <a href="Bap_taint.Std.Taint.Tracker.Make.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><table border="0" cellpadding="3" width="100%">
<tr>
<td align="left" valign="top" width="1%%"><b>Parameters: </b></td>
<td>
<table class="paramstable">
<tr>
<td align="center" valign="top" width="15%">
<code>Machine</code></td>
<td align="center" valign="top">:</td>
<td><code class="type"><a href="Bap_primus.Std.Primus.Machine.S.html">Std.Primus.Machine.S</a></code>
</table>
</td>
</tr>
</table>
<hr width="100%">
<h4 id="3_Thelowlevelinterface">The low-level interface</h4>
<p>The low-level interface defines three primitives in terms of
            which we can express a more convenient high-level
            interface. It is recommened to get acquainted with these
            three primitives, to understand how the tracker works,
            however it is better to use the high level interface,
            whenever it is possible.</p>

<p>To denote the concrete semantics of these primitives we will
            use the taint ternary relation <code class="code"><span class="constructor">T</span></code> that establishes a
            relation between a value and an object, e.g., <code class="code"><span class="constructor">T</span>(v,r,x)</code> is
            the relation <code class="code">r</code> between the value <code class="code">v</code> and an object <code class="code">x</code>.</p>

<p>Conceptually, the state of the tracker can be seen as a set
            of such relations. Since tracker operations may affect this set
            of relations we will denote relations that existed just
            before an operation with <code class="code">pre</code>, e.g., <code class="code">pre(<span class="constructor">T</span>(v,r,x)</code> means
            that before the operation there was the relation <code class="code"><span class="constructor">T</span>(v,r,x)</code></p>

<pre><span id="VALattach"><span class="keyword">val</span> attach</span> : <code class="type"><a href="Bap_primus.Std.Primus.html#TYPEvalue">Std.Primus.value</a> -><br>       <a href="Bap_taint.Std.Taint.Rel.html#TYPEt">Bap_taint.Std.Taint.Rel.t</a> -><br>       Bap_taint.Std.Taint.Object.Set.t -> unit Machine.t</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">attach&nbsp;v&nbsp;r&nbsp;xs</code> establishes the relation <code class="code">r</code> between the
            value <code class="code">v</code> and every object <code class="code">x</code> in the set of objects <code class="code">xs</code>.
            All other relations, as well as relations with other values
            are unaffected.</p>

<p>Post conditions:</p>
<ul>
<li>forall x, x in xs -&gt; T(v,r,x);</li>
<li>forall u,s,x, pre(T(u,s,x)) -&gt; T(u,s,x);</li>
<li>forall u,s,x, T(v,s,x) -&gt; pre(T(v,s,x)) \// s = r /\\ v = u.</li>
</ul>
</div>
</div>

<pre><span id="VALlookup"><span class="keyword">val</span> lookup</span> : <code class="type"><a href="Bap_primus.Std.Primus.html#TYPEvalue">Std.Primus.value</a> -><br>       <a href="Bap_taint.Std.Taint.Rel.html#TYPEt">Bap_taint.Std.Taint.Rel.t</a> -> Bap_taint.Std.Taint.Object.Set.t Machine.t</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">lookup&nbsp;v&nbsp;r</code> returns a set <code class="code">xs</code> of objects that are related
            with the value <code class="code">v</code> by the relation <code class="code">r</code>. The operation
            doesn't change the state of the tracker.</p>

<p>Post conditions:</p>
<ul>
<li>x in xs iff T(v,r,x);</li>
<li>forall u,s,y, Pre(T(u,s,y)) iff T(u,s,y);</li>
</ul>
</div>
</div>

<pre><span id="VALdetach"><span class="keyword">val</span> detach</span> : <code class="type"><a href="Bap_primus.Std.Primus.html#TYPEvalue">Std.Primus.value</a> -><br>       <a href="Bap_taint.Std.Taint.Rel.html#TYPEt">Bap_taint.Std.Taint.Rel.t</a> -><br>       Bap_taint.Std.Taint.Object.Set.t -> unit Machine.t</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">detach&nbsp;v&nbsp;r&nbsp;xs</code> removes all relations of type <code class="code">r</code> between
            the value <code class="code">v</code> and elements of the set of objects
            <code class="code">xs</code>. Relations of other types as well as relations between
            other objects and values are unaffected.</p>

<p>Post conditions:</p>
<ul>
<li>forall x, x in xs -&gt; not (T(v,r,x));</li>
<li>forall u,s,y, v &lt;&gt; u \// s &lt;&gt; r, pre(T(u,s,y)) -&gt; T(u,s,y)</li>
</ul>
</div>
</div>
<h4 id="3_Highlevelinterface">High-level interface</h4>
<p>The high-level interface provides a set of easy to use (and
            sometimes more efficient) functions. All these functions
            could be expressed in terms of the three primitive operations.</p>

<pre><span id="VALnew_direct"><span class="keyword">val</span> new_direct</span> : <code class="type"><a href="Bap_primus.Std.Primus.html#TYPEvalue">Std.Primus.value</a> -><br>       <a href="Bap_taint.Std.Taint.Kind.html#TYPEt">Bap_taint.Std.Taint.Kind.t</a> -> <a href="Bap_taint.Std.Taint.Object.html#TYPEt">Bap_taint.Std.Taint.Object.t</a> Machine.t</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">new_direct&nbsp;v&nbsp;k</code> introduces a new direct relation between the
            value <code class="code">v</code> and a freshly created object of the given kind
            <code class="code">k</code>. The object is returned.</p>

<p>Essentially:
            <code class="code">attach&nbsp;v&nbsp;direct&nbsp;(add&nbsp;(lookup&nbsp;v&nbsp;k)&nbsp;(<span class="constructor">Object</span>.create&nbsp;k&nbsp;<span class="keyword">as</span>&nbsp;r));&nbsp;r</code></p>
</div>
</div>

<pre><span id="VALnew_indirect"><span class="keyword">val</span> new_indirect</span> : <code class="type">addr:<a href="Bap_primus.Std.Primus.html#TYPEvalue">Std.Primus.value</a> -><br>       len:<a href="Bap_primus.Std.Primus.html#TYPEvalue">Std.Primus.value</a> -><br>       <a href="Bap_taint.Std.Taint.Kind.html#TYPEt">Bap_taint.Std.Taint.Kind.t</a> -> <a href="Bap_taint.Std.Taint.Object.html#TYPEt">Bap_taint.Std.Taint.Object.t</a> Machine.t</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">new_indirect&nbsp;~addr:v&nbsp;~len:n&nbsp;k</code> establishes a new indirect
            relation between a set of addresses, denoted by interval
            <code class="code">[v,v+n-1]</code>, and a freshly created object of specified
            kind.</p>
</div>
</div>

<pre><span id="VALsanitize"><span class="keyword">val</span> sanitize</span> : <code class="type"><a href="Bap_primus.Std.Primus.html#TYPEvalue">Std.Primus.value</a> -><br>       <a href="Bap_taint.Std.Taint.Rel.html#TYPEt">Bap_taint.Std.Taint.Rel.t</a> -> <a href="Bap_taint.Std.Taint.Kind.html#TYPEt">Bap_taint.Std.Taint.Kind.t</a> -> unit Machine.t</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code"><span class="constructor">Taint</span>.sanitize&nbsp;r&nbsp;k&nbsp;v</code> detaches all objects related to the
            value <code class="code">v</code> by the relation <code class="code">r</code> that has the given kind <code class="code">k</code>.</p>

<p>In terms of the low-level operations:</p>

<p><code class="code">detach&nbsp;v&nbsp;r&nbsp;(filter&nbsp;(has_kind&nbsp;k)&nbsp;(lookup&nbsp;v&nbsp;r))</code></p>
</div>
</div>
</body></html>
