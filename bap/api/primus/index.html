<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-03-06 Fri 14:54 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Ivan" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org263f046">1. Systems</a></li>
<li><a href="#orgd24a192">2. Components</a></li>
<li><a href="#org87d0e00">3. Observations</a></li>
</ul>
</div>
</div>
<div id="outline-container-org263f046" class="outline-2">
<h2 id="org263f046"><span class="section-number-2">1</span> Systems</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>bap:legacy-main:
The legacy Primus system that contains all components registered with the
Machine.add<sub>component</sub> function.</li>

<li>bap:string-deobfuscator:
Uses greedy-promiscuous-executor to find obfuscated strings.</li>

<li>bap:taint-analyzer:
Uses greedy-promiscuous-executor for taint analysis.
Propagates taint by computation.</li>

<li>bap:binary-executor:
Executes a binary program.</li>

<li>bap:exact-taint-analyzer:
Uses greedy-promiscuous-executor for taint analysis.
Propagates taint exactly.</li>

<li>bap:constant-tracker:
Uses greedy-promiscuous-executor for constant tracking.</li>

<li>bap:terminating-stubbed-executor:
Executes a binary together with the Lisp Machine that
is guaranteed to terminate.</li>

<li>bap:reflective-taint-analyzer:
A taint analyzer that reflects taints to/from BIR terms</li>

<li>bap:multi-analyzer:
Runs several analyses in parallel.</li>

<li>bap:greedy-promiscuous-executor:
Executes all linearly independent paths and never fails.</li>

<li>bap:stubbed-executor:
Executes a binary together with the Lisp Machine</li>

<li>bap:base-taint-analyzer:
Uses greedy-promiscuous-executor for taint analysis.
No policy is specified</li>

<li>bap:base-lisp-machine:
Executes Primus Lisp program.</li>
</ul>
</div>
</div>

<div id="outline-container-orgd24a192" class="outline-2">
<h2 id="orgd24a192"><span class="section-number-2">2</span> Components</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>bap:round-robin-scheduler:
[generic]
Enables the round-robin scheduler (experimental).</li>

<li>bap:load-binary:
[generic]
Links the binary program into the Primus machine. All symbols of the binary
program are linked weakly, i.e., if a symbol is already linked, then this
component will not override it.</li>

<li>bap:mark-visited:
[generic]
Marks visited (by Primus) program terms with the [Term.visited] attribute
and unvisited with the [Term.dead] attribute. Note, that the attributes are
attached only when the system exits</li>

<li>bap:propagate-taint-exact:
[generic]
Enables the exact taint propagation policy. In this policy, a taint is only
propagated between values when one value is derived from another using some
transparent (not changing the value computation), e.g., store, load, cast,
concat, extract.</li>

<li>bap:load-lisp-library:
[generic]
Loads the Primus Library. Links all functions defined as external into the
Primus Machine. Symbols are assumed to be strong, i.e., if the symbol is
already linked, then it will be overriden by the corresponding Lisp
implemenetation</li>

<li>bap:constant-tracker:
[generic]
Tracks constants, using the following policy. A value is a static constant
if it was initialized from a constant value or computed from static
constant values.</li>

<li>bap:lisp-ieee754:
[generic]
Provides primitives for IEE754 floating-point arithemtic.</li>

<li>bap:greedy-scheduler:
[generic]
Enables the greedy scheduler. The greedy scheduling strategy will continue
with the same state, unless the machine reaches a termination state, i.e.,
when the $(b,next) value in a context becomes $(b,None). In that case
another alive state that has a $(b,next) value that is not $(b,None) is
chosen. If such state doesn't exist, then the Machine finally terminates.
Thus this strategy will perform a depth-first traversal of the state tree,
and guarantees that all paths are explored. The greedy scheduler will
attempt to reschedule every time a basic block is evaluated.</li>

<li>bap:lisp-core:
[generic]
Initializes Primus Lisp core. Forwards Lisp message to the BAP log
subsystem and enables propagation of observations to signals.</li>

<li>bap:promiscuous-mode:
[generic]
Enables the promiscuous mode. Requires the Trivial Condition Form. When
this mode is enabled the Primus Machine will venture into paths with
unsatisfied constraints. Basically, it means that on every branch the state
is duplicated.</li>

<li>bap:lisp-basic-io:
[generic]
Provides basic IO primitives to Primus Lisp.</li>

<li>bap:monitor:
[generic]
Monitors the specified set of observations and prints a trace of recorded
observations when a machine finishes.</li>

<li>bap:taint-marker:
[generic]
Translates tainted values of the Taint engine to tainted-regs and
tainted-ptrs term attributes of the IR.</li>

<li>bap:powerpc-init:
[generic]
Initializes PPC registers.</li>

<li>bap:lisp-incidents:
[generic]
Exposes the incident reporting facitilites to Primus Lisp.</li>

<li>bap:lisp-type-checker:
[generic]
Typechecks program and outputs the summary in the standard output.</li>

<li>bap:lisp-type-error-printer:
[generic]
Prints Primus Lisp type errors into the standard output.</li>

<li>bap:taint-mapper:
[generic]
Maintains a mapping between tainted objects and term identifiers.</li>

<li>bap:program-loader:
[generic]
Initializes the runtime environment. This is a generic loader that should
work with most of the ABIs. It loads memory segments, including virtual,
sets up [brk], [end], [edata], [etext], and [environ] variables (see any
unix man page for the description of these symbols). Note that ([edata] and
[etext] are not guaranteed, while [end] and [brk] are). The loader also
initializes all CPU registers to zero and setups and alloocates the main
stack frame (copies arguments from the ctxt to the stack), and points the
stack-pointer register to the command line arguments. (The environment
variables follows the arguments).</li>

<li>bap:taint-primitives:
[generic]
Exposes Primus Lisp primitives that controls the Primus Taint Engine.</li>

<li>bap:taint-intro:
[generic]
Introduces a taint when a term marked with tainted-reg or tainted-ptr is
entered.</li>

<li>bap:taint-signals:
[generic]
Reflects Primus Taint observations to Lisp signals.</li>

<li>bap:conservative-garbage-collector:
[generic]
Enables taint garbage collector. The component scans the memory and
registers and deletes taints that are no longer reachable.</li>

<li>bap:wondering-scheduler:
[generic]
Enables the random wonderning scheduler (experimental). The scheduler will
pick between the states randomly.</li>

<li>bap:propagate-taint-by-computation:
[generic]
Enables the propagate-by-computation taint propagation policy. In this
policy, a value is tainted if it was computed using a tainted value.</li>

<li>bap:x86-setup-plt:
[generic]
Sets up PLT entries.</li>

<li>bap:constant-tracker-primitives:
[generic]
Exposes the constant tracker primitives to Primus Lisp.</li>

<li>bap:beagle-hunter:
[generic]
Monitors execution and detects data that looks like words from the provided
dictionary.</li>

<li>bap:exploring-scheduler:
[generic]
Enables the exploring scheduler (experimental). The exploring scheduler
will prioritize clones that will wonder into not yet explored or less
explored areas. More specifically, from a set of machine clones, it will
choose those, that will proceed to a basic block that was visited the least
amount of times. The round-robin scheduler will switch the context after
each basic block. It will count the number of time the block was evaluated</li>

<li>bap:lisp-dictionary:
[generic]
Provides a key-value storage for Primus Lisp programs. Dictionaries are
represented with symbols and it is a responsibility of user to prevent name
clashing between different dictionaries.</li>

<li>bap:lisp-primitives:
[generic]
Provides the core set of Primus Lisp primitives.</li>

<li>bap:lisp-regions:
[generic]
Provides a set of operations to store and manipulate interval trees. The
module provides a persistent storage for intervals, denoted in the module
as regions, since these intervals often represent memory regions. Intervals
are stored in interval sets, that are implemented as efficient interval
tree data structures (using AVL trees underneath the hood). Each interval
set is denoted with a symbol, and it is possible to create arbitrary number
of sets, as well as move regions from one set to another.</li>

<li>bap:x86-flag-initializer:
[generic]
Intializes x86 flags to zero.</li>

<li>bap:incident-location-recorder:
[generic]
Records tracepoints for incident reporting.</li>

<li>bap:limit:
[generic]
Enables program termination by limiting the maximum life time of each
Primus Machine.</li>
</ul>
</div>
</div>

<div id="outline-container-org87d0e00" class="outline-2">
<h2 id="org87d0e00"><span class="section-number-2">3</span> Observations</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li>leave-phi:
Occurs after the given term is evaluated.</li>

<li>machine-kill:
Occurs after the given machine is killed.
Observations are in the restricted mode.</li>

<li>leave-pos:
Occurs after the given position is evaluated.</li>

<li>concat:
Occurs on each concat operation.</li>

<li>stored:
Occurs after the value is stored at the address.</li>

<li>beagle-prey:
Occurs when the sequence of characters is detected.</li>

<li>pc-changed:
Occurs after the program counter is changed.</li>

<li>enter-jmp:
Occurs before the given term is evaluated.</li>

<li>call:
Occurs when the call is made.</li>

<li>enter-def:
Occurs before the given term is evaluated.</li>

<li>lisp-call:
Occurs when the call to Lisp code is made.</li>

<li>pagefault:
Occurs on pagefault.</li>

<li>leave-jmp:
Occurs after the given term is evaluated.</li>

<li>enter-sub:
Occurs before the given term is evaluated.</li>

<li>call-return:
Occurs when the call returns.</li>

<li>enter-pos:
Occurs before the given position is evaluated.</li>

<li>extract:
Occurs on each extract operation.</li>

<li>clock:
Occurs on each clock (operation) of the interpreter.</li>

<li>binop:
Occurs on each binary operation.</li>

<li>loaded:
Occurs after the given address is read.</li>

<li>leave-def:
Occurs after the given term is evaluated.</li>

<li>lisp-primitive:
Occurs when the Lisp primitive is invoked.</li>

<li>lisp-message:
Occurs with X when (msg x) is evaluated.</li>

<li>enter-phi:
Occurs before the given term is evaluated.</li>

<li>halting:
Occurs before the halt operation is posted.</li>

<li>system-stop:
Occurs after the system is stopped. Observations
are in the restricted mode</li>

<li>fini:
Occurs when machine finishes.</li>

<li>leave-top:
Occurs after the given term is evaluated.</li>

<li>leave-arg:
Occurs after the given term is evaluated.</li>

<li>cast:
Occurs on each cast.</li>

<li>interrupt:
Occurs before an interrupt.</li>

<li>undefined:
Occurs when an undefined value is created.</li>

<li>taint-finalize:
Occurs when the taint becomes unreachable.</li>

<li>jumping:
Occurs before the jump to the given destination.</li>

<li>writing:
Occurs before the value is assigned to the variable.</li>

<li>lisp-call-return:
OCcurs when the call to Lisp code returns.</li>

<li>system-start:
Occurs after the system start.</li>

<li>machine-switch:
Occurs when machines are switched.</li>

<li>leave-sub:
Occurs after the given term is evaluated.</li>

<li>storing:
Occurs before the value is stored at the address.</li>

<li>memory-switch:
Occurs when the memory bank is switched.</li>

<li>exception:
Occurs just before the Machine exception is raised.</li>

<li>cfi-violation:
Occurs before the control flow violation is commited.</li>

<li>enter-top:
Occurs before the given term is evaluated.</li>

<li>beagle:
Occurs when the sequence of characters is classified as text.</li>

<li>linker-exec:
Occurs before code with the given name is executed.</li>

<li>segfault:
Occurs just before the segmentation fault.</li>

<li>ite:
Occurs on each ite expression.</li>

<li>init:
Occurs when all components of the machine are initialized.</li>

<li>read:
Occurs after the given variable is evaluated to the value.</li>

<li>enter-exp:
Occurs before the given exp is evaluated.</li>

<li>lisp-type-error:
Occurs when the Lisp type error is detected by the type checker</li>

<li>division-by-zero:
Occurs before the division by zero happens.</li>

<li>machine-fork:
Occurs after a machine fork is created.</li>

<li>enter-blk:
Occurs before the given term is evaluated.</li>

<li>unop:
Occurs on each unary operation.</li>

<li>taint-attached:
Occurs when a taint is attached to the value.</li>

<li>enter-arg:
Occurs before the given term is evaluated.</li>

<li>const:
Occurs on each constant.</li>

<li>reading:
Occurs before the given variable is read.</li>

<li>eval-cond:
Occurs when the jump condition is evaluated.</li>

<li>leave-exp:
Occurs after the given exp is evaluated.</li>

<li>leave-term:
Occurs after the given term is evaluated.</li>

<li>written:
Occurs after the value is assigned to the variable.</li>

<li>loading:
Occurs just before the given address is dereferenced.</li>

<li>enter-term:
Occurs before the given term.</li>

<li>incident-location:
Occurs when the location of a possible incident is created.</li>

<li>incident:
Occurs when the incident is reported that involves the given locations.</li>

<li>linker-unresolved:
Occurs when a linker hits the unresolved name.</li>

<li>leave-blk:
Occurs after the given term is evaluated.</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Ivan</p>
<p class="date">Created: 2020-03-06 Fri 14:54</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
