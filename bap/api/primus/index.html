<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Primus Lisp Documentation</title>
<!-- 2022-03-26 Sat 01:47 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Primus Lisp Documentation</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Systems</a></li>
<li><a href="#sec-2">2. Components</a></li>
<li><a href="#sec-3">3. Observations</a></li>
</ul>
</div>
</div>
<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Systems</h2>
<div class="outline-text-2" id="text-1">
<ul class="org-ul">
<li>bap:constant-tracker:
Uses promiscuous-executor for constant tracking.
</li>

<li>bap:microexecutor-base:
The base system for microexecution systems.
</li>

<li>bap:symbolic-executor:
Uses symbolic execution to analyze all feasible and
linearly independent paths.
</li>

<li>bap:base-taint-analyzer:
Uses promiscuous-executor for taint analysis.
No policy is specified
</li>

<li>bap:binary-executor:
Executes a binary program.
</li>

<li>bap:taint-analyzer:
Uses promiscuous-executor for taint analysis.
The default taint propagation policy is selected
using the &#x2013;primus-taint-select-default-policy
option (defaults to propagate-by-computation)
</li>

<li>bap:reflective-taint-analyzer:
A taint analyzer that reflects taints to/from BIR terms
</li>

<li>bap:stubbed-executor:
Executes a binary together with the Lisp Machine
</li>

<li>bap:legacy-main:
The legacy Primus system that contains all components registered with the
Machine.add<sub>component</sub> function.
</li>

<li>bap:base-lisp-machine:
Executes Primus Lisp program.
</li>

<li>bap:promiscuous-executor:
Executes all linearly independent paths and never fails.
</li>

<li>bap:terminating-stubbed-executor:
Executes a binary together with the Lisp Machine that
is guaranteed to terminate.
</li>

<li>bap:multi-analyzer:
Runs several analyses in parallel.
</li>

<li>bap:exact-taint-analyzer:
Uses promiscuous-executor for taint analysis.
Propagates taint exactly.
</li>

<li>bap:string-deobfuscator:
Uses promiscuous-executor to find obfuscated strings.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Components</h2>
<div class="outline-text-2" id="text-2">
<ul class="org-ul">
<li>bap:load-binary:
[generic]
Links the binary program into the Primus machine. All symbols of the binary
program are linked weakly, i.e., if a symbol is already linked, then this
component will not override it.
</li>

<li>bap:report-visited:
[generic]
Reports progress when a new basic block is discovered.
</li>

<li>bap:var-randomizer:
[generic]
Randomizes registers.
</li>

<li>bap:arg-randomizer:
[generic]
Randomizes output arguments of unbound procedures, as well
as prevents failures when such procedures are called by trapping
the unresolved handler.
</li>

<li>bap:select-default-taint-policy:
[generic]
Sets the default policy to the value selected by a user via the
&#x2013;primus-taint-default-policy command-line option.
</li>

<li>bap:exploring-scheduler:
[generic]
Enables the exploring scheduler (experimental). The exploring scheduler
will prioritize clones that will wonder into not yet explored or less
explored areas. More specifically, from a set of machine clones, it will
choose those, that will proceed to a basic block that was visited the least
amount of times. The round-robin scheduler will switch the context after
each basic block. It will count the number of time the block was evaluated
</li>

<li>bap:constant-tracker-primitives:
[generic]
Exposes the constant tracker primitives to Primus Lisp.
</li>

<li>bap:taint-marker:
[generic]
Translates tainted values of the Taint engine to tainted-regs and
tainted-ptrs term attributes of the IR.
</li>

<li>bap:symbolic-path-constraints:
[generic]
tracks the path constraint and records them in the machine's symbolic
context
</li>

<li>bap:round-robin-scheduler:
[generic]
Enables the round-robin scheduler (experimental).
</li>

<li>bap:lisp-dictionary:
[generic]
Provides a key-value storage for Primus Lisp programs. Dictionaries are
represented with symbols and it is a responsibility of user to prevent name
clashing between different dictionaries.
</li>

<li>bap:powerpc-init:
[generic]
Initializes PPC registers.
</li>

<li>bap:x86-registers-initializer:
[generic]
Intializes all x86/x86-64 registers to zero.
</li>

<li>bap:limit:
[generic]
Enables program termination by limiting the maximum life time of each
Primus Machine.
</li>

<li>bap:symbolic-computer:
[generic]
Computes a symbolic formula for each Primus value.
</li>

<li>bap:lisp-ieee754:
[generic]
Provides primitives for IEE754 floating-point arithemtic.
</li>

<li>bap:lisp-primitives:
[generic]
Provides the core set of Primus Lisp primitives.
</li>

<li>bap:select-propagate-by-computation-policy:
[generic]
Selects the propagate-by-computation as the default taint propagation
policy. This policy could be overwritten per each taint kind individually.
</li>

<li>bap:beagle-hunter:
[generic]
Monitors execution and detects data that looks like words from the provided
dictionary.
</li>

<li>bap:lisp-regions:
[generic]
Provides a set of operations to store and manipulate interval trees. The
module provides a persistent storage for intervals, denoted in the module
as regions, since these intervals often represent memory regions. Intervals
are stored in interval sets, that are implemented as efficient interval
tree data structures (using AVL trees underneath the hood). Each interval
set is denoted with a symbol, and it is possible to create arbitrary number
of sets, as well as move regions from one set to another.
</li>

<li>bap:lisp-core:
[generic]
Initializes Primus Lisp core. Forwards Lisp message to the BAP log
subsystem and enables propagation of observations to signals.
</li>

<li>bap:lisp-type-error-printer:
[generic]
Prints Primus Lisp type errors into the standard output.
</li>

<li>bap:promiscuous-path-explorer:
[generic]
Forces execution of all linearly independent paths by forcefully flipping
the branch conditions.
</li>

<li>bap:symbolic-lisp-primitives:
[generic]
Provides assume and assert primitives.
</li>

<li>bap:lisp-type-checker:
[generic]
Typechecks program and outputs the summary in the standard output.
</li>

<li>bap:load-lisp-library:
[generic]
Loads the Primus Library. Links all functions defined as external into the
Primus Machine. Symbols are assumed to be strong, i.e., if the symbol is
already linked, then it will be overriden by the corresponding Lisp
implemenetation
</li>

<li>bap:taint-intro:
[generic]
Introduces a taint when a term marked with tainted-reg or tainted-ptr is
entered.
</li>

<li>bap:propagate-taint-by-computation:
[generic]
Enables the propagate-by-computation taint propagation policy. In this
policy, a value is tainted if it was computed using a tainted value.
</li>

<li>bap:observation-printer:
[generic]
Prints the specified set of observations. Controlled via the primus-print
plugin.
</li>

<li>bap:division-by-zero-handler:
[generic]
Disables division by zero errors.
</li>

<li>bap:lisp-incidents:
[generic]
Exposes the incident reporting facitilites to Primus Lisp.
</li>

<li>bap:x86-setup-plt:
[generic]
Sets up PLT entries.
</li>

<li>bap:mark-visited:
[generic]
Marks visited (by Primus) program terms with the [Term.visited] attribute
and unvisited with the [Term.dead] attribute. Note, that the attributes are
attached only when the system exits
</li>

<li>bap:taint-signals:
[generic]
Reflects Primus Taint observations to Lisp signals.
</li>

<li>bap:propagate-taint-exact:
[generic]
Enables the exact taint propagation policy. In this policy, a taint is only
propagated between values when one value is derived from another using some
transparent (not changing the value computation), e.g., store, load, cast,
concat, extract.
</li>

<li>bap:conservative-garbage-collector:
[generic]
Enables taint garbage collector. The component scans the memory and
registers and deletes taints that are no longer reachable.
</li>

<li>bap:program-loader:
[generic]
Initializes the runtime environment. This is a generic loader that should
work with most of the ABIs. It loads memory segments, including virtual,
sets up [brk], [end], [edata], [etext], and [environ] variables (see any
unix man page for the description of these symbols). Note that ([edata] and
[etext] are not guaranteed, while [end] and [brk] are). The loader also
initializes all CPU registers to zero and setups and alloocates the main
stack frame (copies arguments from the ctxt to the stack), and points the
stack-pointer register to the command line arguments. (The environment
variables follows the arguments).
</li>

<li>bap:constant-tracker:
[generic]
Tracks constants, using the following policy. A value is a static constant
if it was initialized from a constant value or computed from static
constant values.
</li>

<li>bap:select-propagate-taint-exact-policy:
[generic]
Selects the propagate-taint-exact as the default taint propagation policy.
This policy could be overwritten per each taint kind individually.
</li>

<li>bap:incident-location-recorder:
[generic]
Records tracepoints for incident reporting.
</li>

<li>bap:symbolic-path-explorer:
[generic]
Computes a path constraint for each branch and forks a new machine if the
constraint is satisfiable.
</li>

<li>bap:taint-primitives:
[generic]
Exposes Primus Lisp primitives that controls the Primus Taint Engine.
</li>

<li>bap:lisp-basic-io:
[generic]
Provides basic IO primitives to Primus Lisp.
</li>

<li>bap:greedy-scheduler:
[generic]
Enables the greedy scheduler. The greedy scheduling strategy will continue
with the same state, unless the machine reaches a termination state, i.e.,
when the $(b,next) value in a context becomes $(b,None). In that case
another alive state that has a $(b,next) value that is not $(b,None) is
chosen. If such state doesn't exist, then the Machine finally terminates.
Thus this strategy will perform a depth-first traversal of the state tree,
and guarantees that all paths are explored. The greedy scheduler will
attempt to reschedule every time a basic block is evaluated.
</li>

<li>bap:mem-randomizer:
[generic]
Randomizes process memory.
</li>

<li>bap:taint-mapper:
[generic]
Maintains a mapping between tainted objects and term identifiers.
</li>

<li>bap:wondering-scheduler:
[generic]
Enables the random wonderning scheduler (experimental). The scheduler will
pick between the states randomly.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Observations</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li>primus:clock:
Occurs on each clock (operation) of the interpreter.
</li>

<li>primus:machine-kill:
Occurs after the given machine is killed.
Observations are in the restricted mode.
</li>

<li>primus:memory-switch:
Occurs when the memory bank is switched.
</li>

<li>primus:incident:
Occurs when the incident is reported that involves the given locations.
</li>

<li>primus:concat:
Occurs on each concat operation.
</li>

<li>primus:random-debug:
</li>
</ul>


<ul class="org-ul">
<li>primus:written:
Occurs after the value is assigned to the variable.
</li>

<li>primus:stored:
Occurs after the value is stored at the address.
</li>

<li>primus:division-by-zero:
Occurs before the division by zero happens.
</li>

<li>primus:leave-arg:
Occurs after the given term is evaluated.
</li>

<li>primus:lisp-call-return:
OCcurs when the call to Lisp code returns.
</li>

<li>primus:extract:
Occurs on each extract operation.
</li>

<li>primus:incident-new-instance:
Occurs on a new instance of the incident class
</li>

<li>primus:halting:
Occurs before the halt operation is posted.
</li>

<li>primus:machine-switch:
Occurs when machines are switched.
</li>

<li>primus:leave-phi:
Occurs after the given term is evaluated.
</li>

<li>primus:incident-location:
Occurs when the location of a possible incident is created.
</li>

<li>primus:exception:
Occurs just before the Machine exception is raised.
</li>

<li>primus:interrupt:
Occurs before an interrupt.
</li>

<li>primus:leave-pos:
Occurs after the given position is evaluated.
</li>

<li>primus:enter-term:
Occurs before the given term.
</li>

<li>primus:ite:
Occurs on each ite expression.
</li>

<li>primus:enter-phi:
Occurs before the given term is evaluated.
</li>

<li>primus:leave-sub:
Occurs after the given term is evaluated.
</li>

<li>primus:cast:
Occurs on each cast.
</li>

<li>primus:enter-sub:
Occurs before the given term is evaluated.
</li>

<li>primus:pc-changed:
Occurs after the program counter is changed.
</li>

<li>primus:enter-pos:
Occurs before the given position is evaluated.
</li>

<li>primus:call-return:
Occurs when the call returns.
</li>

<li>primus:taint-attached:
Occurs when a taint is attached to the value.
</li>

<li>primus:reading:
Occurs before the given variable is read.
</li>

<li>primus:taint-finalize:
Occurs when the taint becomes unreachable.
</li>

<li>primus:lisp-primitive:
Occurs when the Lisp primitive is invoked.
</li>

<li>primus:leave-blk:
Occurs after the given term is evaluated.
</li>

<li>primus:enter-exp:
Occurs before the given exp is evaluated.
</li>

<li>primus:call:
Occurs when the call is made.
</li>

<li>primus:executor-debug:
</li>
</ul>


<ul class="org-ul">
<li>primus:enter-def:
Occurs before the given term is evaluated.
</li>

<li>bap:var-generated:
Occurs when a new value is generated during the read operation
</li>

<li>primus:fini:
Occurs when machine finishes.
</li>

<li>primus:leave-jmp:
Occurs after the given term is evaluated.
</li>

<li>primus:enter-top:
Occurs before the given term is evaluated.
</li>

<li>primus:writing:
Occurs before the value is assigned to the variable.
</li>

<li>primus:incident-new-class:
Occurs when a new incident class is created
</li>

<li>primus:enter-jmp:
Occurs before the given term is evaluated.
</li>

<li>primus:binop:
Occurs on each binary operation.
</li>

<li>primus:leave-exp:
Occurs after the given exp is evaluated.
</li>

<li>primus:incident-new-representative:
Occurs when a new representative of the class is selected
</li>

<li>primus:eval-cond:
Occurs when the jump condition is evaluated.
</li>

<li>primus:unop:
Occurs on each unary operation.
</li>

<li>primus:leave-top:
Occurs after the given term is evaluated.
</li>

<li>primus:enter-blk:
Occurs before the given term is evaluated.
</li>

<li>primus:enter-arg:
Occurs before the given term is evaluated.
</li>

<li>primus:const:
Occurs on each constant.
</li>

<li>primus:assert-failure:
occurs when a symbolic executor assertion doesn't hold
</li>

<li>bap:load-generated:
Occurs when a new value is generated during the load operation
</li>

<li>primus:beagle-prey:
Occurs when the sequence of characters is detected.
</li>

<li>primus:linker-unresolved:
Occurs when a linker hits the unresolved name.
</li>

<li>primus:linker-exec:
Occurs before code with the given name is executed.
</li>

<li>primus:pagefault:
Occurs on pagefault.
</li>

<li>primus:visited-blocks:
visited-blocks (visited,total) is posted every time a new basic block is
visited, where [visited] is the number of already visited blocks and
[total] is the total number of blocks in the program.
</li>

<li>primus:leave-def:
Occurs after the given term is evaluated.
</li>

<li>primus:jumping:
Occurs before the jump to the given destination.
</li>

<li>primus:cfi-violation:
Occurs before the control flow violation is commited.
</li>

<li>primus:init:
Occurs when all components of the machine are initialized.
</li>

<li>primus:loading:
Occurs just before the given address is dereferenced.
</li>

<li>primus:undefined:
Occurs when an undefined value is created.
</li>

<li>primus:beagle:
Occurs when the sequence of characters is classified as text.
</li>

<li>primus:segfault:
Occurs just before the segmentation fault.
</li>

<li>primus:lisp-message:
Occurs with X when (msg x) is evaluated.
</li>

<li>primus:leave-term:
Occurs after the given term is evaluated.
</li>

<li>primus:lisp-call:
Occurs when the call to Lisp code is made.
</li>

<li>primus:read:
Occurs after the given variable is evaluated to the value.
</li>

<li>primus:lisp-type-error:
Occurs when the Lisp type error is detected by the type checker
</li>

<li>primus:system-stop:
Occurs after the system is stopped. Observations
are in the restricted mode
</li>

<li>primus:storing:
Occurs before the value is stored at the address.
</li>

<li>primus:loaded:
Occurs after the given address is read.
</li>

<li>primus:system-start:
Occurs after the system start.
</li>

<li>primus:machine-fork:
Occurs after a machine fork is created.
</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2022-03-26 Sat 01:47</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.2.2 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
