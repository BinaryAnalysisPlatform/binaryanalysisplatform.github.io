<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Bap.Std.Exp.html">
<link rel="next" href="Bap.Std.Arch.html">
<link rel="Up" href="Bap.Std.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class attributes" rel=Appendix href="index_attributes.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of class types" rel=Appendix href="index_class_types.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Core_printers" rel="Chapter" href="Core_printers.html">
<link title="Bap_config" rel="Chapter" href="Bap_config.html">
<link title="Bap_plugins" rel="Chapter" href="Bap_plugins.html">
<link title="Bap_bundle" rel="Chapter" href="Bap_bundle.html">
<link title="Bap" rel="Chapter" href="Bap.html">
<link title="Regular" rel="Chapter" href="Regular.html">
<link title="Monads" rel="Chapter" href="Monads.html">
<link title="Ogre" rel="Chapter" href="Ogre.html">
<link title="Bap_future" rel="Chapter" href="Bap_future.html">
<link title="Graphlib" rel="Chapter" href="Graphlib.html">
<link title="Bap_taint" rel="Chapter" href="Bap_taint.html">
<link title="Bap_primus" rel="Chapter" href="Bap_primus.html">
<link title="Bare" rel="Chapter" href="Bare.html">
<link title="Arm_branch" rel="Chapter" href="Arm_branch.html">
<link title="Arm_env" rel="Chapter" href="Arm_env.html">
<link title="Arm_mul" rel="Chapter" href="Arm_mul.html">
<link title="Arm_bit" rel="Chapter" href="Arm_bit.html">
<link title="Arm_op" rel="Chapter" href="Arm_op.html">
<link title="Arm_reg" rel="Chapter" href="Arm_reg.html">
<link title="Arm_mem" rel="Chapter" href="Arm_mem.html">
<link title="Arm_insn" rel="Chapter" href="Arm_insn.html">
<link title="Arm_mov" rel="Chapter" href="Arm_mov.html">
<link title="Arm_lifter" rel="Chapter" href="Arm_lifter.html">
<link title="Arm_cond" rel="Chapter" href="Arm_cond.html">
<link title="Arm_flags" rel="Chapter" href="Arm_flags.html">
<link title="Arm_types" rel="Chapter" href="Arm_types.html">
<link title="Arm_mem_shift" rel="Chapter" href="Arm_mem_shift.html">
<link title="ARM" rel="Chapter" href="ARM.html">
<link title="Arm_shift" rel="Chapter" href="Arm_shift.html">
<link title="Arm_utils" rel="Chapter" href="Arm_utils.html">
<link title="Arm_helpers" rel="Chapter" href="Arm_helpers.html">
<link title="X86_cpu" rel="Chapter" href="X86_cpu.html">
<link title="X86_env" rel="Chapter" href="X86_env.html">
<link title="X86_types" rel="Chapter" href="X86_types.html">
<link title="Bap_api" rel="Chapter" href="Bap_api.html">
<link title="Bap_abi" rel="Chapter" href="Bap_abi.html">
<link title="Bap_c_type_mapper_intf" rel="Chapter" href="Bap_c_type_mapper_intf.html">
<link title="Bap_c_attr" rel="Chapter" href="Bap_c_attr.html">
<link title="Bap_c_type" rel="Chapter" href="Bap_c_type.html">
<link title="Bap_c_size" rel="Chapter" href="Bap_c_size.html">
<link title="Bap_c" rel="Chapter" href="Bap_c.html">
<link title="Bap_c_abi" rel="Chapter" href="Bap_c_abi.html">
<link title="Bap_c_parser" rel="Chapter" href="Bap_c_parser.html">
<link title="Bap_c_type_printer" rel="Chapter" href="Bap_c_type_printer.html">
<link title="Bap_c_term_attributes" rel="Chapter" href="Bap_c_term_attributes.html">
<link title="Bap_c_type_mapper" rel="Chapter" href="Bap_c_type_mapper.html">
<link title="Bap_c_data" rel="Chapter" href="Bap_c_data.html">
<link title="Bap_bml" rel="Chapter" href="Bap_bml.html">
<link title="Bap_build" rel="Chapter" href="Bap_build.html">
<link title="Bap_byteweight_signatures" rel="Chapter" href="Bap_byteweight_signatures.html">
<link title="Bap_byteweight" rel="Chapter" href="Bap_byteweight.html">
<link title="Bap_demangle" rel="Chapter" href="Bap_demangle.html">
<link title="Bap_dwarf" rel="Chapter" href="Bap_dwarf.html">
<link title="Bap_ida" rel="Chapter" href="Bap_ida.html">
<link title="Bap_llvm" rel="Chapter" href="Bap_llvm.html">
<link title="Bap_llvm_loader" rel="Chapter" href="Bap_llvm_loader.html">
<link title="Bap_traces" rel="Chapter" href="Bap_traces.html">
<link title="Bap_strings_detector" rel="Chapter" href="Bap_strings_detector.html">
<link title="Bap_strings_unscrambler" rel="Chapter" href="Bap_strings_unscrambler.html">
<link title="Bap_strings_index" rel="Chapter" href="Bap_strings_index.html">
<link title="Bap_strings_scanner" rel="Chapter" href="Bap_strings_scanner.html">
<link title="Bap_strings" rel="Chapter" href="Bap_strings.html">
<link title="Text_tags" rel="Chapter" href="Text_tags.html"><title>BAR: BAP Annotated Reference : Bap.Std.Stmt</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Bap.Std.Exp.html" title="Bap.Std.Exp">Previous</a>
&nbsp;<a class="up" href="Bap.Std.html" title="Bap.Std">Up</a>
&nbsp;<a class="post" href="Bap.Std.Arch.html" title="Bap.Std.Arch">Next</a>
</div>
<h1>Module <a href="type_Bap.Std.Stmt.html">Bap.Std.Stmt</a></h1>

<pre><span class="keyword">module</span> Stmt: <code class="code"><span class="keyword">sig</span></code> <a href="Bap.Std.Stmt.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<code class="code"><span class="constructor">Regular</span></code> interface for BIL statements<br>
</div>
<hr width="100%">

<pre><span id="TYPEt"><span class="keyword">type</span> <code class="type"></code>t</span> = <code class="type">Std.Bil.stmt</code> </pre>


<pre><span name="TYPEstate"><span class="keyword">class</span> <a href="Bap.Std.Stmt.state-c.html">state</a></span> : <code class="type"></code><code class="code"><span class="keyword">object</span></code> <a href="Bap.Std.Stmt.state-c.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
All visitors provide some information about the current
        position of the visitor
</div>

<pre><span name="TYPEvisitor"><span class="keyword">class</span> <code class="type">['a]</code> <a href="Bap.Std.Stmt.visitor-c.html">visitor</a></span> : <code class="type"></code><code class="code"><span class="keyword">object</span></code> <a href="Bap.Std.Stmt.visitor-c.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
Visitor.
</div>

<pre><span name="TYPEfinder"><span class="keyword">class</span> <code class="type">['a]</code> <a href="Bap.Std.Stmt.finder-c.html">finder</a></span> : <code class="type"></code><code class="code"><span class="keyword">object</span></code> <a href="Bap.Std.Stmt.finder-c.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
A visitor with a shortcut.
</div>

<pre><span name="TYPEmapper"><span class="keyword">class</span> <a href="Bap.Std.Stmt.mapper-c.html">mapper</a></span> : <code class="type"></code><code class="code"><span class="keyword">object</span></code> <a href="Bap.Std.Stmt.mapper-c.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
AST transformation.
</div>

<pre><span name="TYPEconstant_folder"><span class="keyword">class</span> <a href="Bap.Std.Stmt.constant_folder-c.html">constant_folder</a></span> : <code class="type"></code><code class="type"><a href="Bap.Std.Stmt.mapper-c.html">mapper</a></code></pre><div class="info">
<code class="code">constant_folder</code> is a class that implements the <code class="code">fold_consts</code>
</div>

<pre><span id="VALfold"><span class="keyword">val</span> fold</span> : <code class="type">'a #<a href="Bap.Std.Stmt.visitor-c.html">visitor</a> -> init:'a -> <a href="Bap.Std.Stmt.html#TYPEt">t</a> -> 'a</code></pre><div class="info ">
<code class="code">fold&nbsp;~init&nbsp;visitor&nbsp;stmt</code> folds a <code class="code">stmt</code> with a visitor. See
        <code class="code"><span class="constructor">Bil</span>.fold</code> and <a href="Bap.Std.Exp.html#VALfold"><code class="code"><span class="constructor">Std</span>.<span class="constructor">Exp</span>.fold</code></a> for more details.<br>
</div>

<pre><span id="VALiter"><span class="keyword">val</span> iter</span> : <code class="type">unit #<a href="Bap.Std.Stmt.visitor-c.html">visitor</a> -> <a href="Bap.Std.Stmt.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
<code class="code">iter&nbsp;visitor&nbsp;stmt</code> iters over a <code class="code">stmt</code> with a visitor. See
        <code class="code"><span class="constructor">Bil</span>.iter</code> and <a href="Bap.Std.Exp.html#VALiter"><code class="code"><span class="constructor">Std</span>.<span class="constructor">Exp</span>.iter</code></a> for more details.<br>
</div>

<pre><span id="VALmap"><span class="keyword">val</span> map</span> : <code class="type">#<a href="Bap.Std.Stmt.mapper-c.html">mapper</a> -> <a href="Bap.Std.Stmt.html#TYPEt">t</a> list -> <a href="Bap.Std.Stmt.html#TYPEt">t</a> list</code></pre><div class="info ">
<code class="code">map&nbsp;mapper&nbsp;bil</code> applies <code class="code">mapper</code> to the program <code class="code">bil</code><br>
</div>

<pre><span id="VALfind"><span class="keyword">val</span> find</span> : <code class="type">'a #<a href="Bap.Std.Stmt.finder-c.html">finder</a> -> <a href="Bap.Std.Stmt.html#TYPEt">t</a> -> 'a option</code></pre><div class="info ">
<code class="code">find&nbsp;finder&nbsp;stmt</code> performs a lookup into the Bil statement. See
        <code class="code"><span class="constructor">Bil</span>.find</code> and <a href="Bap.Std.Exp.html#VALfind"><code class="code"><span class="constructor">Std</span>.<span class="constructor">Exp</span>.find</code></a> for more details.<br>
</div>

<pre><span id="VALexists"><span class="keyword">val</span> exists</span> : <code class="type">unit #<a href="Bap.Std.Stmt.finder-c.html">finder</a> -> <a href="Bap.Std.Stmt.html#TYPEt">t</a> -> bool</code></pre><div class="info ">
<code class="code">exists&nbsp;finder&nbsp;stmt</code> is <code class="code"><span class="keyword">true</span></code> iff <code class="code">find&nbsp;finder&nbsp;stmt&nbsp;&lt;&gt;&nbsp;<span class="constructor">None</span></code>.
        See <code class="code"><span class="constructor">Bil</span>.exists</code> and <a href="Bap.Std.Exp.html#VALexists"><code class="code"><span class="constructor">Std</span>.<span class="constructor">Exp</span>.exists</code></a> for more details.<br>
</div>

<pre><span id="VALis_referenced"><span class="keyword">val</span> is_referenced</span> : <code class="type"><a href="Bap.Std.html#TYPEvar">Std.var</a> -> <a href="Bap.Std.Stmt.html#TYPEt">t</a> -> bool</code></pre><div class="info ">
<code class="code">is_referenced&nbsp;x&nbsp;stmt</code> is true is <code class="code">x</code> is used in the <code class="code">stmt</code>
        in any place other then right hand side of the assignment. E.g.,
        <code class="code">is_referenced&nbsp;x&nbsp;<span class="constructor">Bil</span>.(x&nbsp;:=&nbsp;var&nbsp;x)</code> is <code class="code"><span class="keyword">true</span></code>, but
        <code class="code">is_referenced&nbsp;x&nbsp;<span class="constructor">Bil</span>.(x&nbsp;:=&nbsp;var&nbsp;y)</code> is <code class="code"><span class="keyword">false</span></code>.
        see <a href="Bap.Std.Bil.html#VALis_referenced"><code class="code"><span class="constructor">Std</span>.<span class="constructor">Bil</span>.is_referenced</code></a> for more details.<br>
</div>

<pre><span id="VALnormalize"><span class="keyword">val</span> normalize</span> : <code class="type">?normalize_exp:bool -> <a href="Bap.Std.html#TYPEstmt">Std.stmt</a> list -> <a href="Bap.Std.html#TYPEstmt">Std.stmt</a> list</code></pre><div class="info ">
<code class="code">normalize&nbsp;?normalize_exp&nbsp;xs</code> produces a normalized BIL program
        with the same<code class="code">^1</code> semantics but in the BIL normalized
        form (BNF). There are two normalized forms, both described
        below. The first form (BNF1) is more readable, the second form
        (BNF2) is more strict, but sometimes yields a code, that is hard
        for a human to comprehend. The <code class="code"><span class="constructor">BNF1</span></code> is the default, to request
        <code class="code"><span class="constructor">BNF2</span></code> pass <code class="code">normalize_exp:<span class="keyword">true</span></code>.
<p>

        Precondition: <code class="code">xs</code> is well-typed.
<p>

        The BIL First Normalized Form (BNF1) is a subset of the BIL
        language, where expressions have the following properties:
<p>
<ul>
<li>No if-then-else expressions.</li>
</ul>
<ul>
<li>Memory load expressions can be only applied to a memory. This
        effectively disallows creation of temporary memory regions,
        and requires all store operations to be commited via the
        assignemnt operation. Also, this provides a guarantee, that
        store expressions will not occur in integer assigments, jmp
        destinations, and conditional expressions, leaving them valid
        only in an assignment statment where the rhs has type mem_t.
        This is effectively the same as make the <code class="code"><span class="constructor">Load</span></code> constructor to
        have type (<code class="code"><span class="constructor">Load</span>&nbsp;(var,exp,endian,size)</code>).</li>
</ul>

        The BIL Second Normalized Form (BNF2) is a subset of the BNF1
        (in a sense that all BNF2 programs are also in BNF1). This form
        puts the following restrictions:
<p>
<ul>
<li>No let expressions - new variables can be created only with
        the Move instruction.</li>
</ul>
<ul>
<li>All memory operations have sizes equal to one byte. Thus the
        size and endiannes can be ignored in analysis. During the
        normalization, the following rewrites are performed
        <pre class="verbatim">       let x = &lt;expr&gt; in ... x ... =&gt; ... &lt;expr&gt; ...
       x[a,el]:n =&gt; x[a+n-1] @ ... @ x[a]
       x[a,be]:n =&gt; x[a] @ ... @ x[a+n-1]
       m[a,el]:n &lt;- x =&gt; (...((m[a] &lt;- x&lt;0&gt;)[a+1] &lt;- x&lt;1&gt;)...)[a+n-1] &lt;- x&lt;n-1&gt;
       m[a,be]:n &lt;- x =&gt; (...((m[a] &lt;- x&lt;n-1&gt;)[a+1] &lt;- x&lt;n&gt;)...)[a+n-1] &lt;- x&lt;0&gt;
       ... ite c ? x : y ... =&gt; if c { ... x ... } { ... y ... }
       (x[a] &lt;- b)[c] =&gt; m := x[a] &lt;- b; m[c]
     </pre></li>
</ul>

        <code class="code">^1</code>: The normalization procedure may duplicate expressions
        that might be considered non-generative. For example,
<p>

        <code class="code"><span class="keyword">let</span>&nbsp;x&nbsp;=&nbsp;m[a]&nbsp;<span class="keyword">in</span>&nbsp;x&nbsp;+&nbsp;x</code>
<p>

        is rewritten to <code class="code">m[a]&nbsp;+&nbsp;m[a]</code>. Given a concrete semantics of a
        memory (for example, if memory is mapped to a device register
        that changes every times it is read) this expression may have
        different value. It will also have different effect (such as
        two memory accesses, page faults etc).
<p>

        However, in the formal semantics of BAP we do not consider
        effects, and treat all expressions as side-effect free, thus the
        above transformation, are preserving the semantics.<br>
<b>Since</b> 1.3<br>
</div>
<div class="param_info"><code class="code">normalize_exp</code> : (defaults to <code class="code"><span class="keyword">false</span></code>) if set to <code class="code"><span class="keyword">true</span></code> then
        the returned program will be in BNF2.</div>

<pre><span id="VALsimpl"><span class="keyword">val</span> simpl</span> : <code class="type">?ignore:<a href="Bap.Std.Eff.html#TYPEt">Std.Eff.t</a> list -> <a href="Bap.Std.Stmt.html#TYPEt">t</a> list -> <a href="Bap.Std.Stmt.html#TYPEt">t</a> list</code></pre><div class="info ">
<code class="code">simpl&nbsp;?ignore&nbsp;xs</code> recursively applies <code class="code"><span class="constructor">Exp</span>.simpl</code> and also
        simplifies <code class="code"><span class="keyword">if</span></code> and <code class="code"><span class="keyword">while</span></code> expressions with statically known
        conditionals, e.g., <code class="code"><span class="keyword">if</span>&nbsp;(<span class="keyword">true</span>)&nbsp;xs&nbsp;ys</code> is simplified to <code class="code">xs</code>,
        <code class="code"><span class="keyword">while</span>&nbsp;(<span class="keyword">false</span>)&nbsp;xs</code> is simplified to <code class="code">xs</code>.<br>
<b>Since</b> 1.3<br>
</div>

<pre><span id="VALfixpoint"><span class="keyword">val</span> fixpoint</span> : <code class="type">(<a href="Bap.Std.Stmt.html#TYPEt">t</a> -> <a href="Bap.Std.Stmt.html#TYPEt">t</a>) -> <a href="Bap.Std.Stmt.html#TYPEt">t</a> -> <a href="Bap.Std.Stmt.html#TYPEt">t</a></code></pre><div class="info ">
<code class="code">fixpoint&nbsp;f&nbsp;x</code> applies transformation <code class="code">f</code> until it reaches
        fixpoint. See <a href="Bap.Std.Bil.html#VALfixpoint"><code class="code"><span class="constructor">Std</span>.<span class="constructor">Bil</span>.fixpoint</code></a> and .<br>
</div>

<pre><span id="VALfree_vars"><span class="keyword">val</span> free_vars</span> : <code class="type"><a href="Bap.Std.Stmt.html#TYPEt">t</a> -> Std.Var.Set.t</code></pre><div class="info ">
<code class="code">free_vars&nbsp;stmt</code> returns a set of all unbound variables, that
        occurs in <code class="code">stmt</code>.<br>
</div>

<pre><span id="VALeval"><span class="keyword">val</span> eval</span> : <code class="type"><a href="Bap.Std.Stmt.html#TYPEt">t</a> list -> (#<a href="Bap.Std.Bili.context-c.html">Std.Bili.context</a> as 'a) -> 'a</code></pre><div class="info ">
<code class="code">eval&nbsp;prog</code> eval BIL program under given context. Returns the
        context which contains all effects of computations.<br>
</div>

<pre><span class="keyword">include</span> Regular.S</pre>
</body></html>