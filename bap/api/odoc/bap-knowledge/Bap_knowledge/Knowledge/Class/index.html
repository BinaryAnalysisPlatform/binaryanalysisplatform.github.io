<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Class (bap-knowledge.Bap_knowledge.Knowledge.Class)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../../index.html">bap-knowledge</a> &#x00BB; <a href="../../index.html">Bap_knowledge</a> &#x00BB; <a href="../index.html">Knowledge</a> &#x00BB; Class</nav><h1>Module <code>Knowledge.Class</code></h1><p>Class is a collection of sorts.</p><p>A class <code>k</code> is denoted by an indexed type <code>(k,s) cls</code>, where <code>s</code> is a sort.</p><p>A class denotes a set of properties that describe objects and values of the given class. Thus, a class fully defines the structure of an object or a value. Sorts could be used to further partition the class into subsets, if needed.</p><p>Classes are declarative and each class should have a unique name. To prevent name clashing the Knowledge Library employs a Common Lisp style namespaces, where each name belongs to a package.</p><p>The type index, associated with the class, should be protected by the module that declares the class. For example, it is a bad idea to use the <code>unit</code> type as an index of a class.</p></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> <span>(+'k, 's) t</span></code><code> = <span><span>(<span class="type-var">'k</span>, <span class="type-var">'s</span>)</span> <a href="../index.html#type-cls">cls</a></span></code></dt></dl><dl><dt class="spec value" id="val-declare"><a href="#val-declare" class="anchor"></a><code><span class="keyword">val</span> declare : <span>?&#8288;public:bool</span> <span>&#45;&gt;</span> <span>?&#8288;desc:string</span> <span>&#45;&gt;</span> <span>?&#8288;package:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span class="type-var">'s</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'k</span>, <span class="type-var">'s</span>)</span> <a href="../index.html#type-cls">cls</a></span></code></dt><dd><p><code>declare name sort</code> declares a new class with the given <code>name</code> and <code>sort</code> index.</p><p>Since classes are declarative each new declaration creates a new class that is not equal to any other.</p><p>The <code>package</code> and <code>name</code> pair should be unique. If there is already a class with the given <code>package:name</code> then the declaration fails.</p><dl><dt>parameter public</dt><dd><p>(defaults to false) if specified, then the class will referenced in the Knowledge documentation output.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-refine"><a href="#val-refine" class="anchor"></a><code><span class="keyword">val</span> refine : <span><span>(<span class="type-var">'k</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span>&#45;&gt;</span> <span class="type-var">'s</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'k</span>, <span class="type-var">'s</span>)</span> <a href="../index.html#type-cls">cls</a></span></code></dt><dd><p><code>refine cls s</code> refines the <code>sort</code> of class <code>'k</code> to <code>s</code>.</p></dd></dl><dl><dt class="spec value" id="val-same"><a href="#val-same" class="anchor"></a><code><span class="keyword">val</span> same : <span><span>(<span class="type-var">'a</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>same x y</code> is true if <code>x</code> and <code>y</code> denote the same class <code>k</code></p></dd></dl><dl><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <span><span>(<span class="type-var">'a</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span>&#45;&gt;</span> <span><span><span>(<span><span class="type-var">'a</span> <a href="../index.html#type-obj">obj</a></span>, <span><span class="type-var">'b</span> <a href="../index.html#type-obj">obj</a></span>)</span> <a href="../../../../core_kernel/Core_kernel/Type_equal/index.html#type-t">Core_kernel.Type_equal.t</a></span> option</span></code></dt><dd><p><code>equal x y</code> constructs a type witness of classes equality.</p><p>The witness could be used to cast objects of the same class, e.g.,</p><pre><code class="ml">match equal bitv abs with
| Some t -&gt; Object.cast t x y
| _ -&gt; ...</code></pre><p>Note that the equality is reflexive, so the obtained witness could be used in both direction, for upcasting and downcasting.</p></dd></dl><dl><dt class="spec value" id="val-assert_equal"><a href="#val-assert_equal" class="anchor"></a><code><span class="keyword">val</span> assert_equal : <span><span>(<span class="type-var">'a</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'b</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span>&#45;&gt;</span> <span><span>(<span><span class="type-var">'a</span> <a href="../index.html#type-obj">obj</a></span>, <span><span class="type-var">'b</span> <a href="../index.html#type-obj">obj</a></span>)</span> <a href="../../../../core_kernel/Core_kernel/Type_equal/index.html#type-t">Core_kernel.Type_equal.t</a></span></code></dt><dd><p><code>assert_equal x y</code> asserts the equality of two classes.</p><p>Usefull, in the context where the class is known for sure, (e.g., constrained by the module signature), but has to be recreated. The <code>let T = assert_equal x y</code> expression, establishes a type equality between objects in the typing context, so there is no need to invoke <code>Object.cast</code>.</p><pre><code class="ml">let add : value obj -&gt; value obj -&gt; value obj = fun x y -&gt;
  let T = assert_equal bitv value in
  x + y (* where (+) has type [bitv obj -&gt; bitv obj -&gt; bit obj] *)</code></pre></dd></dl><dl><dt class="spec value" id="val-property"><a href="#val-property" class="anchor"></a><code><span class="keyword">val</span> property : <span>?&#8288;public:bool</span> <span>&#45;&gt;</span> <span>?&#8288;desc:string</span> <span>&#45;&gt;</span> <span>?&#8288;persistent:<span><span class="type-var">'p</span> <a href="../index.html#type-persistent">persistent</a></span></span> <span>&#45;&gt;</span> <span>?&#8288;package:string</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'k</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span class="type-var">'p</span> <a href="../index.html#type-domain">domain</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'k</span>, <span class="type-var">'p</span>)</span> <a href="../index.html#type-slot">slot</a></span></code></dt><dd><p><code>property cls name dom</code> declares a new property of all instances of class <code>k</code>.</p><p>Each property should have a unique name. If a property with the given name was already, then the declaration fails.</p><p>The returned slot can be used to access the declarated property. If the property is expected to be public then it should be published via a library interface.</p><dl><dt>parameter persistent</dt><dd><p>is an instance of the <code>persistent</code> class that will be used to persist the property.</p></dd></dl><dl><dt>parameter desc</dt><dd><p>is a property documentation.</p></dd></dl><dl><dt>parameter public</dt><dd><p>(defaults to false) if specified, then the property will referenced in the Knowledge documentation output.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-name"><a href="#val-name" class="anchor"></a><code><span class="keyword">val</span> name : <span><span>(<span class="type-var">'a</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span>&#45;&gt;</span> <a href="../index.html#type-name">name</a></code></dt><dd><p><code>name cls</code> is the class name.</p></dd></dl><dl><dt class="spec value" id="val-sort"><a href="#val-sort" class="anchor"></a><code><span class="keyword">val</span> sort : <span><span>(<span class="type-var">'k</span>, <span class="type-var">'s</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span>&#45;&gt;</span> <span class="type-var">'s</span></code></dt><dd><p><code>sort cls</code> returns the sort index of the class <code>k</code>.</p></dd></dl></div></body></html>