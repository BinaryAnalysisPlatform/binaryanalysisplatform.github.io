<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Class (bap-knowledge.Bap_knowledge.Knowledge.Class)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../../index.html">bap-knowledge</a> &#x00BB; <a href="../../index.html">Bap_knowledge</a> &#x00BB; <a href="../index.html">Knowledge</a> &#x00BB; Class</nav><header class="odoc-preamble"><h1>Module <code><span>Knowledge.Class</span></code></h1><p>Class is a collection of sorts.</p><p>A class <code>k</code> is denoted by an indexed type <code>(k,s) cls</code>, where <code>s</code> is a sort.</p><p>A class denotes a set of properties that describe objects and values of the given class. Thus, a class fully defines the structure of an object or a value. Sorts could be used to further partition the class into subsets, if needed.</p><p>Classes are declarative and each class should have a unique name. To prevent name clashing the Knowledge Library employs a Common Lisp style namespaces, where each name belongs to a package.</p><p>The type index, associated with the class, should be protected by the module that declares the class. For example, it is a bad idea to use the <code>unit</code> type as an index of a class.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>(+'k, 's) t</span></span><span> = <span><span>(<span class="type-var">'k</span>, <span class="type-var">'s</span>)</span> <a href="../index.html#type-cls">cls</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-declare" class="anchored"><a href="#val-declare" class="anchor"></a><code><span><span class="keyword">val</span> declare : <span>?public:bool <span class="arrow">&#45;&gt;</span></span> <span>?desc:string <span class="arrow">&#45;&gt;</span></span> <span>?package:string <span class="arrow">&#45;&gt;</span></span>
<span>string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'s</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'k</span>, <span class="type-var">'s</span>)</span> <a href="../index.html#type-cls">cls</a></span></span></code></div><div class="spec-doc"><p><code>declare name sort</code> declares a new class with the given <code>name</code> and <code>sort</code> index.</p><p>Since classes are declarative each new declaration creates a new class that is not equal to any other.</p><p>The <code>package</code> and <code>name</code> pair should be unique. If there is already a class with the given <code>package:name</code> then the declaration fails.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">public</span> <p>(defaults to false) if specified, then the class will referenced in the Knowledge documentation output.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-refine" class="anchored"><a href="#val-refine" class="anchor"></a><code><span><span class="keyword">val</span> refine : <span><span><span>(<span class="type-var">'k</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'s</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'k</span>, <span class="type-var">'s</span>)</span> <a href="../index.html#type-cls">cls</a></span></span></code></div><div class="spec-doc"><p><code>refine cls s</code> refines the <code>sort</code> of class <code>'k</code> to <code>s</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-same" class="anchored"><a href="#val-same" class="anchor"></a><code><span><span class="keyword">val</span> same : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'b</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>same x y</code> is true if <code>x</code> and <code>y</code> denote the same class <code>k</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-equal" class="anchored"><a href="#val-equal" class="anchor"></a><code><span><span class="keyword">val</span> equal : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'b</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span><span class="type-var">'a</span> <a href="../index.html#type-obj">obj</a></span>, <span><span class="type-var">'b</span> <a href="../index.html#type-obj">obj</a></span>)</span> <span class="xref-unresolved">Core_kernel</span>.Type_equal.t</span> option</span></span></code></div><div class="spec-doc"><p><code>equal x y</code> constructs a type witness of classes equality.</p><p>The witness could be used to cast objects of the same class, e.g.,</p><pre><code>match equal bitv abs with
| Some t -&gt; Object.cast t x y
| _ -&gt; ...</code></pre><p>Note that the equality is reflexive, so the obtained witness could be used in both direction, for upcasting and downcasting.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-assert_equal" class="anchored"><a href="#val-assert_equal" class="anchor"></a><code><span><span class="keyword">val</span> assert_equal : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'b</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <a href="../index.html#type-obj">obj</a></span>, <span><span class="type-var">'b</span> <a href="../index.html#type-obj">obj</a></span>)</span> <span class="xref-unresolved">Core_kernel</span>.Type_equal.t</span></span></code></div><div class="spec-doc"><p><code>assert_equal x y</code> asserts the equality of two classes.</p><p>Usefull, in the context where the class is known for sure, (e.g., constrained by the module signature), but has to be recreated. The <code>let T = assert_equal x y</code> expression, establishes a type equality between objects in the typing context, so there is no need to invoke <code>Object.cast</code>.</p><pre><code>let add : value obj -&gt; value obj -&gt; value obj = fun x y -&gt;
  let T = assert_equal bitv value in
  x + y (* where (+) has type [bitv obj -&gt; bitv obj -&gt; bit obj] *)</code></pre></div></div><div class="odoc-spec"><div class="spec value" id="val-property" class="anchored"><a href="#val-property" class="anchor"></a><code><span><span class="keyword">val</span> property : <span>?public:bool <span class="arrow">&#45;&gt;</span></span> <span>?desc:string <span class="arrow">&#45;&gt;</span></span> <span>?persistent:<span><span class="type-var">'p</span> <a href="../index.html#type-persistent">persistent</a></span> <span class="arrow">&#45;&gt;</span></span> <span>?package:string <span class="arrow">&#45;&gt;</span></span>
<span><span><span>(<span class="type-var">'k</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'p</span> <a href="../index.html#type-domain">domain</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'k</span>, <span class="type-var">'p</span>)</span> <a href="../index.html#type-slot">slot</a></span></span></code></div><div class="spec-doc"><p><code>property cls name dom</code> declares a new property of all instances of class <code>k</code>.</p><p>Each property should have a unique name. If a property with the given name was already, then the declaration fails.</p><p>The returned slot can be used to access the declarated property. If the property is expected to be public then it should be published via a library interface.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">persistent</span> <p>is an instance of the <code>persistent</code> class that will be used to persist the property.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">desc</span> <p>is a property documentation.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">public</span> <p>(defaults to false) if specified, then the property will referenced in the Knowledge documentation output.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-name" class="anchored"><a href="#val-name" class="anchor"></a><code><span><span class="keyword">val</span> name : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">_</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-name">name</a></span></code></div><div class="spec-doc"><p><code>name cls</code> is the class name.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-sort" class="anchored"><a href="#val-sort" class="anchor"></a><code><span><span class="keyword">val</span> sort : <span><span><span>(<span class="type-var">'k</span>, <span class="type-var">'s</span>)</span> <a href="../index.html#type-cls">cls</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'s</span></span></code></div><div class="spec-doc"><p><code>sort cls</code> returns the sort index of the class <code>k</code>.</p></div></div></div></body></html>