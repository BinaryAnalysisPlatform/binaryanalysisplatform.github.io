<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>V1 (bap-c.Bap_c_abi.Arg.Language.V1)</title><link rel="stylesheet" href="../../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">bap-c</a> &#x00BB; <a href="../../../index.html">Bap_c_abi</a> &#x00BB; <a href="../../index.html">Arg</a> &#x00BB; <a href="../index.html">Language</a> &#x00BB; V1</nav><header class="odoc-preamble"><h1>Module type <code><span>Language.V1</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value" id="val-install" class="anchored"><a href="#val-install" class="anchor"></a><code><span><span class="keyword">val</span> install : 
  <span><a href="../../../../../bap-core-theory/Bap_core_theory/Theory/Target/index.html#type-t">Bap_core_theory.Theory.Target.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../Bap_c_size/class-base/index.html">Bap_c_size.base</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span>( <span>?finish:<span>unit <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
      <span>return:<span>( <span>alignment:int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-statement">statement</a> )</span> <span class="arrow">&#45;&gt;</span></span>
      <span><span>( <span>alignment:int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-statement">statement</a> )</span> <span class="arrow">&#45;&gt;</span></span>
      <span>unit <a href="../../index.html#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
    <span>unit <a href="../../index.html#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>install target data_model specification</code></p><p>The toplevel function that is used to install the calling convention for the given target. The general syntax follows this structure,</p><pre><code>describe t data @@ fun declare -&gt;
let* arena1 = &lt;arena-specification&gt; in
let* arenaN = &lt;arena-specification&gt; in
let return ~alignment x = &lt;statement&gt; in
let arg ~alignment x = &lt;statement&gt; in
let finish = &lt;finalization-procedure&gt; in
let* () = &lt;initialization-procedure&gt; in
declare ~finish ~return arg</code></pre><p>For example, the following specification describes ARM calling convention AAPCS32,</p><pre><code>let define t =
  install t model @@ fun describe -&gt;
  let* iargs = Arg.Arena.iargs t in
  let* irets = Arg.Arena.irets t in
  let rev = Theory.Endianness.(Theory.Target.endianness t = le) in
  let return ~alignment:_ size = select [
      C.Type.is_basic, select [
        is (size &lt;= 32 * 2), Arg.registers ~rev  irets;
        otherwise, Arg.reference iargs;
      ];
      is (size &lt;= 32), Arg.register irets;
      otherwise, Arg.reference iargs;
    ] in
  describe ~return @@ fun ~alignment _ -&gt;
  sequence [
    is (alignment = 64), const (Arg.align_even iargs);
    always, choose [
      Arg.split_with_memory ~rev iargs;
      Arg.memory
    ];
  ]</code></pre></div></div><div class="odoc-spec"><div class="spec value" id="val-sequence" class="anchored"><a href="#val-sequence" class="anchor"></a><code><span><span class="keyword">val</span> sequence : <span><a href="../index.html#type-commands">commands</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-statement">statement</a></span></code></div><div class="spec-doc"><p><code>sequence cmd</code> executes a sequence of predicated statements.</p><p>Executes all commands in the specified order. A command's statement is executed if the commands predicate is evaluates to <code>true</code>. Otherwise the statement is skipped.</p><p>If an evaluated statement rejects a computation then the whole sequence will be rejected.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-select" class="anchored"><a href="#val-select" class="anchor"></a><code><span><span class="keyword">val</span> select : <span><a href="../index.html#type-commands">commands</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-statement">statement</a></span></code></div><div class="spec-doc"><p><code>select t spec</code> selects the first applicable option to pass <code>t</code>.</p><p>The form,</p><pre><code>select [
  pred1, option1;
  pred2, option2;
  ...,...;
  predN, optionN;
]</code></pre><p>Tries <code>pred1 arg</code>, <code>pred2 arg</code>, ..., <code>predN arg</code> in order until the first one that returns <code>true</code> and uses the corresponding option to pass the argument.</p><p>The computation is rejected if either the selected option rejects the computation or none options were selected.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-case" class="anchored"><a href="#val-case" class="anchor"></a><code><span><span class="keyword">val</span> case : <span><span>( <span><a href="../../index.html#type-ctype">ctype</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../index.html#type-cls">cls</a></span> <a href="../../index.html#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span><span class="type-var">'a</span> <a href="../index.html#type-cls">cls</a></span> * <a href="../index.html#type-statement">statement</a>)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-statement">statement</a></span></code></div><div class="spec-doc"><p><code>case classifer commands</code> case analysis.</p><p>The case combinator first classfies the argument using the <code>classfier</code> function, which shall return a polymoprhic variant, and then selects a command that matches the selected class.</p><p>Rejects the computation if there's no matching class.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-any" class="anchored"><a href="#val-any" class="anchor"></a><code><span><span class="keyword">val</span> any : <span><a href="../index.html#type-predicates">predicates</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-predicate">predicate</a></span></code></div><div class="spec-doc"><p><code>any ps</code> holds if any of <code>ps</code> holds.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-all" class="anchored"><a href="#val-all" class="anchor"></a><code><span><span class="keyword">val</span> all : <span><a href="../index.html#type-predicates">predicates</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-predicate">predicate</a></span></code></div><div class="spec-doc"><p><code>all ps</code> holds if all of <code>ps</code> hold.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-neither" class="anchored"><a href="#val-neither" class="anchor"></a><code><span><span class="keyword">val</span> neither : <span><a href="../index.html#type-predicates">predicates</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-predicate">predicate</a></span></code></div><div class="spec-doc"><p><code>neither ps</code> holds if neither of <code>ps</code> hold.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-is" class="anchored"><a href="#val-is" class="anchor"></a><code><span><span class="keyword">val</span> is : <span>bool <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-predicate">predicate</a></span></code></div><div class="spec-doc"><p><code>is cnd</code> holds if <code>cnd</code> holds.</p><p>Example, </p><pre><code>[
  is (size &gt; 64), memory;
  otherwise, registers;

]</code></pre></div></div><div class="odoc-spec"><div class="spec value" id="val-otherwise" class="anchored"><a href="#val-otherwise" class="anchor"></a><code><span><span class="keyword">val</span> otherwise : <a href="../index.html#type-predicate">predicate</a></span></code></div><div class="spec-doc"><p><code>otherwise</code> is a predicate that is always <code>true</code>.</p><p>I.e., it is <code>is true</code>.</p><p>This predicate is supposed to be used with the <code>select</code> combinator as the last, catch-all, predicate, e.g.,</p><pre><code>select arg [
  is_fundamental, pass_fundamental;
  is_floating, pass_floating;
  otherwise, pass_memory;
]</code></pre></div></div><div class="odoc-spec"><div class="spec value" id="val-always" class="anchored"><a href="#val-always" class="anchor"></a><code><span><span class="keyword">val</span> always : <a href="../index.html#type-predicate">predicate</a></span></code></div><div class="spec-doc"><p><code>always</code> is a predicate that is always <code>true</code>, i.e., <code>is true</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-never" class="anchored"><a href="#val-never" class="anchor"></a><code><span><span class="keyword">val</span> never : <a href="../index.html#type-predicate">predicate</a></span></code></div><div class="spec-doc"><p><code>never</code> is a predicate that never holds, i.e., <code>is false</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-choose" class="anchored"><a href="#val-choose" class="anchor"></a><code><span><span class="keyword">val</span> choose : <span><a href="../index.html#type-statements">statements</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-statement">statement</a></span></code></div><div class="spec-doc"><p><code>choose options</code> tries options in order until the first on that is not rejected.</p><p>This combinator is like <code>choice</code> but is supposed to be used inside <code>select</code>, e.g.,</p><pre><code>select arg [
  p1, choose [o1, o2];
  either [p2; p3], choose [o3,o4];
]</code></pre></div></div><div class="odoc-spec"><div class="spec value" id="val-combine" class="anchored"><a href="#val-combine" class="anchor"></a><code><span><span class="keyword">val</span> combine : <span><a href="../index.html#type-statements">statements</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-statement">statement</a></span></code></div><div class="spec-doc"><p><code>combine xs</code> combines statements into a signle statement.</p><p>Evaluates statements in the order they are specified. If any of the statements rejects then the whole statement will be rejected.</p></div></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../../../../../monads/Monads/Std/Monad/Syntax/module-type-S/index.html">Monads.Std.Monad.Syntax.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <span>'a <a href="../../../../../monads/Monads/Std/Monad/Syntax/module-type-S/index.html#type-t">t</a></span> := <span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span></span></span></code></summary><div class="odoc-spec"><div class="spec value" id="val-(&gt;&gt;=)" class="anchored"><a href="#val-(&gt;&gt;=)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;&gt;=) : <span><span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>m &gt;&gt;= f</code> is <code>bind m f</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-(&gt;&gt;|)" class="anchored"><a href="#val-(&gt;&gt;|)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;&gt;|) : <span><span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>m &gt;&gt;= f</code> is <code>map m ~f</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-(&gt;=&gt;)" class="anchored"><a href="#val-(&gt;=&gt;)" class="anchor"></a><code><span><span class="keyword">val</span> (&gt;=&gt;) : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'c</span> <a href="../../index.html#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'c</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>f &gt;=&gt; g</code> is <code>fun x -&gt; f x &gt;&gt;= g</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-(!!)" class="anchored"><a href="#val-(!!)" class="anchor"></a><code><span><span class="keyword">val</span> (!!) : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>!!x</code> is <code>return x</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-(!$)" class="anchored"><a href="#val-(!$)" class="anchor"></a><code><span><span class="keyword">val</span> (!$) : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>!$f</code> is <code>Lift.unary f</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-(!$$)" class="anchored"><a href="#val-(!$$)" class="anchor"></a><code><span><span class="keyword">val</span> (!$$) : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'c</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>!$$f</code> is <code>Lift.binary f</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-(!$$$)" class="anchored"><a href="#val-(!$$$)" class="anchor"></a><code><span><span class="keyword">val</span> (!$$$) : <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'c</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'d</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'c</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'d</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>!$$$f</code> is <code>Lift.ternary f</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-(!$$$$)" class="anchored"><a href="#val-(!$$$$)" class="anchor"></a><code><span><span class="keyword">val</span> (!$$$$) : 
  <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'c</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'d</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'e</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'e</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>!$$$$f</code> is <code>Lift.quaternary f</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-(!$$$$$)" class="anchored"><a href="#val-(!$$$$$)" class="anchor"></a><code><span><span class="keyword">val</span> (!$$$$$) : 
  <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'c</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'d</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'e</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'f</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'e</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'f</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>!$$$$$f</code> is <code>Lift.quinary f</code></p></div></div></details></div><div class="odoc-include"><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../../../../../monads/Monads/Std/Monad/Syntax/Let/module-type-S/index.html">Monads.Std.Monad.Syntax.Let.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <span>'a <a href="../../../../../monads/Monads/Std/Monad/Syntax/Let/module-type-S/index.html#type-t">t</a></span> := <span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span></span></span></code></summary><div class="odoc-spec"><div class="spec value" id="val-let*" class="anchored"><a href="#val-let*" class="anchor"></a><code><span><span class="keyword">val</span> let* : <span><span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>let* r = f x in b</code> is <code>f x &gt;&gt;= fun r -&gt; b</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-and*" class="anchored"><a href="#val-and*" class="anchor"></a><code><span><span class="keyword">val</span> and* : <span><span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p>monoidal product</p></div></div><div class="odoc-spec"><div class="spec value" id="val-let+" class="anchored"><a href="#val-let+" class="anchor"></a><code><span><span class="keyword">val</span> let+ : <span><span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>let+ r = f x in b</code> is <code>f x &gt;&gt;| fun r -&gt; b</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-and+" class="anchored"><a href="#val-and+" class="anchor"></a><code><span><span class="keyword">val</span> and+ : <span><span><span class="type-var">'a</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="../../index.html#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="../../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p>monoidal product</p></div></div></details></div></div></body></html>