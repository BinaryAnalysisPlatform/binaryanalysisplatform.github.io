<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Observation (bap-taint.Bap_taint.Std.Taint.Kind.Make.1-Machine.Observation)</title><link rel="stylesheet" href="../../../../../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../../../../../index.html">bap-taint</a> &#x00BB; <a href="../../../../../../index.html">Bap_taint</a> &#x00BB; <a href="../../../../../index.html">Std</a> &#x00BB; <a href="../../../../index.html">Taint</a> &#x00BB; <a href="../../../index.html">Kind</a> &#x00BB; <a href="../../index.html">Make</a> &#x00BB; <a href="../index.html">1-Machine</a> &#x00BB; Observation</nav><h1>Module <code>1-Machine.Observation</code></h1><p>Observations interface.</p></header><dl><dt class="spec value" id="val-observe"><a href="#val-observe" class="anchor"></a><code><span class="keyword">val</span> observe : <span><span class="type-var">'a</span> <a href="../../../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-observation">Bap_primus.Std.Primus.observation</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span>unit <a href="../index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span>unit <a href="../index.html#type-t">t</a></span></code></dt><dd><p><code>observe obs on_observation</code> subscribes to the given observation <code>obs</code>. Every time the observation <code>obs</code> is made a function <code>on_observation</code> is called. The function can perform arbitrary computations in the machine monad, e.g., make its own computations, or access other components via their interfaces.</p></dd></dl><dl><dt class="spec value" id="val-subscribe"><a href="#val-subscribe" class="anchor"></a><code><span class="keyword">val</span> subscribe : <span><span class="type-var">'a</span> <a href="../../../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-observation">Bap_primus.Std.Primus.observation</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span>unit <a href="../index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span><a href="../../../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-subscription">Bap_primus.Std.Primus.subscription</a> <a href="../index.html#type-t">t</a></span></code></dt><dd><p><code>subscribe obs handler</code> creates a cancelable subscription to the observation <code>obs</code>.</p><p>Returns a subscription handler that could be used to cancel the subscription.</p><dl><dt>since</dt><dd>2.1.0</dd></dl></dd></dl><dl><dt class="spec value" id="val-cancel"><a href="#val-cancel" class="anchor"></a><code><span class="keyword">val</span> cancel : <a href="../../../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-subscription">Bap_primus.Std.Primus.subscription</a> <span>&#45;&gt;</span> <span>unit <a href="../index.html#type-t">t</a></span></code></dt><dd><p><code>cancel sub</code> cancels the given subscription.</p><p>An observation that was registered under this subscription won't be called anymore.</p><dl><dt>since</dt><dd>2.1.0</dd></dl></dd></dl><dl><dt class="spec value" id="val-watch"><a href="#val-watch" class="anchor"></a><code><span class="keyword">val</span> watch : <a href="../../../../../../../../bap-primus/Bap_primus/Std/Primus/Observation/index.html#type-provider">Bap_primus.Std.Primus.Observation.provider</a> <span>&#45;&gt;</span> <span>(<a href="../../../../../../../../core_kernel/Core_kernel/Sexp/index.html#type-t">Core_kernel.Sexp.t</a> <span>&#45;&gt;</span> <span>unit <a href="../index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span>unit <a href="../index.html#type-t">t</a></span></code></dt><dd><p><code>watch prov data</code> watches for the data provider.</p><p>This function is the same as <code>observe</code> except that it uses the provider to access the observation and gets the observation in the sexp-serialized form.</p></dd></dl><dl><dt class="spec value" id="val-make"><a href="#val-make" class="anchor"></a><code><span class="keyword">val</span> make : <span><span class="type-var">'a</span> <a href="../../../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-statement">Bap_primus.Std.Primus.statement</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span>unit <a href="../index.html#type-t">t</a></span></code></dt><dd><p><code>make observation event</code> make an <code>observation</code> of the given <code>event</code>.</p></dd></dl><dl><dt class="spec value" id="val-post"><a href="#val-post" class="anchor"></a><code><span class="keyword">val</span> post : <span><span class="type-var">'a</span> <a href="../../../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-statement">Bap_primus.Std.Primus.statement</a></span> <span>&#45;&gt;</span> <span>f:<span>(<span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span>unit <a href="../index.html#type-t">t</a></span>)</span> <span>&#45;&gt;</span> <span>unit <a href="../index.html#type-t">t</a></span>)</span></span> <span>&#45;&gt;</span> <span>unit <a href="../index.html#type-t">t</a></span></code></dt><dd><p><code>post observation k</code> makes observation if necessary.</p><p>The continuation <code>k</code> is a function that is called only when the given statement has subscribers.</p><p>Use this function to skip creating an observation if nobody is interested in it. This is useful, when the observation has some cost to construct, so when there no subscribers no machine cycles will be lost.</p><p>The function <code>k</code> receives a <code>provide</code> function that could be used to provide observation once it is ready, e.g.,</p><pre><code class="ml">Observation.post big_thing ~f:(fun provide -&gt;
    some_costly_function1 &gt;&gt;= fun x -&gt;
    some_costly_function2 &gt;&gt;= fun y -&gt;
    some_costly_function3 &gt;&gt;= fun z -&gt;
    provide (x,y,z))</code></pre><p>Note: even for observations that are tuples this function is efficient as sometimes the compiler can optimize the closure creation or the closure itself might be smaller than the created observation.</p><dl><dt>since</dt><dd>2.1.0</dd></dl></dd></dl></div></body></html>