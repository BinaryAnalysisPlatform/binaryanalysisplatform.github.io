<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make (bap-taint.Bap_taint.Std.Taint.Tracker.Make)</title><link rel="stylesheet" href="../../../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../../index.html">bap-taint</a> &#x00BB; <a href="../../../../index.html">Bap_taint</a> &#x00BB; <a href="../../../index.html">Std</a> &#x00BB; <a href="../../index.html">Taint</a> &#x00BB; <a href="../index.html">Tracker</a> &#x00BB; Make</nav><header class="odoc-preamble"><h1>Module <code><span>Tracker.Make</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#parameters">Parameters</a></li><li><a href="#signature_3">Signature</a><ul><li><a href="#the-low-level-interface">The low-level interface</a></li><li><a href="#high-level-interface">High-level interface</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="parameters"><a href="#parameters" class="anchor"></a>Parameters</h2><div class="odoc-spec"><div class="spec parameter anchored" id="argument-1-Machine"><a href="#argument-1-Machine" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="argument-1-Machine/index.html">Machine</a></span><span> : <a href="../../../../../../bap-primus/Bap_primus/Std/Primus/Machine/module-type-S/index.html">Bap_primus.Std.Primus.Machine.S</a></span></code></div></div><h2 id="signature_3"><a href="#signature_3" class="anchor"></a>Signature</h2><h4 id="the-low-level-interface"><a href="#the-low-level-interface" class="anchor"></a>The low-level interface</h4><p>The low-level interface defines three primitives in terms of which we can express a more convenient high-level interface. It is recommended to get acquainted with these three primitives, to understand how the tracker works, however it is better to use the high level interface, whenever it is possible.</p><p>To denote the concrete semantics of these primitives we will use the taint ternary relation <code>T</code> that establishes a relation between a value and an object, e.g., <code>T(v,r,x)</code> is the relation <code>r</code> between the value <code>v</code> and an object <code>x</code>.</p><p>Conceptually, the state of the tracker can be seen as a set of such relations. Since tracker operations may affect this set of relations we will denote relations that existed just before an operation with <code>pre</code>, e.g., <code>pre(T(v,r,x)</code> means that before the operation there was the relation <code>T(v,r,x)</code></p><div class="odoc-spec"><div class="spec value anchored" id="val-attach"><a href="#val-attach" class="anchor"></a><code><span><span class="keyword">val</span> attach : 
  <span><a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Rel/index.html#type-t">Rel.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Object/Set/index.html#type-t">Object.Set.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <a href="argument-1-Machine/index.html#type-t">Machine.t</a></span></span></code></div><div class="spec-doc"><p><code>attach v r xs</code> establishes the relation <code>r</code> between the value <code>v</code> and every object <code>x</code> in the set of objects <code>xs</code>. All other relations, as well as relations with other values are unaffected.</p><p>Post conditions:</p><ul><li>forall x, x in xs -&gt; T(v,r,x);</li><li>forall u,s,x, pre(T(u,s,x)) -&gt; T(u,s,x);</li><li>forall u,s,x, T(v,s,x) -&gt; pre(T(v,s,x)) \// s = r /\\ v = u.</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-lookup"><a href="#val-lookup" class="anchor"></a><code><span><span class="keyword">val</span> lookup : <span><a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Rel/index.html#type-t">Rel.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Object/Set/index.html#type-t">Object.Set.t</a> <a href="argument-1-Machine/index.html#type-t">Machine.t</a></span></span></code></div><div class="spec-doc"><p><code>lookup v r</code> returns a set <code>xs</code> of objects that are related with the value <code>v</code> by the relation <code>r</code>. The operation doesn't change the state of the tracker.</p><p>Post conditions:</p><ul><li>x in xs iff T(v,r,x);</li><li>forall u,s,y, Pre(T(u,s,y)) iff T(u,s,y);</li></ul></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-detach"><a href="#val-detach" class="anchor"></a><code><span><span class="keyword">val</span> detach : 
  <span><a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Rel/index.html#type-t">Rel.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Object/Set/index.html#type-t">Object.Set.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <a href="argument-1-Machine/index.html#type-t">Machine.t</a></span></span></code></div><div class="spec-doc"><p><code>detach v r xs</code> removes all relations of type <code>r</code> between the value <code>v</code> and elements of the set of objects <code>xs</code>. Relations of other types as well as relations between other objects and values are unaffected.</p><p>Post conditions:</p><ul><li>forall x, x in xs -&gt; not (T(v,r,x));</li><li>forall u,s,y, v &lt;&gt; u \// s &lt;&gt; r, pre(T(u,s,y)) -&gt; T(u,s,y)</li></ul></div></div><h4 id="high-level-interface"><a href="#high-level-interface" class="anchor"></a>High-level interface</h4><p>The high-level interface provides a set of easy to use (and sometimes more efficient) functions. All these functions could be expressed in terms of the three primitive operations.</p><div class="odoc-spec"><div class="spec value anchored" id="val-new_direct"><a href="#val-new_direct" class="anchor"></a><code><span><span class="keyword">val</span> new_direct : <span><a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Kind/index.html#type-t">Kind.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Object/index.html#type-t">Object.t</a> <a href="argument-1-Machine/index.html#type-t">Machine.t</a></span></span></code></div><div class="spec-doc"><p><code>new_direct v k</code> introduces a new direct relation between the value <code>v</code> and a freshly created object of the given kind <code>k</code>. The object is returned.</p><p>Essentially: <code>attach v direct (add (lookup v k) (Object.create k as r)); r</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-new_indirect"><a href="#val-new_indirect" class="anchor"></a><code><span><span class="keyword">val</span> new_indirect : 
  <span>addr:<a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span class="arrow">&#45;&gt;</span></span>
  <span>len:<a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Kind/index.html#type-t">Kind.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../Object/index.html#type-t">Object.t</a> <a href="argument-1-Machine/index.html#type-t">Machine.t</a></span></span></code></div><div class="spec-doc"><p><code>new_indirect ~addr:v ~len:n k</code> establishes a new indirect relation between a set of addresses, denoted by interval <code>[v,v+n-1]</code>, and a freshly created object of specified kind.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sanitize"><a href="#val-sanitize" class="anchor"></a><code><span><span class="keyword">val</span> sanitize : <span><a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Rel/index.html#type-t">Rel.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Kind/index.html#type-t">Kind.t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-Machine/index.html#type-t">Machine.t</a></span></span></code></div><div class="spec-doc"><p><code>Taint.sanitize v r k</code> detaches all objects related to the value <code>v</code> by the relation <code>r</code> that has the given kind <code>k</code> from all values tracked by the taint engine.</p><p>In terms of the low-level operations:</p><pre>               for all v' in objects:
                 detach v' r (filter (has_kind k) (lookup v r))</pre><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.2.0 the semantics has changed: the sanitization</li></ul><p>now affects all values not only v.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-objects"><a href="#val-objects" class="anchor"></a><code><span><span class="keyword">val</span> objects : <span><span class="xref-unresolved">Core_kernel</span>.Set.M(<span class="xref-unresolved">Object</span>).t <a href="argument-1-Machine/index.html#type-t">Machine.t</a></span></span></code></div><div class="spec-doc"><p><code>objects</code> the set taint objects that are currently tracked.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.2.0</li></ul></div></div></div></body></html>