<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make (bap-taint.Bap_taint.Std.Taint.Tracker.Make)</title><link rel="stylesheet" href="../../../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../../../index.html">bap-taint</a> &#x00BB; <a href="../../../../index.html">Bap_taint</a> &#x00BB; <a href="../../../index.html">Std</a> &#x00BB; <a href="../../index.html">Taint</a> &#x00BB; <a href="../index.html">Tracker</a> &#x00BB; Make</nav><h1>Module <code>Tracker.Make</code></h1><nav class="toc"><ul><li><a href="#the-low-level-interface">The low-level interface</a></li><li><a href="#high-level-interface">High-level interface</a></li></ul></nav></header><h3 class="heading">Parameters</h3><ul><li><code><a href="argument-1-Machine/index.html">Machine</a> : <a href="../../../../../../bap-primus/Bap_primus/Std/Primus/Machine/index.html#module-type-S">Bap_primus.Std.Primus.Machine.S</a></code></li></ul><h3 class="heading">Signature</h3><section><header><h4 id="the-low-level-interface"><a href="#the-low-level-interface" class="anchor"></a>The low-level interface</h4><p>The low-level interface defines three primitives in terms of which we can express a more convenient high-level interface. It is recommened to get acquainted with these three primitives, to understand how the tracker works, however it is better to use the high level interface, whenever it is possible.</p><p>To denote the concrete semantics of these primitives we will use the taint ternary relation <code>T</code> that establishes a relation between a value and an object, e.g., <code>T(v,r,x)</code> is the relation <code>r</code> between the value <code>v</code> and an object <code>x</code>.</p><p>Conceptually, the state of the tracker can be seen as a set of such relations. Since tracker operations may affect this set of relations we will denote relations that existed just before an operation with <code>pre</code>, e.g., <code>pre(T(v,r,x)</code> means that before the operation there was the relation <code>T(v,r,x)</code></p></header><dl><dt class="spec value" id="val-attach"><a href="#val-attach" class="anchor"></a><code><span class="keyword">val</span> attach : <a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span>&#45;&gt;</span> <a href="../../Rel/index.html#type-t">Rel.t</a> <span>&#45;&gt;</span> <a href="../../Object/Set/index.html#type-t">Object.Set.t</a> <span>&#45;&gt;</span> unit <a href="argument-1-Machine/index.html#type-t">Machine.t</a></code></dt><dd><p><code>attach v r xs</code> establishes the relation <code>r</code> between the value <code>v</code> and every object <code>x</code> in the set of objects <code>xs</code>. All other relations, as well as relations with other values are unaffected.</p><p>Post conditions:</p><ul><li>forall x, x in xs -&gt; T(v,r,x);</li><li>forall u,s,x, pre(T(u,s,x)) -&gt; T(u,s,x);</li><li>forall u,s,x, T(v,s,x) -&gt; pre(T(v,s,x)) \// s = r /\\ v = u.</li></ul></dd></dl><dl><dt class="spec value" id="val-lookup"><a href="#val-lookup" class="anchor"></a><code><span class="keyword">val</span> lookup : <a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span>&#45;&gt;</span> <a href="../../Rel/index.html#type-t">Rel.t</a> <span>&#45;&gt;</span> <a href="../../Object/Set/index.html#type-t">Object.Set.t</a> <a href="argument-1-Machine/index.html#type-t">Machine.t</a></code></dt><dd><p><code>lookup v r</code> returns a set <code>xs</code> of objects that are related with the value <code>v</code> by the relation <code>r</code>. The operation doesn't change the state of the tracker.</p><p>Post conditions:</p><ul><li>x in xs iff T(v,r,x);</li><li>forall u,s,y, Pre(T(u,s,y)) iff T(u,s,y);</li></ul></dd></dl><dl><dt class="spec value" id="val-detach"><a href="#val-detach" class="anchor"></a><code><span class="keyword">val</span> detach : <a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span>&#45;&gt;</span> <a href="../../Rel/index.html#type-t">Rel.t</a> <span>&#45;&gt;</span> <a href="../../Object/Set/index.html#type-t">Object.Set.t</a> <span>&#45;&gt;</span> unit <a href="argument-1-Machine/index.html#type-t">Machine.t</a></code></dt><dd><p><code>detach v r xs</code> removes all relations of type <code>r</code> between the value <code>v</code> and elements of the set of objects <code>xs</code>. Relations of other types as well as relations between other objects and values are unaffected.</p><p>Post conditions:</p><ul><li>forall x, x in xs -&gt; not (T(v,r,x));</li><li>forall u,s,y, v &lt;&gt; u \// s &lt;&gt; r, pre(T(u,s,y)) -&gt; T(u,s,y)</li></ul></dd></dl></section><section><header><h4 id="high-level-interface"><a href="#high-level-interface" class="anchor"></a>High-level interface</h4><p>The high-level interface provides a set of easy to use (and sometimes more efficient) functions. All these functions could be expressed in terms of the three primitive operations.</p></header><dl><dt class="spec value" id="val-new_direct"><a href="#val-new_direct" class="anchor"></a><code><span class="keyword">val</span> new_direct : <a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span>&#45;&gt;</span> <a href="../../Kind/index.html#type-t">Kind.t</a> <span>&#45;&gt;</span> <a href="../../Object/index.html#type-t">Object.t</a> <a href="argument-1-Machine/index.html#type-t">Machine.t</a></code></dt><dd><p><code>new_direct v k</code> introduces a new direct relation between the value <code>v</code> and a freshly created object of the given kind <code>k</code>. The object is returned.</p><p>Essentially: <code>attach v direct (add (lookup v k) (Object.create k as r)); r</code></p></dd></dl><dl><dt class="spec value" id="val-new_indirect"><a href="#val-new_indirect" class="anchor"></a><code><span class="keyword">val</span> new_indirect : addr:<a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span>&#45;&gt;</span> len:<a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span>&#45;&gt;</span> <a href="../../Kind/index.html#type-t">Kind.t</a> <span>&#45;&gt;</span> <a href="../../Object/index.html#type-t">Object.t</a> <a href="argument-1-Machine/index.html#type-t">Machine.t</a></code></dt><dd><p><code>new_indirect ~addr:v ~len:n k</code> establishes a new indirect relation between a set of addresses, denoted by interval <code>[v,v+n-1]</code>, and a freshly created object of specified kind.</p></dd></dl><dl><dt class="spec value" id="val-sanitize"><a href="#val-sanitize" class="anchor"></a><code><span class="keyword">val</span> sanitize : <a href="../../../../../../bap-primus/Bap_primus/Std/Primus/index.html#type-value">Bap_primus.Std.Primus.value</a> <span>&#45;&gt;</span> <a href="../../Rel/index.html#type-t">Rel.t</a> <span>&#45;&gt;</span> <a href="../../Kind/index.html#type-t">Kind.t</a> <span>&#45;&gt;</span> unit <a href="argument-1-Machine/index.html#type-t">Machine.t</a></code></dt><dd><p><code>Taint.sanitize r k v</code> detaches all objects related to the value <code>v</code> by the relation <code>r</code> that has the given kind <code>k</code>.</p><p>In terms of the low-level operations:</p><p><code>detach v r (filter (has_kind k) (lookup v r))</code></p></dd></dl></section></div></body></html>