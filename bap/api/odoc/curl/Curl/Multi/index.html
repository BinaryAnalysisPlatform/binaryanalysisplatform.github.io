<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Multi (curl.Curl.Multi)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">curl</a> &#x00BB; <a href="../index.html">Curl</a> &#x00BB; Multi</nav><h1>Module <code>Curl.Multi</code></h1><p>Curl multi stack. Functions may raise <code>Failure</code> on critical errors</p></header><dl><dt class="spec type" id="type-mt"><a href="#type-mt" class="anchor"></a><code><span class="keyword">type</span> mt</code></dt><dd><p>type of Curl multi stack</p></dd></dl><dl><dt class="spec type" id="type-curlPipelining"><a href="#type-curlPipelining" class="anchor"></a><code><span class="keyword">type</span> curlPipelining</code><code> = </code><table class="variant"><tr id="type-curlPipelining.PIPE_NOTHING" class="anchored"><td class="def constructor"><a href="#type-curlPipelining.PIPE_NOTHING" class="anchor"></a><code>| </code><code><span class="constructor">PIPE_NOTHING</span></code></td></tr><tr id="type-curlPipelining.PIPE_HTTP1" class="anchored"><td class="def constructor"><a href="#type-curlPipelining.PIPE_HTTP1" class="anchor"></a><code>| </code><code><span class="constructor">PIPE_HTTP1</span></code></td></tr><tr id="type-curlPipelining.PIPE_MULTIPLEX" class="anchored"><td class="def constructor"><a href="#type-curlPipelining.PIPE_MULTIPLEX" class="anchor"></a><code>| </code><code><span class="constructor">PIPE_MULTIPLEX</span></code></td></tr></table></dt><dt class="spec type" id="type-curlMultiOption"><a href="#type-curlMultiOption" class="anchor"></a><code><span class="keyword">type</span> curlMultiOption</code><code> = </code><table class="variant"><tr id="type-curlMultiOption.CURLMOPT_PIPELINING" class="anchored"><td class="def constructor"><a href="#type-curlMultiOption.CURLMOPT_PIPELINING" class="anchor"></a><code>| </code><code><span class="constructor">CURLMOPT_PIPELINING</span> <span class="keyword">of</span> <a href="index.html#type-curlPipelining">curlPipelining</a> list</code></td></tr><tr id="type-curlMultiOption.CURLMOPT_MAXCONNECTS" class="anchored"><td class="def constructor"><a href="#type-curlMultiOption.CURLMOPT_MAXCONNECTS" class="anchor"></a><code>| </code><code><span class="constructor">CURLMOPT_MAXCONNECTS</span> <span class="keyword">of</span> int</code></td></tr><tr id="type-curlMultiOption.CURLMOPT_MAX_PIPELINE_LENGTH" class="anchored"><td class="def constructor"><a href="#type-curlMultiOption.CURLMOPT_MAX_PIPELINE_LENGTH" class="anchor"></a><code>| </code><code><span class="constructor">CURLMOPT_MAX_PIPELINE_LENGTH</span> <span class="keyword">of</span> int</code></td></tr><tr id="type-curlMultiOption.CURLMOPT_MAX_HOST_CONNECTIONS" class="anchored"><td class="def constructor"><a href="#type-curlMultiOption.CURLMOPT_MAX_HOST_CONNECTIONS" class="anchor"></a><code>| </code><code><span class="constructor">CURLMOPT_MAX_HOST_CONNECTIONS</span> <span class="keyword">of</span> int</code></td></tr></table></dt></dl><dl><dt class="spec exception" id="exception-Error"><a href="#exception-Error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Error</span> <span class="keyword">of</span> string</code></dt><dd><p>exception raised on internal errors</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : unit <span>&#45;&gt;</span> <a href="index.html#type-mt">mt</a></code></dt><dd><p>create new multi stack</p></dd></dl><dl><dt class="spec value" id="val-add"><a href="#val-add" class="anchor"></a><code><span class="keyword">val</span> add : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>add handle to multi stack</p></dd></dl><dl><dt class="spec value" id="val-remove"><a href="#val-remove" class="anchor"></a><code><span class="keyword">val</span> remove : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> <a href="../index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>remove handle from multi stack (effectively halting the transfer)</p></dd></dl><dl><dt class="spec value" id="val-perform"><a href="#val-perform" class="anchor"></a><code><span class="keyword">val</span> perform : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> int</code></dt><dd><p>perform pending data transfers (if any) on all handles currently in multi stack</p><dl><dt>returns</dt><dd><p>the number of handles that still transfer data</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-wait"><a href="#val-wait" class="anchor"></a><code><span class="keyword">val</span> wait : ?&#8288;timeout_ms:int <span>&#45;&gt;</span> <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>wait till there are some active data transfers on multi stack</p><dl><dt>returns</dt><dd><p>whether <code>perform</code> should be called</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-remove_finished"><a href="#val-remove_finished" class="anchor"></a><code><span class="keyword">val</span> remove_finished : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> (<a href="../index.html#type-t">t</a> * <a href="../index.html#type-curlCode">curlCode</a>) option</code></dt><dd><p>remove finished handle from the multi stack if any. The returned handle may be reused</p></dd></dl><dl><dt class="spec value" id="val-cleanup"><a href="#val-cleanup" class="anchor"></a><code><span class="keyword">val</span> cleanup : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>destroy multi handle (all transfers are stopped, but individual <a href="../index.html#type-t"><code>Curl.t</code></a> handles can be reused)</p></dd></dl><dl><dt class="spec type" id="type-poll"><a href="#type-poll" class="anchor"></a><code><span class="keyword">type</span> poll</code><code> = </code><table class="variant"><tr id="type-poll.POLL_NONE" class="anchored"><td class="def constructor"><a href="#type-poll.POLL_NONE" class="anchor"></a><code>| </code><code><span class="constructor">POLL_NONE</span></code></td><td class="doc"><p>none</p></td></tr><tr id="type-poll.POLL_IN" class="anchored"><td class="def constructor"><a href="#type-poll.POLL_IN" class="anchor"></a><code>| </code><code><span class="constructor">POLL_IN</span></code></td><td class="doc"><p>available for reading</p></td></tr><tr id="type-poll.POLL_OUT" class="anchored"><td class="def constructor"><a href="#type-poll.POLL_OUT" class="anchor"></a><code>| </code><code><span class="constructor">POLL_OUT</span></code></td><td class="doc"><p>available for writing</p></td></tr><tr id="type-poll.POLL_INOUT" class="anchored"><td class="def constructor"><a href="#type-poll.POLL_INOUT" class="anchor"></a><code>| </code><code><span class="constructor">POLL_INOUT</span></code></td><td class="doc"><p>both</p></td></tr><tr id="type-poll.POLL_REMOVE" class="anchored"><td class="def constructor"><a href="#type-poll.POLL_REMOVE" class="anchor"></a><code>| </code><code><span class="constructor">POLL_REMOVE</span></code></td><td class="doc"><p>socket not needed anymore</p></td></tr></table></dt><dd><p>events that should be reported for the socket</p></dd></dl><dl><dt class="spec type" id="type-fd_status"><a href="#type-fd_status" class="anchor"></a><code><span class="keyword">type</span> fd_status</code><code> = </code><table class="variant"><tr id="type-fd_status.EV_AUTO" class="anchored"><td class="def constructor"><a href="#type-fd_status.EV_AUTO" class="anchor"></a><code>| </code><code><span class="constructor">EV_AUTO</span></code></td><td class="doc"><p>determine socket status automatically (with extra system call)</p></td></tr><tr id="type-fd_status.EV_IN" class="anchored"><td class="def constructor"><a href="#type-fd_status.EV_IN" class="anchor"></a><code>| </code><code><span class="constructor">EV_IN</span></code></td><td class="doc"><p>socket has incoming data</p></td></tr><tr id="type-fd_status.EV_OUT" class="anchored"><td class="def constructor"><a href="#type-fd_status.EV_OUT" class="anchor"></a><code>| </code><code><span class="constructor">EV_OUT</span></code></td><td class="doc"><p>socket is available for writing</p></td></tr><tr id="type-fd_status.EV_INOUT" class="anchored"><td class="def constructor"><a href="#type-fd_status.EV_INOUT" class="anchor"></a><code>| </code><code><span class="constructor">EV_INOUT</span></code></td><td class="doc"><p>both</p></td></tr></table></dt><dd><p>socket status</p></dd></dl><dl><dt class="spec value" id="val-set_socket_function"><a href="#val-set_socket_function" class="anchor"></a><code><span class="keyword">val</span> set_socket_function : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> (<a href="../../../ocaml/Unix/index.html#type-file_descr">Unix.file_descr</a> <span>&#45;&gt;</span> <a href="index.html#type-poll">poll</a> <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> unit</code></dt><dd><p>set the function to receive notifications on what socket events are currently interesting for libcurl on the specified socket handle</p></dd></dl><dl><dt class="spec value" id="val-set_timer_function"><a href="#val-set_timer_function" class="anchor"></a><code><span class="keyword">val</span> set_timer_function : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> (int <span>&#45;&gt;</span> unit) <span>&#45;&gt;</span> unit</code></dt><dd><p>set the function to receive notification when libcurl internal timeout changes, timeout value is in milliseconds</p><p>NB <a href="index.html#val-action_timeout"><code>action_timeout</code></a> should be called when timeout occurs</p></dd></dl><dl><dt class="spec value" id="val-action_all"><a href="#val-action_all" class="anchor"></a><code><span class="keyword">val</span> action_all : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> int</code></dt><dd><p>perform pending data transfers (if any) on all handles currently in multi stack (not recommended, <a href="index.html#val-action"><code>action</code></a> should be used instead)</p><dl><dt>returns</dt><dd><p>the number of handles that still transfer data</p></dd></dl><dl><dt>raises Error</dt><dd><p>on errors</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-action_timeout"><a href="#val-action_timeout" class="anchor"></a><code><span class="keyword">val</span> action_timeout : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> unit</code></dt><dd><p>inform libcurl that timeout occured</p><dl><dt>raises Error</dt><dd><p>on errors</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-action"><a href="#val-action" class="anchor"></a><code><span class="keyword">val</span> action : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> <a href="../../../ocaml/Unix/index.html#type-file_descr">Unix.file_descr</a> <span>&#45;&gt;</span> <a href="index.html#type-fd_status">fd_status</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>action mt fd status</code> informs libcurl about event on the specified socket. <code>status</code> specifies socket status. Perform pending data transfers.</p><dl><dt>returns</dt><dd><p>the number of handles still active</p></dd></dl><dl><dt>raises Error</dt><dd><p>on errors</p></dd></dl></dd></dl><dl><dt class="spec external" id="val-timeout"><a href="#val-timeout" class="anchor"></a><code><span class="keyword">val</span> timeout : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>timeout mt</code> polls multi handle for timeout (not recommended, use <a href="index.html#val-set_timer_function"><code>set_timer_function</code></a> instead).</p><dl><dt>returns</dt><dd><p>maximum allowed number of milliseconds to wait before calling libcurl to perform actions</p></dd></dl><dl><dt>raises Error</dt><dd><p>on errors</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-setopt"><a href="#val-setopt" class="anchor"></a><code><span class="keyword">val</span> setopt : <a href="index.html#type-mt">mt</a> <span>&#45;&gt;</span> <a href="index.html#type-curlMultiOption">curlMultiOption</a> <span>&#45;&gt;</span> unit</code></dt><dd><dl><dt>raises NotImplemented</dt><dd><p>for not implemented option</p></dd></dl></dd></dl></div></body></html>