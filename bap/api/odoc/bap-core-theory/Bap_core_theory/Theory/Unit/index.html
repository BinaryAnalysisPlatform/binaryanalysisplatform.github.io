<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Unit (bap-core-theory.Bap_core_theory.Theory.Unit)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../../index.html">bap-core-theory</a> &#x00BB; <a href="../../index.html">Bap_core_theory</a> &#x00BB; <a href="../index.html">Theory</a> &#x00BB; Unit</nav><h1>Module <code>Theory.Unit</code></h1><p>A unit of code.</p><p>A unit of code is a generic piece of code, i.e., a set of instructions that share some common properties, such as the instruction set architecture. The whole set of instructions in the knowledge base is partitioned into units, so that each instruction belongs to at most one code unit, see the <a href="../Label/index.html#val-unit"><code>Label.unit</code></a> property.</p><dl><dt>since</dt><dd>2.2.0</dd></dl></header><dl><dt class="spec type" id="type-cls"><a href="#type-cls" class="anchor"></a><code><span class="keyword">type</span> cls</code></dt><dd><p>the class of all code units</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = <span><a href="index.html#type-cls">cls</a> <a href="../../../../bap-knowledge/Bap_knowledge/Knowledge/Object/index.html#type-t">KB.Object.t</a></span></code></dt><dd><p>the meta type of the unit object</p></dd></dl><dl><dt class="spec value" id="val-cls"><a href="#val-cls" class="anchor"></a><code><span class="keyword">val</span> cls : <span><span>(<a href="index.html#type-cls">cls</a>, unit)</span> <a href="../../../../bap-knowledge/Bap_knowledge/Knowledge/Class/index.html#type-t">KB.Class.t</a></span></code></dt><dd><p>the base class for all units.</p><p>Right now we have only one sort of units, indexed with the <code>unit</code> type. But later we may introduce more unit sorts.</p></dd></dl><dl><dt class="spec value" id="val-for_file"><a href="#val-for_file" class="anchor"></a><code><span class="keyword">val</span> for_file : string <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> <a href="../../../../bap-knowledge/Bap_knowledge/index.html#type-knowledge">Bap_knowledge.knowledge</a></span></code></dt><dd><p><code>for_file name</code> creates a new unit denoting a file with the given <code>name</code>.</p><p>This function creates a symbol that interns <code>name</code> in the <code>file</code> package and sets the <a href="index.html#val-path"><code>path</code></a> property to <code>name</code>.</p></dd></dl><dl><dt class="spec value" id="val-for_region"><a href="#val-for_region" class="anchor"></a><code><span class="keyword">val</span> for_region : <span>lower:<a href="../index.html#type-word">word</a></span> <span>&#45;&gt;</span> <span>upper:<a href="../index.html#type-word">word</a></span> <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> <a href="../../../../bap-knowledge/Bap_knowledge/index.html#type-knowledge">Bap_knowledge.knowledge</a></span></code></dt><dd><p><code>for_region ~lower ~upper</code> creates a new unit denoting an anonymous memory region.</p><p>The <code>lower</code> and <code>upper</code> labels are interned in the current package and the symbol, built from their concatenation, is interned in the <code>region</code> package. That enables distinguishing between anonymous memory regions that belong to different projects/files but having intersecting set of addresses, provided that every project is setting the current package to some unique name.</p></dd></dl><dl><dt class="spec value" id="val-path"><a href="#val-path" class="anchor"></a><code><span class="keyword">val</span> path : <span><span>(<a href="index.html#type-cls">cls</a>, <span>string option</span>)</span> <a href="../../../../bap-knowledge/Bap_knowledge/Knowledge/index.html#type-slot">KB.slot</a></span></code></dt><dd><p><code>path</code> is the path of the file from which the unit originates.</p></dd></dl><dl><dt class="spec value" id="val-bias"><a href="#val-bias" class="anchor"></a><code><span class="keyword">val</span> bias : <span><span>(<a href="index.html#type-cls">cls</a>, <span><a href="../../../../bitvec/Bitvec/index.html#type-t">Bitvec.t</a> option</span>)</span> <a href="../../../../bap-knowledge/Bap_knowledge/Knowledge/index.html#type-slot">KB.slot</a></span></code></dt><dd><p><code>bias</code> is the bias of all addresses in the unit.</p><p>If a unit is biased, then all addresses in this unit have <code>Some bias</code> with respect to the real addresses in the unit representation. To obtain the real address the <code>bias</code> shall be subtracted from the address that is stored in the knowledge base. To get the biased address the <code>bias</code> shall be added to the real address.</p><p>Any knowledge provider that also operates with the real view on the program must take <code>bias</code> into account.</p></dd></dl><dl><dt class="spec value" id="val-target"><a href="#val-target" class="anchor"></a><code><span class="keyword">val</span> target : <span><span>(<a href="index.html#type-cls">cls</a>, <a href="../Target/index.html#type-t">Target.t</a>)</span> <a href="../../../../bap-knowledge/Bap_knowledge/Knowledge/index.html#type-slot">KB.slot</a></span></code></dt><dd><p><code>target</code> the target on which this unit should be executed.</p></dd></dl><dl><dt class="spec value" id="val-source"><a href="#val-source" class="anchor"></a><code><span class="keyword">val</span> source : <span><span>(<a href="index.html#type-cls">cls</a>, <a href="../Source/index.html#type-t">Source.t</a>)</span> <a href="../../../../bap-knowledge/Bap_knowledge/Knowledge/index.html#type-slot">KB.slot</a></span></code></dt><dd><p><code>source</code> the source of this unit.</p></dd></dl><dl><dt class="spec value" id="val-compiler"><a href="#val-compiler" class="anchor"></a><code><span class="keyword">val</span> compiler : <span><span>(<a href="index.html#type-cls">cls</a>, <span><a href="../index.html#type-compiler">compiler</a> option</span>)</span> <a href="../../../../bap-knowledge/Bap_knowledge/Knowledge/index.html#type-slot">KB.slot</a></span></code></dt><dd><p><code>compiler</code> the program that translated the unit from the <code>source</code>.</p></dd></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../../bap-knowledge/Bap_knowledge/Knowledge/Object/index.html#module-type-S">Bap_knowledge.Knowledge.Object.S</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../../../../bap-knowledge/Bap_knowledge/Knowledge/Object/module-type-S/index.html#type-t">t</a> := <a href="index.html#type-t">t</a></code></span></summary><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt></dl><div><div class="spec include"><div class="doc"><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../../sexplib0/Sexplib0/Sexpable/index.html#module-type-S">Ppx_sexp_conv_lib.Sexpable.S</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../../../../sexplib0/Sexplib0/Sexpable/module-type-S/index.html#type-t">t</a> := <a href="index.html#type-t">t</a></code></span></summary><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt></dl><dl><dt class="spec value" id="val-t_of_sexp"><a href="#val-t_of_sexp" class="anchor"></a><code><span class="keyword">val</span> t_of_sexp : <a href="../../../../sexplib0/Sexplib0/Sexp/index.html#type-t">Sexplib0.Sexp.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-sexp_of_t"><a href="#val-sexp_of_t" class="anchor"></a><code><span class="keyword">val</span> sexp_of_t : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../../../sexplib0/Sexplib0/Sexp/index.html#type-t">Sexplib0.Sexp.t</a></code></dt></dl></details></div></div></div></div></div></div><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../../base/Base/Comparable/index.html#module-type-S">Base.Comparable.S</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../../../../base/Base/Comparable/module-type-S/index.html#type-t">t</a> := <a href="index.html#type-t">t</a></code></span></summary><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../../base/Base__/Comparable_intf/index.html#module-type-Polymorphic_compare">Base__.Comparable_intf.Polymorphic_compare</a></code></span></summary><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../../base/Base/Comparisons/index.html#module-type-Infix">Base.Comparisons.Infix</a></code></span></summary><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt></dl><dl><dt class="spec value" id="val-(&gt;=)"><a href="#val-(&gt;=)" class="anchor"></a><code><span class="keyword">val</span> (&gt;=) : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-(&lt;=)"><a href="#val-(&lt;=)" class="anchor"></a><code><span class="keyword">val</span> (&lt;=) : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-(=)"><a href="#val-(=)" class="anchor"></a><code><span class="keyword">val</span> (=) : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-(&gt;)"><a href="#val-(&gt;)" class="anchor"></a><code><span class="keyword">val</span> (&gt;) : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-(&lt;)"><a href="#val-(&lt;)" class="anchor"></a><code><span class="keyword">val</span> (&lt;) : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-(&lt;&gt;)"><a href="#val-(&lt;&gt;)" class="anchor"></a><code><span class="keyword">val</span> (&lt;&gt;) : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt></dl></details></div></div></div><dl><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-compare"><a href="#val-compare" class="anchor"></a><code><span class="keyword">val</span> compare : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>compare t1 t2</code> returns 0 if <code>t1</code> is equal to <code>t2</code>, a negative integer if <code>t1</code> is less than <code>t2</code>, and a positive integer if <code>t1</code> is greater than <code>t2</code>.</p></dd></dl><dl><dt class="spec value" id="val-min"><a href="#val-min" class="anchor"></a><code><span class="keyword">val</span> min : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dt class="spec value" id="val-max"><a href="#val-max" class="anchor"></a><code><span class="keyword">val</span> max : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt></dl></details></div></div></div><dl><dt class="spec value" id="val-ascending"><a href="#val-ascending" class="anchor"></a><code><span class="keyword">val</span> ascending : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>ascending</code> is identical to <code>compare</code>. <code>descending x y = ascending y x</code>. These are intended to be mnemonic when used like <code>List.sort ~compare:ascending</code> and <code>List.sort
      ~cmp:descending</code>, since they cause the list to be sorted in ascending or descending order, respectively.</p></dd></dl><dl><dt class="spec value" id="val-descending"><a href="#val-descending" class="anchor"></a><code><span class="keyword">val</span> descending : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dt class="spec value" id="val-between"><a href="#val-between" class="anchor"></a><code><span class="keyword">val</span> between : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>low:<a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>high:<a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>between t ~low ~high</code> means <code>low &lt;= t &lt;= high</code></p></dd></dl><dl><dt class="spec value" id="val-clamp_exn"><a href="#val-clamp_exn" class="anchor"></a><code><span class="keyword">val</span> clamp_exn : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>min:<a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>max:<a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>clamp_exn t ~min ~max</code> returns <code>t'</code>, the closest value to <code>t</code> such that <code>between t' ~low:min ~high:max</code> is true.</p><p>Raises if <code>not (min &lt;= max)</code>.</p></dd></dl><dl><dt class="spec value" id="val-clamp"><a href="#val-clamp" class="anchor"></a><code><span class="keyword">val</span> clamp : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>min:<a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>max:<a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> <a href="../../../../base/Base/Or_error/index.html#type-t">Base.Or_error.t</a></span></code></dt></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../../base/Base/Comparator/index.html#module-type-S">Base.Comparator.S</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../../../../base/Base/Comparator/module-type-S/index.html#type-t">t</a> := <a href="index.html#type-t">t</a></code></span></summary><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dt class="spec type" id="type-comparator_witness"><a href="#type-comparator_witness" class="anchor"></a><code><span class="keyword">type</span> comparator_witness</code></dt></dl><dl><dt class="spec value" id="val-comparator"><a href="#val-comparator" class="anchor"></a><code><span class="keyword">val</span> comparator : <span><span>(<a href="index.html#type-t">t</a>, <a href="index.html#type-comparator_witness">comparator_witness</a>)</span> <a href="../../../../base/Base/Comparator/index.html#type-comparator">Base.Comparator.comparator</a></span></code></dt></dl></details></div></div></div><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../../base/Base__/Comparable_intf/index.html#module-type-Validate">Base__.Comparable_intf.Validate</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../../../../base/Base__/Comparable_intf/module-type-Validate/index.html#type-t">t</a> := <a href="index.html#type-t">t</a></code></span></summary><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt></dl><dl><dt class="spec value" id="val-validate_lbound"><a href="#val-validate_lbound" class="anchor"></a><code><span class="keyword">val</span> validate_lbound : <span>min:<span><a href="index.html#type-t">t</a> <a href="../../../../base/Base/Maybe_bound/index.html#type-t">Base.Maybe_bound.t</a></span></span> <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> <a href="../../../../base/Base/Validate/index.html#type-check">Base.Validate.check</a></span></code></dt><dt class="spec value" id="val-validate_ubound"><a href="#val-validate_ubound" class="anchor"></a><code><span class="keyword">val</span> validate_ubound : <span>max:<span><a href="index.html#type-t">t</a> <a href="../../../../base/Base/Maybe_bound/index.html#type-t">Base.Maybe_bound.t</a></span></span> <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> <a href="../../../../base/Base/Validate/index.html#type-check">Base.Validate.check</a></span></code></dt><dt class="spec value" id="val-validate_bound"><a href="#val-validate_bound" class="anchor"></a><code><span class="keyword">val</span> validate_bound : <span>min:<span><a href="index.html#type-t">t</a> <a href="../../../../base/Base/Maybe_bound/index.html#type-t">Base.Maybe_bound.t</a></span></span> <span>&#45;&gt;</span> <span>max:<span><a href="index.html#type-t">t</a> <a href="../../../../base/Base/Maybe_bound/index.html#type-t">Base.Maybe_bound.t</a></span></span> <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> <a href="../../../../base/Base/Validate/index.html#type-check">Base.Validate.check</a></span></code></dt></dl></details></div></div></div></details></div></div></div><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../../core_kernel/Core_kernel/Binable/index.html#module-type-S">Core_kernel.Binable.S</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../../../../core_kernel/Core_kernel/Binable/module-type-S/index.html#type-t">t</a> := <a href="index.html#type-t">t</a></code></span></summary><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../../bin_prot/Bin_prot/Binable/index.html#module-type-S_only_functions">Bin_prot.Binable.S_only_functions</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../../../../bin_prot/Bin_prot/Binable/module-type-S_only_functions/index.html#type-t">t</a> := <a href="index.html#type-t">t</a></code></span></summary><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt></dl><dl><dt class="spec value" id="val-bin_size_t"><a href="#val-bin_size_t" class="anchor"></a><code><span class="keyword">val</span> bin_size_t : <span><a href="index.html#type-t">t</a> <a href="../../../../bin_prot/Bin_prot/Size/index.html#type-sizer">Bin_prot.Size.sizer</a></span></code></dt><dt class="spec value" id="val-bin_write_t"><a href="#val-bin_write_t" class="anchor"></a><code><span class="keyword">val</span> bin_write_t : <span><a href="index.html#type-t">t</a> <a href="../../../../bin_prot/Bin_prot/Write/index.html#type-writer">Bin_prot.Write.writer</a></span></code></dt><dt class="spec value" id="val-bin_read_t"><a href="#val-bin_read_t" class="anchor"></a><code><span class="keyword">val</span> bin_read_t : <span><a href="index.html#type-t">t</a> <a href="../../../../bin_prot/Bin_prot/Read/index.html#type-reader">Bin_prot.Read.reader</a></span></code></dt><dt class="spec value" id="val-__bin_read_t__"><a href="#val-__bin_read_t__" class="anchor"></a><code><span class="keyword">val</span> __bin_read_t__ : <span><span>(int <span>&#45;&gt;</span> <a href="index.html#type-t">t</a>)</span> <a href="../../../../bin_prot/Bin_prot/Read/index.html#type-reader">Bin_prot.Read.reader</a></span></code></dt><dd><p>This function only needs implementation if <code>t</code> exposed to be a polymorphic variant. Despite what the type reads, this does *not* produce a function after reading; instead it takes the constructor tag (int) before reading and reads the rest of the variant <code>t</code> afterwards.</p></dd></dl></details></div></div></div><dl><dt class="spec value" id="val-bin_shape_t"><a href="#val-bin_shape_t" class="anchor"></a><code><span class="keyword">val</span> bin_shape_t : <a href="../../../../bin_prot/Bin_prot/Shape/index.html#type-t">Bin_prot.Shape.t</a></code></dt><dt class="spec value" id="val-bin_writer_t"><a href="#val-bin_writer_t" class="anchor"></a><code><span class="keyword">val</span> bin_writer_t : <span><a href="index.html#type-t">t</a> <a href="../../../../bin_prot/Bin_prot/Type_class/index.html#type-writer">Bin_prot.Type_class.writer</a></span></code></dt><dt class="spec value" id="val-bin_reader_t"><a href="#val-bin_reader_t" class="anchor"></a><code><span class="keyword">val</span> bin_reader_t : <span><a href="index.html#type-t">t</a> <a href="../../../../bin_prot/Bin_prot/Type_class/index.html#type-reader">Bin_prot.Type_class.reader</a></span></code></dt><dt class="spec value" id="val-bin_t"><a href="#val-bin_t" class="anchor"></a><code><span class="keyword">val</span> bin_t : <span><a href="index.html#type-t">t</a> <a href="../../../../bin_prot/Bin_prot/Type_class/index.html#type-t">Bin_prot.Type_class.t</a></span></code></dt></dl></details></div></div></div></details></div></div></div></div></body></html>