<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Trace (bap-traces.Bap_traces.Std.Trace)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">bap-traces</a> &#x00BB; <a href="../../index.html">Bap_traces</a> &#x00BB; <a href="../index.html">Std</a> &#x00BB; Trace</nav><header class="odoc-preamble"><h1>Module <code><span>Std.Trace</span></code></h1><p>Trace is a stream of events plus meta data.</p><p>It can be viewed as an input channel. In fact, <code>Trace.t</code> is an abstract data type usually inhabited with codata, i.e., some entity with hidden state. The <code>Trace</code> may be an interface to a remote server, virtual machine or just a file. So treat the trace as something that works as an input channel.</p><p>Since it is worthwhile to know whether a particular event is not the trace because it didn't occur during program execution, but not because it wasn't detected by a trace tool or dropped by a given transport, we provide <code>supports</code> function, to query whether the given event type is really supported (and thus might occur) by a given trace.</p><p>The meta information is also represented using <code>value</code> type, and thus can contain virtually any data. Meta information is indexed with <code>tag</code> value. Unlike the events, that are codata, meta is a regular data, obtained from a trace source at the time of trace creation and is not changed magically in the trace lifetime.</p></header><nav class="odoc-toc"><ul><li><a href="#serialization">Serialization</a></li><li><a href="#creating">Creating</a></li><li><a href="#meta-attributes">Meta attributes</a></li><li><a href="#querying-data">Querying data</a></li><li><a href="#transformations">Transformations</a></li><li><a href="#extension-mechanism">Extension mechanism</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-event" class="anchored"><a href="#type-event" class="anchor"></a><code><span><span class="keyword">type</span> event</span><span> = <a href="../../../../bap/Bap/Std/index.html#type-value">Bap.Std.value</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_shape_event" class="anchored"><a href="#val-bin_shape_event" class="anchor"></a><code><span><span class="keyword">val</span> bin_shape_event : <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Shape.t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_size_event" class="anchored"><a href="#val-bin_size_event" class="anchor"></a><code><span><span class="keyword">val</span> bin_size_event : <span><a href="#type-event">event</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Size.sizer</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_write_event" class="anchored"><a href="#val-bin_write_event" class="anchor"></a><code><span><span class="keyword">val</span> bin_write_event : <span><a href="#type-event">event</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Write.writer</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_writer_event" class="anchored"><a href="#val-bin_writer_event" class="anchor"></a><code><span><span class="keyword">val</span> bin_writer_event : <span><a href="#type-event">event</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Type_class.writer</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_read_event" class="anchored"><a href="#val-bin_read_event" class="anchor"></a><code><span><span class="keyword">val</span> bin_read_event : <span><a href="#type-event">event</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Read.reader</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-__bin_read_event__" class="anchored"><a href="#val-__bin_read_event__" class="anchor"></a><code><span><span class="keyword">val</span> __bin_read_event__ : <span><span>( <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-event">event</a> )</span> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Read.reader</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_reader_event" class="anchored"><a href="#val-bin_reader_event" class="anchor"></a><code><span><span class="keyword">val</span> bin_reader_event : <span><a href="#type-event">event</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Type_class.reader</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_event" class="anchored"><a href="#val-bin_event" class="anchor"></a><code><span><span class="keyword">val</span> bin_event : <span><a href="#type-event">event</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Type_class.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sexp_of_event" class="anchored"><a href="#val-sexp_of_event" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_event : <span><a href="#type-event">event</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_sexp_conv_lib</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-event_of_sexp" class="anchored"><a href="#val-event_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> event_of_sexp : <span><span class="xref-unresolved">Ppx_sexp_conv_lib</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-event">event</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-compare_event" class="anchored"><a href="#val-compare_event" class="anchor"></a><code><span><span class="keyword">val</span> compare_event : <span><a href="#type-event">event</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-event">event</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-monitor" class="anchored"><a href="#type-monitor" class="anchor"></a><code><span><span class="keyword">type</span> monitor</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-proto" class="anchored"><a href="#type-proto" class="anchor"></a><code><span><span class="keyword">type</span> proto</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-tool" class="anchored"><a href="#type-tool" class="anchor"></a><code><span><span class="keyword">type</span> tool</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_shape_tool" class="anchored"><a href="#val-bin_shape_tool" class="anchor"></a><code><span><span class="keyword">val</span> bin_shape_tool : <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Shape.t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_size_tool" class="anchored"><a href="#val-bin_size_tool" class="anchor"></a><code><span><span class="keyword">val</span> bin_size_tool : <span><a href="#type-tool">tool</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Size.sizer</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_write_tool" class="anchored"><a href="#val-bin_write_tool" class="anchor"></a><code><span><span class="keyword">val</span> bin_write_tool : <span><a href="#type-tool">tool</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Write.writer</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_writer_tool" class="anchored"><a href="#val-bin_writer_tool" class="anchor"></a><code><span><span class="keyword">val</span> bin_writer_tool : <span><a href="#type-tool">tool</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Type_class.writer</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_read_tool" class="anchored"><a href="#val-bin_read_tool" class="anchor"></a><code><span><span class="keyword">val</span> bin_read_tool : <span><a href="#type-tool">tool</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Read.reader</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-__bin_read_tool__" class="anchored"><a href="#val-__bin_read_tool__" class="anchor"></a><code><span><span class="keyword">val</span> __bin_read_tool__ : <span><span>( <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-tool">tool</a> )</span> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Read.reader</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_reader_tool" class="anchored"><a href="#val-bin_reader_tool" class="anchor"></a><code><span><span class="keyword">val</span> bin_reader_tool : <span><a href="#type-tool">tool</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Type_class.reader</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_tool" class="anchored"><a href="#val-bin_tool" class="anchor"></a><code><span><span class="keyword">val</span> bin_tool : <span><a href="#type-tool">tool</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Type_class.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-sexp_of_tool" class="anchored"><a href="#val-sexp_of_tool" class="anchor"></a><code><span><span class="keyword">val</span> sexp_of_tool : <span><a href="#type-tool">tool</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Ppx_sexp_conv_lib</span>.Sexp.t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-tool_of_sexp" class="anchored"><a href="#val-tool_of_sexp" class="anchor"></a><code><span><span class="keyword">val</span> tool_of_sexp : <span><span class="xref-unresolved">Ppx_sexp_conv_lib</span>.Sexp.t <span class="arrow">&#45;&gt;</span></span> <a href="#type-tool">tool</a></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-id" class="anchored"><a href="#type-id" class="anchor"></a><code><span><span class="keyword">type</span> id</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = <a href="../index.html#type-trace">trace</a></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-io_error" class="anchored"><a href="#type-io_error" class="anchor"></a><code><span><span class="keyword">type</span> io_error</span><span> = </span><span>[ </span></code><table><tr id="type-io_error.Protocol_error" class="anchored"><td class="def constructor"><a href="#type-io_error.Protocol_error" class="anchor"></a><code><span>| </span></code><code><span>`Protocol_error <span class="keyword">of</span> <span class="xref-unresolved">Core_kernel</span>.Error.t</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Data encoding problem</p><span class="comment-delim">*)</span></td></tr><tr id="type-io_error.System_error" class="anchored"><td class="def constructor"><a href="#type-io_error.System_error" class="anchor"></a><code><span>| </span></code><code><span>`System_error <span class="keyword">of</span> <span class="xref-unresolved">Unix</span>.error</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>System error</p><span class="comment-delim">*)</span></td></tr></table><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-error" class="anchored"><a href="#type-error" class="anchor"></a><code><span><span class="keyword">type</span> error</span><span> = </span><span>[ </span></code><table><tr id="type-error.io_error" class="anchored"><td class="def type"><a href="#type-error.io_error" class="anchor"></a><code><span>| </span></code><code><span><a href="#type-io_error">io_error</a></span></code></td></tr><tr id="type-error.No_provider" class="anchored"><td class="def constructor"><a href="#type-error.No_provider" class="anchor"></a><code><span>| </span></code><code><span>`No_provider</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>No provider for a given URI</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Ambiguous_uri" class="anchored"><td class="def constructor"><a href="#type-error.Ambiguous_uri" class="anchor"></a><code><span>| </span></code><code><span>`Ambiguous_uri</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>More than one provider for a given URI</p><span class="comment-delim">*)</span></td></tr></table><code><span> ]</span></code></div></div><h3 id="serialization"><a href="#serialization" class="anchor"></a>Serialization</h3><p>Serialization is dispatched by an URI describing data source or destination. URI contains enough information to uniquely designate data format and transporting options.</p><div class="odoc-spec"><div class="spec value" id="val-load" class="anchored"><a href="#val-load" class="anchor"></a><code><span><span class="keyword">val</span> load : <span>?monitor:<a href="#type-monitor">monitor</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Uri</span>.t <span class="arrow">&#45;&gt;</span></span> <span><span>( <a href="#type-t">t</a>, <a href="#type-error">error</a> )</span> <span class="xref-unresolved">Core_kernel</span>.Result.t</span></span></code></div><div class="spec-doc"><p><code>load ~monitor uri</code> fetches trace from a provided <code>uri</code>. <code>monitor</code> is fail_on_error by default.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-save" class="anchored"><a href="#val-save" class="anchor"></a><code><span><span class="keyword">val</span> save : <span><span class="xref-unresolved">Uri</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>( unit, <a href="#type-error">error</a> )</span> <span class="xref-unresolved">Core_kernel</span>.Result.t</span></span></code></div><div class="spec-doc"><p><code>save uri</code> pushes trace to a provided <code>uri</code></p></div></div><h3 id="creating"><a href="#creating" class="anchor"></a>Creating</h3><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span>?monitor:<a href="#type-monitor">monitor</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-tool">tool</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-event">event</a> <span class="xref-unresolved">Core_kernel</span>.Or_error.t</span> option</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>create tool next</code> creates a new trace from the observer <code>next</code>.</p></div></div><h3 id="meta-attributes"><a href="#meta-attributes" class="anchor"></a>Meta attributes</h3><p>Meta information relates to the whole trace.</p><div class="odoc-spec"><div class="spec value" id="val-id" class="anchored"><a href="#val-id" class="anchor"></a><code><span><span class="keyword">val</span> id : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-id">id</a></span></code></div><div class="spec-doc"><p>Trace global unique identifier.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_attr" class="anchored"><a href="#val-set_attr" class="anchor"></a><code><span><span class="keyword">val</span> set_attr : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../../../bap/Bap/Std/index.html#type-tag">Bap.Std.tag</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>set_attr trace attr value</code> updates <code>trace</code> meta attribute <code>attr</code> with a provided value.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-get_attr" class="anchored"><a href="#val-get_attr" class="anchor"></a><code><span><span class="keyword">val</span> get_attr : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../../../bap/Bap/Std/index.html#type-tag">Bap.Std.tag</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span></span></code></div><div class="spec-doc"><p><code>get_attr trace attr</code> retrieves a value of a given attribute <code>attr</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-has_attr" class="anchored"><a href="#val-has_attr" class="anchor"></a><code><span><span class="keyword">val</span> has_attr : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../../../bap/Bap/Std/index.html#type-tag">Bap.Std.tag</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>has_attr trace attr</code> evaluates to <code>true</code> if <code>trace</code> has a given attribute <code>attr</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-tool" class="anchored"><a href="#val-tool" class="anchor"></a><code><span><span class="keyword">val</span> tool : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-tool">tool</a></span></code></div><div class="spec-doc"><p><code>tool trace</code> returns a descriptor of a tool that was used to create the <code>trace</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-meta" class="anchored"><a href="#val-meta" class="anchor"></a><code><span><span class="keyword">val</span> meta : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../bap/Bap/Std/index.html#type-dict">Bap.Std.dict</a></span></code></div><div class="spec-doc"><p><code>meta trace</code> returns all <code>trace</code> attributes as a dictionary</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_meta" class="anchored"><a href="#val-set_meta" class="anchor"></a><code><span><span class="keyword">val</span> set_meta : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../bap/Bap/Std/index.html#type-dict">Bap.Std.dict</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>set_meta trace meta</code> substitutes meta attributes of a <code>trace</code> with attributes taken from a dictionary <code>meta</code>.</p></div></div><h3 id="querying-data"><a href="#querying-data" class="anchor"></a>Querying data</h3><div class="odoc-spec"><div class="spec value" id="val-supports" class="anchored"><a href="#val-supports" class="anchor"></a><code><span><span class="keyword">val</span> supports : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../../../bap/Bap/Std/index.html#type-tag">Bap.Std.tag</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>supports trace feature</code> is <code>true</code> if a tool that was used to generate the trace, as well as transporting protocol and underlying format support the given feature.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-read_all" class="anchored"><a href="#val-read_all" class="anchor"></a><code><span><span class="keyword">val</span> read_all : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../../../bap/Bap/Std/index.html#type-tag">Bap.Std.tag</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../../../bap/Bap/Std/index.html#type-seq">Bap.Std.seq</a></span></span></code></div><div class="spec-doc"><p><code>read_all trace tag</code> reads all event of the a given type</p></div></div><div class="odoc-spec"><div class="spec value" id="val-read_all_matching" class="anchored"><a href="#val-read_all_matching" class="anchor"></a><code><span><span class="keyword">val</span> read_all_matching : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../../../bap/Bap/Std/Value/Match/index.html#type-t">Bap.Std.Value.Match.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../../../../bap/Bap/Std/index.html#type-seq">Bap.Std.seq</a></span></span></code></div><div class="spec-doc"><p><code>read_all_matching trace matcher</code> reads all events matching with a provided <code>matcher</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-read_events" class="anchored"><a href="#val-read_events" class="anchor"></a><code><span><span class="keyword">val</span> read_events : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-event">event</a> <a href="../../../../bap/Bap/Std/index.html#type-seq">Bap.Std.seq</a></span></span></code></div><div class="spec-doc"><p><code>read_events trace</code> reads a sequence of events from the <code>trace</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-next" class="anchored"><a href="#val-next" class="anchor"></a><code><span><span class="keyword">val</span> next : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../../../bap/Bap/Std/index.html#type-tag">Bap.Std.tag</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span></span></code></div><div class="spec-doc"><p><code>next trace tag</code> reads and discards events until an event with a given tag is found.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-next_event" class="anchored"><a href="#val-next_event" class="anchor"></a><code><span><span class="keyword">val</span> next_event : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-event">event</a> option</span></span></code></div><div class="spec-doc"><p><code>next_event trace</code> reads next event from the trace</p></div></div><div class="odoc-spec"><div class="spec value" id="val-next_matching" class="anchored"><a href="#val-next_matching" class="anchor"></a><code><span><span class="keyword">val</span> next_matching : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../../../../bap/Bap/Std/Value/Match/index.html#type-t">Bap.Std.Value.Match.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span></span></code></div><div class="spec-doc"><p><code>next_matching trace matcher</code> reads and discards trace events until an event matching with the <code>matcher</code> is found.</p></div></div><h3 id="transformations"><a href="#transformations" class="anchor"></a>Transformations</h3><div class="odoc-spec"><div class="spec value" id="val-filter_map" class="anchored"><a href="#val-filter_map" class="anchor"></a><code><span><span class="keyword">val</span> filter_map : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>( <span><a href="#type-event">event</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-event">event</a> option</span> )</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>filter_map t ~f</code> will return a trace where all events a filter-mapped with the provided function <code>f</code></p></div></div><h3 id="extension-mechanism"><a href="#extension-mechanism" class="anchor"></a>Extension mechanism</h3><p>A trace is a collaborative work of several underlying layers:</p><ul><li>a trace tool itself</li><li>a transport, that delivers data from the <code>tool</code></li><li>a protocol that is used to deliver and interpret data.</li></ul><p>For example, a tools is an instrumented qemu-user, a transport can be just a file, and protocol can be Google protobuf.</p><p>Ideally, this three instances should be totally orthogonal, so that one can match them. In real life, we will strive to support only specific combinations.</p><p>The extension mechanism allows a user to add support for new transports and protocols. The separation between transport and protocol is left beyond the scope of this interface. A user is welcome to built its own protocol stacks and reify them into explicit API.</p><p>The interface is designed to support both static and dynamic trace tools. Although, the interface to control a dynamic tool is also left outside of the trace interface.</p><p>In order to establish a correspondence between a concrete trace instance and a trace generator a unique id is used. Each time a trace is opened a fresh new unique id is generated that is passed to both sides: to the trace (accessible via <code>id</code> function) and to the trace reader (passed as a parameter). This <code>id</code> can be used from the client side to dynamically control a trace tool.</p><div class="odoc-spec"><div class="spec module-type" id="module-type-S" class="anchored"><a href="#module-type-S" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-S/index.html">S</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-P" class="anchored"><a href="#module-type-P" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-P/index.html">P</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-register_tool" class="anchored"><a href="#val-register_tool" class="anchor"></a><code><span><span class="keyword">val</span> register_tool : <span><span>(<span class="keyword">module</span> <a href="module-type-S/index.html">S</a>)</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-tool">tool</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-register_proto" class="anchored"><a href="#val-register_proto" class="anchor"></a><code><span><span class="keyword">val</span> register_proto : <span><span>(<span class="keyword">module</span> <a href="module-type-P/index.html">P</a>)</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-proto">proto</a></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Reader" class="anchored"><a href="#module-Reader" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Reader/index.html">Reader</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Reader interface.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-reader" class="anchored"><a href="#type-reader" class="anchor"></a><code><span><span class="keyword">type</span> reader</span><span> = <a href="Reader/index.html#type-t">Reader.t</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-register_reader" class="anchored"><a href="#val-register_reader" class="anchor"></a><code><span><span class="keyword">val</span> register_reader : 
  <span><a href="#type-proto">proto</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span class="xref-unresolved">Uri</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-id">id</a> <span class="arrow">&#45;&gt;</span></span> <span><span>( <a href="#type-reader">reader</a>, <a href="#type-io_error">io_error</a> )</span> <span class="xref-unresolved">Core_kernel</span>.Result.t</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-register_writer" class="anchored"><a href="#val-register_writer" class="anchor"></a><code><span><span class="keyword">val</span> register_writer : 
  <span><a href="#type-proto">proto</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><span class="xref-unresolved">Uri</span>.t <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span>( unit, <a href="#type-io_error">io_error</a> )</span> <span class="xref-unresolved">Core_kernel</span>.Result.t</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Id" class="anchored"><a href="#module-Id" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Id/index.html">Id</a></span><span> : <a href="../../../../regular/Regular/Std/Regular/module-type-S/index.html">Regular.Std.Regular.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../../../regular/Regular/Std/Regular/module-type-S/index.html#type-t">t</a> = <a href="#type-id">id</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-step" class="anchored"><a href="#type-step" class="anchor"></a><code><span><span class="keyword">type</span> step</span><span> = </span><span>[ </span></code><table><tr id="type-step.Stop" class="anchored"><td class="def constructor"><a href="#type-step.Stop" class="anchor"></a><code><span>| </span></code><code><span>`Stop</span></code></td></tr><tr id="type-step.Skip" class="anchored"><td class="def constructor"><a href="#type-step.Skip" class="anchor"></a><code><span>| </span></code><code><span>`Skip</span></code></td></tr><tr id="type-step.Fail" class="anchored"><td class="def constructor"><a href="#type-step.Fail" class="anchor"></a><code><span>| </span></code><code><span>`Fail</span></code></td></tr><tr id="type-step.Make" class="anchored"><td class="def constructor"><a href="#type-step.Make" class="anchor"></a><code><span>| </span></code><code><span>`Make <span class="keyword">of</span> <a href="#type-event">event</a></span></code></td></tr></table><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Monitor" class="anchored"><a href="#module-Monitor" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Monitor/index.html">Monitor</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Monitor defines an error handling policy.</p></div></div></div></body></html>