<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Migrate_parsetree_driver (ocaml-migrate-parsetree.Migrate_parsetree_driver)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">ocaml-migrate-parsetree</a> &#x00BB; Migrate_parsetree_driver</nav><h1>Module <code>Migrate_parsetree_driver</code></h1><h2 id="state-a-rewriter-can-access"><a href="#state-a-rewriter-can-access" class="anchor"></a>State a rewriter can access</h2><nav class="toc"><ul><li><a href="#registering-rewriters">Registering rewriters</a></li><li><a href="#running-registered-rewriters">Running registered rewriters</a></li><li><a href="#manual-mapping">Manual mapping</a></li></ul></nav></header><dl><dt class="spec type" id="type-extra"><a href="#type-extra" class="anchor"></a><code><span class="keyword">type</span> extra</code><code> = </code><code>..</code></dt><dt class="spec type" id="type-config"><a href="#type-config" class="anchor"></a><code><span class="keyword">type</span> config</code><code> = </code><code>{</code><table class="record"><tr id="type-config.tool_name" class="anchored"><td class="def field"><a href="#type-config.tool_name" class="anchor"></a><code>tool_name : string;</code></td></tr><tr id="type-config.include_dirs" class="anchored"><td class="def field"><a href="#type-config.include_dirs" class="anchor"></a><code>include_dirs : <span>string list</span>;</code></td></tr><tr id="type-config.load_path" class="anchored"><td class="def field"><a href="#type-config.load_path" class="anchor"></a><code>load_path : <span>string list</span>;</code></td></tr><tr id="type-config.debug" class="anchored"><td class="def field"><a href="#type-config.debug" class="anchor"></a><code>debug : bool;</code></td></tr><tr id="type-config.for_package" class="anchored"><td class="def field"><a href="#type-config.for_package" class="anchor"></a><code>for_package : <span>string option</span>;</code></td><td class="doc"><p>Additional parameters that can be passed by a caller of <code>rewrite_{signature,structure}</code> to a specific register rewriter.</p></td></tr><tr id="type-config.extras" class="anchored"><td class="def field"><a href="#type-config.extras" class="anchor"></a><code>extras : <span><a href="index.html#type-extra">extra</a> list</span>;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-make_config"><a href="#val-make_config" class="anchor"></a><code><span class="keyword">val</span> make_config : <span>tool_name:string</span> <span>&#45;&gt;</span> <span>?&#8288;include_dirs:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;load_path:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;debug:bool</span> <span>&#45;&gt;</span> <span>?&#8288;for_package:string</span> <span>&#45;&gt;</span> <span>?&#8288;extras:<span><a href="index.html#type-extra">extra</a> list</span></span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <a href="index.html#type-config">config</a></code></dt></dl><dl><dt class="spec type" id="type-cookies"><a href="#type-cookies" class="anchor"></a><code><span class="keyword">type</span> cookies</code></dt></dl><dl><dt class="spec value" id="val-get_cookie"><a href="#val-get_cookie" class="anchor"></a><code><span class="keyword">val</span> get_cookie : <a href="index.html#type-cookies">cookies</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-get_expression">Migrate_parsetree_versions.get_expression</a></span> option</span></code></dt><dt class="spec value" id="val-set_cookie"><a href="#val-set_cookie" class="anchor"></a><code><span class="keyword">val</span> set_cookie : <a href="index.html#type-cookies">cookies</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-get_expression">Migrate_parsetree_versions.get_expression</a></span> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-set_global_cookie"><a href="#val-set_global_cookie" class="anchor"></a><code><span class="keyword">val</span> set_global_cookie : string <span>&#45;&gt;</span> <span><span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-get_expression">Migrate_parsetree_versions.get_expression</a></span> <span>&#45;&gt;</span> unit</code></dt></dl><section><header><h2 id="registering-rewriters"><a href="#registering-rewriters" class="anchor"></a>Registering rewriters</h2></header><dl><dt class="spec type" id="type-rewriter"><a href="#type-rewriter" class="anchor"></a><code><span class="keyword">type</span> <span>'types rewriter</span></code><code> = <a href="index.html#type-config">config</a> <span>&#45;&gt;</span> <a href="index.html#type-cookies">cookies</a> <span>&#45;&gt;</span> <span><span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-get_mapper">Migrate_parsetree_versions.get_mapper</a></span></code></dt></dl><dl><dt class="spec value" id="val-register"><a href="#val-register" class="anchor"></a><code><span class="keyword">val</span> register : <span>name:string</span> <span>&#45;&gt;</span> <span>?&#8288;reset_args:<span>(unit <span>&#45;&gt;</span> unit)</span></span> <span>&#45;&gt;</span> <span>?&#8288;args:<span><span>(<a href="../../ocaml/Stdlib/Arg/index.html#type-key">Stdlib.Arg.key</a> * <a href="../../ocaml/Stdlib/Arg/index.html#type-spec">Stdlib.Arg.spec</a> * <a href="../../ocaml/Stdlib/Arg/index.html#type-doc">Stdlib.Arg.doc</a>)</span> list</span></span> <span>&#45;&gt;</span> <span>?&#8288;position:int</span> <span>&#45;&gt;</span> <span><span class="type-var">'types</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'types</span> <a href="index.html#type-rewriter">rewriter</a></span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Register a ppx rewriter. <code>position</code> is a integer that indicates when the ppx rewriter should be applied. It is guaranteed that if two ppx rewriters <code>a</code> and <code>b</code> have different position numbers, then the one with the lowest number will be applied first. The rewriting order of ppx rewriters with the same position number is not specified. The default position is <code>0</code>.</p><p>Note that more different position numbers means more AST conversions and slower rewriting, so think twice before setting <code>position</code> to a non-zero number.</p></dd></dl><dl><dt class="spec value" id="val-registered_args"><a href="#val-registered_args" class="anchor"></a><code><span class="keyword">val</span> registered_args : unit <span>&#45;&gt;</span> <span><span>(<a href="../../ocaml/Stdlib/Arg/index.html#type-key">Stdlib.Arg.key</a> * <a href="../../ocaml/Stdlib/Arg/index.html#type-spec">Stdlib.Arg.spec</a> * <a href="../../ocaml/Stdlib/Arg/index.html#type-doc">Stdlib.Arg.doc</a>)</span> list</span></code></dt><dd><p>Return the list of command line arguments registered by rewriters</p></dd></dl><dl><dt class="spec value" id="val-reset_args"><a href="#val-reset_args" class="anchor"></a><code><span class="keyword">val</span> reset_args : unit <span>&#45;&gt;</span> unit</code></dt><dd><p>Call all the registered <code>reset_args</code> callbacks</p></dd></dl></section><section><header><h2 id="running-registered-rewriters"><a href="#running-registered-rewriters" class="anchor"></a>Running registered rewriters</h2></header><dl><dt class="spec value" id="val-run_as_ast_mapper"><a href="#val-run_as_ast_mapper" class="anchor"></a><code><span class="keyword">val</span> run_as_ast_mapper : <span>string list</span> <span>&#45;&gt;</span> <a href="../../ocaml/Ast_mapper/index.html#type-mapper">Ast_mapper.mapper</a></code></dt><dt class="spec value" id="val-run_as_ppx_rewriter"><a href="#val-run_as_ppx_rewriter" class="anchor"></a><code><span class="keyword">val</span> run_as_ppx_rewriter : unit <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dt class="spec value" id="val-run_main"><a href="#val-run_main" class="anchor"></a><code><span class="keyword">val</span> run_main : unit <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt></dl></section><section><header><h2 id="manual-mapping"><a href="#manual-mapping" class="anchor"></a>Manual mapping</h2></header><dl><dt class="spec type" id="type-some_signature"><a href="#type-some_signature" class="anchor"></a><code><span class="keyword">type</span> some_signature</code><code> = </code><table class="variant"><tr id="type-some_signature.Sig" class="anchored"><td class="def constructor"><a href="#type-some_signature.Sig" class="anchor"></a><code>| </code><code><span class="constructor">Sig</span> : <span>(<span class="keyword">module</span> <a href="../Migrate_parsetree_versions/module-type-OCaml_version/index.html">Migrate_parsetree_versions.OCaml_version</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../Migrate_parsetree_versions/module-type-OCaml_version/Ast/Parsetree/index.html#type-signature">Ast.Parsetree.signature</a> = <span class="type-var">'concrete</span>)</span> * <span class="type-var">'concrete</span> <span>&#45;&gt;</span> <a href="index.html#type-some_signature">some_signature</a></code></td></tr></table></dt><dt class="spec type" id="type-some_structure"><a href="#type-some_structure" class="anchor"></a><code><span class="keyword">type</span> some_structure</code><code> = </code><table class="variant"><tr id="type-some_structure.Str" class="anchored"><td class="def constructor"><a href="#type-some_structure.Str" class="anchor"></a><code>| </code><code><span class="constructor">Str</span> : <span>(<span class="keyword">module</span> <a href="../Migrate_parsetree_versions/module-type-OCaml_version/index.html">Migrate_parsetree_versions.OCaml_version</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../Migrate_parsetree_versions/module-type-OCaml_version/Ast/Parsetree/index.html#type-structure">Ast.Parsetree.structure</a> = <span class="type-var">'concrete</span>)</span> * <span class="type-var">'concrete</span> <span>&#45;&gt;</span> <a href="index.html#type-some_structure">some_structure</a></code></td></tr></table></dt></dl><dl><dt class="spec value" id="val-migrate_some_signature"><a href="#val-migrate_some_signature" class="anchor"></a><code><span class="keyword">val</span> migrate_some_signature : <span><span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a></span> <span>&#45;&gt;</span> <a href="index.html#type-some_signature">some_signature</a> <span>&#45;&gt;</span> <span><span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-get_signature">Migrate_parsetree_versions.get_signature</a></span></code></dt><dt class="spec value" id="val-migrate_some_structure"><a href="#val-migrate_some_structure" class="anchor"></a><code><span class="keyword">val</span> migrate_some_structure : <span><span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a></span> <span>&#45;&gt;</span> <a href="index.html#type-some_structure">some_structure</a> <span>&#45;&gt;</span> <span><span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-get_structure">Migrate_parsetree_versions.get_structure</a></span></code></dt><dt class="spec value" id="val-rewrite_signature"><a href="#val-rewrite_signature" class="anchor"></a><code><span class="keyword">val</span> rewrite_signature : <a href="index.html#type-config">config</a> <span>&#45;&gt;</span> <span><span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-get_signature">Migrate_parsetree_versions.get_signature</a></span> <span>&#45;&gt;</span> <a href="index.html#type-some_signature">some_signature</a></code></dt><dt class="spec value" id="val-rewrite_structure"><a href="#val-rewrite_structure" class="anchor"></a><code><span class="keyword">val</span> rewrite_structure : <a href="index.html#type-config">config</a> <span>&#45;&gt;</span> <span><span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-ocaml_version">Migrate_parsetree_versions.ocaml_version</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'version</span> <a href="../Migrate_parsetree_versions/index.html#type-get_structure">Migrate_parsetree_versions.get_structure</a></span> <span>&#45;&gt;</span> <a href="index.html#type-some_structure">some_structure</a></code></dt></dl></section></div></body></html>