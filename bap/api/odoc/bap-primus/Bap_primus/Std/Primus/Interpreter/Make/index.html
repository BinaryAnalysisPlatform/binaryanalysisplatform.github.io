<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make (bap-primus.Bap_primus.Std.Primus.Interpreter.Make)</title><link rel="stylesheet" href="../../../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../../index.html">bap-primus</a> &#x00BB; <a href="../../../../index.html">Bap_primus</a> &#x00BB; <a href="../../../index.html">Std</a> &#x00BB; <a href="../../index.html">Primus</a> &#x00BB; <a href="../index.html">Interpreter</a> &#x00BB; Make</nav><header class="odoc-preamble"><h1>Module <code><span>Interpreter.Make</span></code></h1><p>Make(Machine) makes an interpreter that computes in the given <code>Machine</code>.</p></header><nav class="odoc-toc"><ul><li><a href="#parameters">Parameters</a></li><li><a href="#signature_3">Signature</a></li></ul></nav><div class="odoc-content"><h2 id="parameters"><a href="#parameters" class="anchor"></a>Parameters</h2><div class="odoc-spec"><div class="spec parameter" id="argument-1-Machine" class="anchored"><a href="#argument-1-Machine" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="argument-1-Machine/index.html">Machine</a></span><span> : <a href="../../Machine/module-type-S/index.html">Machine.S</a></span></code></div></div><h2 id="signature_3"><a href="#signature_3" class="anchor"></a>Signature</h2><div class="odoc-spec"><div class="spec type" id="type-m" class="anchored"><a href="#type-m" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a m</span></span><span> = <span><span class="type-var">'a</span> <a href="argument-1-Machine/index.html#type-t">Machine.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-time" class="anchored"><a href="#val-time" class="anchor"></a><code><span><span class="keyword">val</span> time : <span><a href="../../Time/index.html#type-t">Time.t</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>time</code> returns the value of the machine clock.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.1.0</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-halt" class="anchored"><a href="#val-halt" class="anchor"></a><code><span><span class="keyword">val</span> halt : <span><span class="xref-unresolved">Core_kernel</span>.never_returns <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>halt</code> halts the machine by raise the <code>Halt</code> exception.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-interrupt" class="anchored"><a href="#val-interrupt" class="anchor"></a><code><span><span class="keyword">val</span> interrupt : <span>int <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>interrupt n</code> interrupts the computation with cpuexn <code>n</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-pc" class="anchored"><a href="#val-pc" class="anchor"></a><code><span><span class="keyword">val</span> pc : <span><a href="../../../../../../bap/Bap/Std/index.html#type-addr">Bap.Std.addr</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>pc</code> current value of a program counter.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pos" class="anchored"><a href="#val-pos" class="anchor"></a><code><span><span class="keyword">val</span> pos : <span><a href="../../index.html#type-pos">pos</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>pos m</code> current program position.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-sub" class="anchored"><a href="#val-sub" class="anchor"></a><code><span><span class="keyword">val</span> sub : <span><span><a href="../../../../../../bap/Bap/Std/index.html#type-sub">Bap.Std.sub</a> <a href="../../../../../../bap/Bap/Std/index.html#type-term">Bap.Std.term</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>sub x</code> computes the subroutine <code>x</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-blk" class="anchored"><a href="#val-blk" class="anchor"></a><code><span><span class="keyword">val</span> blk : <span><span><a href="../../../../../../bap/Bap/Std/index.html#type-blk">Bap.Std.blk</a> <a href="../../../../../../bap/Bap/Std/index.html#type-term">Bap.Std.term</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>blk x</code> interprets the block <code>x</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-exp" class="anchored"><a href="#val-exp" class="anchor"></a><code><span><span class="keyword">val</span> exp : <span><a href="../../../../../../bap/Bap/Std/index.html#type-exp">Bap.Std.exp</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>exp x</code> returns a value of <code>x</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-get" class="anchored"><a href="#val-get" class="anchor"></a><code><span><span class="keyword">val</span> get : <span><a href="../../../../../../bap/Bap/Std/index.html#type-var">Bap.Std.var</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>get var</code> reads <code>var</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-set" class="anchored"><a href="#val-set" class="anchor"></a><code><span><span class="keyword">val</span> set : <span><a href="../../../../../../bap/Bap/Std/index.html#type-var">Bap.Std.var</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>set var x</code> sets <code>var</code> to <code>x</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-binop" class="anchored"><a href="#val-binop" class="anchor"></a><code><span><span class="keyword">val</span> binop : <span><a href="../../../../../../bap/Bap/Std/index.html#type-binop">Bap.Std.binop</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>binop op x y</code> computes a binary operation <code>op</code> on <code>x</code> and <code>y</code>.</p><p>If <code>binop op x y</code> will involve the division by zero, then the division by zero trap is signaled. If the <code>division_by_zero_handler</code> is provided, (i.e., is linked) then it will be invoked. If it returns normally, then the result of the <code>binop op x y</code> is undefined. Otherwise, the <code>Division_by_zero</code> machine exception is raised.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-unop" class="anchored"><a href="#val-unop" class="anchor"></a><code><span><span class="keyword">val</span> unop : <span><a href="../../../../../../bap/Bap/Std/index.html#type-unop">Bap.Std.unop</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>unop op x</code> computes an unary operation <code>op</code> on <code>x</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-cast" class="anchored"><a href="#val-cast" class="anchor"></a><code><span><span class="keyword">val</span> cast : <span><a href="../../../../../../bap/Bap/Std/index.html#type-cast">Bap.Std.cast</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>cast t n x</code> casts <code>n</code> bits of <code>x</code> using a casting type <code>t</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-concat" class="anchored"><a href="#val-concat" class="anchor"></a><code><span><span class="keyword">val</span> concat : <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>concat x y</code> computes a concatenation of <code>x</code> and <code>y</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-extract" class="anchored"><a href="#val-extract" class="anchor"></a><code><span><span class="keyword">val</span> extract : <span>hi:int <span class="arrow">&#45;&gt;</span></span> <span>lo:int <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>extract ~hi ~lo x</code> extracts bits from <code>lo</code> to <code>hi</code> from <code>x</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-const" class="anchored"><a href="#val-const" class="anchor"></a><code><span><span class="keyword">val</span> const : <span><a href="../../../../../../bap/Bap/Std/index.html#type-word">Bap.Std.word</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>const x</code> computes the constant expression <code>x</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-ite" class="anchored"><a href="#val-ite" class="anchor"></a><code><span><span class="keyword">val</span> ite : <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>ite c x y</code> if <code>c</code> evals to <code>b1</code> then <code>x</code> else <code>y</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-load" class="anchored"><a href="#val-load" class="anchor"></a><code><span><span class="keyword">val</span> load : <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../../../bap/Bap/Std/index.html#type-endian">Bap.Std.endian</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../../../bap/Bap/Std/index.html#type-size">Bap.Std.size</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>load a d s</code> computes a load operation, that loads a word of size <code>s</code> using an order specified by the endianness <code>d</code> from address <code>a</code>.</p><p>If the address <code>a</code> is not mapped, then a pagefault trap is signaled. If the <code>pagefault_hanlder</code> is provided, then it is invoked and the load operation repeats. Note, the handler either shall not return or ensure that the second attempt would be successful. If no handler is linked, then the segmentation fault machine exception is raised.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-store" class="anchored"><a href="#val-store" class="anchor"></a><code><span><span class="keyword">val</span> store : <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../../../bap/Bap/Std/index.html#type-endian">Bap.Std.endian</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../../../bap/Bap/Std/index.html#type-size">Bap.Std.size</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>store a x d s</code> computes a store operation, that stores at the address <code>a</code> the word <code>x</code> of size <code>s</code>, using an ordering specified by the endianness <code>d</code>.</p><p>If <code>a</code> is not mapped or not writable then the pagefault trap is invoked. If the handler is provided, then it is invoked and the operation is repeated. Otherwise the <code>Segmentation_fault</code> machine exception is raised.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-branch" class="anchored"><a href="#val-branch" class="anchor"></a><code><span><span class="keyword">val</span> branch : <span><a href="../../index.html#type-value">value</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>branch cnd yes no</code> if <code>cnd</code> evaluates to <code>zero</code> then <code>yes</code> else <code>no</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-repeat" class="anchored"><a href="#val-repeat" class="anchor"></a><code><span><span class="keyword">val</span> repeat : <span><span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-m">m</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../index.html#type-value">value</a> <a href="#type-m">m</a></span></span></code></div><div class="spec-doc"><p><code>repeat cnd body</code> evaluates <code>body</code> until <code>cnd</code> evaluates to <code>zero</code>. Returns the value of <code>cnd</code>.</p></div></div></div></body></html>