<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Machine (bap-primus.Bap_primus.Std.Primus.Machine)</title><link rel="stylesheet" href="../../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../index.html">bap-primus</a> &#x00BB; <a href="../../../index.html">Bap_primus</a> &#x00BB; <a href="../../index.html">Std</a> &#x00BB; <a href="../index.html">Primus</a> &#x00BB; Machine</nav><header class="odoc-preamble"><h1>Module <code><span>Primus.Machine</span></code></h1><p>Primus Machine.</p><p>The Machine is the core of Primus Framework. The Machine behavior is extended/changed with Machine components.</p><p>The user analysis is usually written in a form of a component, and is registered with the <a href="../Components/index.html#val-register"><code>Primus.Components.register</code></a> function.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-id" class="anchored"><a href="#type-id" class="anchor"></a><code><span><span class="keyword">type</span> id</span><span> = <a href="../../../../../monads/Monads/Std/Monad/State/Multi/index.html#type-id">Monads.Std.Monad.State.Multi.id</a></span></code></div><div class="spec-doc"><p>Machine identifier type.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-init" class="anchored"><a href="#val-init" class="anchor"></a><code><span><span class="keyword">val</span> init : <span>unit <a href="../index.html#type-observation">observation</a></span></span></code></div><div class="spec-doc"><p>A synonym to <code>System.init</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-finished" class="anchored"><a href="#val-finished" class="anchor"></a><code><span><span class="keyword">val</span> finished : <span>unit <a href="../index.html#type-observation">observation</a></span></span></code></div><div class="spec-doc"><p>A synonym to <code>System.fini</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-fork" class="anchored"><a href="#val-fork" class="anchor"></a><code><span><span class="keyword">val</span> fork : <span><span>(<a href="#type-id">id</a> * <a href="#type-id">id</a>)</span> <a href="../index.html#type-observation">observation</a></span></span></code></div><div class="spec-doc"><p><code>fork (parent,child)</code> occurs when the machine <code>parent</code> forks a new clone <code>child</code>. The computation continues in the <code>child</code> machine.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.2.0</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-switch" class="anchored"><a href="#val-switch" class="anchor"></a><code><span><span class="keyword">val</span> switch : <span><span>(<a href="#type-id">id</a> * <a href="#type-id">id</a>)</span> <a href="../index.html#type-observation">observation</a></span></span></code></div><div class="spec-doc"><p><code>switch (was,now)</code> occurs when computation switches from the machine <code>was</code> to the machine <code>now</code>.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.2.0</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-exn_raised" class="anchored"><a href="#val-exn_raised" class="anchor"></a><code><span><span class="keyword">val</span> exn_raised : <span><a href="../index.html#type-exn">exn</a> <a href="../index.html#type-observation">observation</a></span></span></code></div><div class="spec-doc"><p><code>exn_raised exn</code> occurs every time an abnormal control flow is initiated</p></div></div><div class="odoc-spec"><div class="spec value" id="val-kill" class="anchored"><a href="#val-kill" class="anchor"></a><code><span><span class="keyword">val</span> kill : <span><a href="#type-id">id</a> <a href="../index.html#type-observation">observation</a></span></span></code></div><div class="spec-doc"><p><code>kill id</code> occurs when the machine <code>id</code> is killed.</p><p>When this observation is made the machine enters the restricted mode with non-determinism and observations disabled.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-State" class="anchored"><a href="#module-State" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="State/index.html">State</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Machine State.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-state" class="anchored"><a href="#type-state" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a state</span></span><span> = <span><span class="type-var">'a</span> <a href="State/index.html#type-t">State.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-State" class="anchored"><a href="#module-type-State" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> </span><span><a href="module-type-State/index.html">State</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>An interface to the state.</p></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-S" class="anchored"><a href="#module-type-S" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> </span><span><a href="module-type-S/index.html">S</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The Machine interface.</p></div></div><div class="odoc-spec"><div class="spec module-type" id="module-type-Component" class="anchored"><a href="#module-type-Component" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> </span><span><a href="module-type-Component/index.html">Component</a></span><span> = <span class="keyword">functor</span><span> (<a href="module-type-Component/argument-1-Machine/index.html">Machine</a> : <a href="module-type-S/index.html">S</a>) <span class="arrow">&#45;&gt;</span></span> <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A generic machine component.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-component" class="anchored"><a href="#type-component" class="anchor"></a><code><span><span class="keyword">type</span> component</span><span> = <span>(<span class="keyword">module</span> <a href="module-type-Component/index.html">Component</a>)</span></span></code></div><div class="spec-doc"><p>The Machine component.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Make" class="anchored"><a href="#module-Make" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Make/index.html">Make</a></span><span> (<a href="Make/argument-1-M/index.html">M</a> : <a href="../../../../../monads/Monads/Std/Monad/module-type-S/index.html">Monads.Std.Monad.S</a>) : <a href="module-type-S/index.html">S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <span>'a <a href="module-type-S/index.html#type-m">m</a></span> := <span><span class="type-var">'a</span> <a href="Make/argument-1-M/index.html#type-t">M.t</a></span></span></span></code></div><div class="spec-doc"><p><code>Make(Monad)</code> a monad transformer that wraps the Machine into an arbitrary <code>Monad</code>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Main" class="anchored"><a href="#module-Main" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Main/index.html">Main</a></span><span> (<a href="Main/argument-1-M/index.html">M</a> : <a href="module-type-S/index.html">S</a>) : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The Legacy Main System.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-add_component" class="anchored"><a href="#val-add_component" class="anchor"></a><code><span><span class="keyword">val</span> add_component : <span><a href="#type-component">component</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>add_component comp</code> registers the machine component <code>comp</code> in the Primus Framework. The component's <code>init</code> function will be run every time the Machine compuation is run. After all components are initialized, the <code>init</code> observation is made.</p><p>The components shall not access the interpreter in their <code>init</code> function. Instead, they should subscribe to observations and/or initialize the machine state via Linker/Memory/Env components.</p><p>See also a more general <code>register_component</code> function.</p></div></div></div></body></html>