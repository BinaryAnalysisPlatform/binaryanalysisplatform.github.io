<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Trace (bap-primus.Bap_primus.Std.Primus.Linker.Trace)</title><link rel="stylesheet" href="../../../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../../../index.html">bap-primus</a> &#x00BB; <a href="../../../../index.html">Bap_primus</a> &#x00BB; <a href="../../../index.html">Std</a> &#x00BB; <a href="../../index.html">Primus</a> &#x00BB; <a href="../index.html">Linker</a> &#x00BB; Trace</nav><header class="odoc-preamble"><h1>Module <code><span>Linker.Trace</span></code></h1><p>Call tracing.</p><p>Linker doesn't operate in terms of functions or subroutines, but rather in terms of executable chunks of code. It is convenient, though, to track called functions, i.e., there are names and arguments (data-flow). Since a code in Primus is an uniterpreted computation it is the responsibility of the code provider to make corresponding observations, when a subroutine is entered or left.</p><p>By default, the code is provided by the BIR Interpreter and Primus Interpreter. Both care to provide corresponding observations. However, the Primus Lisp Interpreter provides call observations only when an externally visible function is called, e.g., malloc, free.</p></header><nav class="odoc-toc"><ul><li><a href="#notification-interface">Notification interface</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec value" id="val-call" class="anchored"><a href="#val-call" class="anchor"></a><code><span><span class="keyword">val</span> call : <span><span>(string * <span><a href="../../index.html#type-value">value</a> list</span>)</span> <a href="../../index.html#type-observation">observation</a></span></span></code></div><div class="spec-doc"><p>occurs when a subroutine is called. Argument values are specified in the same order in which corresponding input arguments of a corresponding subroutine term are specified.</p><p>Example,</p><p>(call (malloc 4))</p></div></div><div class="odoc-spec"><div class="spec value" id="val-return" class="anchored"><a href="#val-return" class="anchor"></a><code><span><span class="keyword">val</span> return : <span><span>(string * <span><a href="../../index.html#type-value">value</a> list</span>)</span> <a href="../../index.html#type-observation">observation</a></span></span></code></div><div class="spec-doc"><p>occurs just before a subroutine returns.</p><p>Context-wise, an observation is made when the interpreter is still in the subroutine. The argument list are in the same order as arguments of a corresponding subroutine. Values of all arguments are provided, including output and input arguments.</p><p>Example,</p><p>(call-return (malloc 4 0xDEADBEEF))</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lisp_call" class="anchored"><a href="#val-lisp_call" class="anchor"></a><code><span><span class="keyword">val</span> lisp_call : <span><span>(string * <span><a href="../../index.html#type-value">value</a> list</span>)</span> <a href="../../index.html#type-observation">observation</a></span></span></code></div><div class="spec-doc"><p>occurs when an externally linked primus stub is called. Arguments values are specified in the same order as in the <code>call</code> observation</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lisp_call_return" class="anchored"><a href="#val-lisp_call_return" class="anchor"></a><code><span><span class="keyword">val</span> lisp_call_return : <span><span>(string * <span><a href="../../index.html#type-value">value</a> list</span>)</span> <a href="../../index.html#type-observation">observation</a></span></span></code></div><div class="spec-doc"><p>occurs just before a lisp call from an external procedure returns. Arguments values are specified in the same order as in the <code>return</code> observation</p></div></div><h4 id="notification-interface"><a href="#notification-interface" class="anchor"></a>Notification interface</h4><p>Use <code>Machine.Observation.make</code> function, where <code>Machine</code> is a module implementing <code>Machine.S</code> interface, to provide observations.</p><div class="odoc-spec"><div class="spec value" id="val-call_entered" class="anchored"><a href="#val-call_entered" class="anchor"></a><code><span><span class="keyword">val</span> call_entered : <span><span>(string * <span><a href="../../index.html#type-value">value</a> list</span>)</span> <a href="../../index.html#type-statement">statement</a></span></span></code></div><div class="spec-doc"><p>the statement that makes <code>call</code> observations.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-call_returned" class="anchored"><a href="#val-call_returned" class="anchor"></a><code><span><span class="keyword">val</span> call_returned : <span><span>(string * <span><a href="../../index.html#type-value">value</a> list</span>)</span> <a href="../../index.html#type-statement">statement</a></span></span></code></div><div class="spec-doc"><p>the statement that makes <code>return</code> observations</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lisp_call_entered" class="anchored"><a href="#val-lisp_call_entered" class="anchor"></a><code><span><span class="keyword">val</span> lisp_call_entered : <span><span>(string * <span><a href="../../index.html#type-value">value</a> list</span>)</span> <a href="../../index.html#type-statement">statement</a></span></span></code></div><div class="spec-doc"><p>the statement that makes <code>lisp-call</code> observations</p></div></div><div class="odoc-spec"><div class="spec value" id="val-lisp_call_returned" class="anchored"><a href="#val-lisp_call_returned" class="anchor"></a><code><span><span class="keyword">val</span> lisp_call_returned : <span><span>(string * <span><a href="../../index.html#type-value">value</a> list</span>)</span> <a href="../../index.html#type-statement">statement</a></span></span></code></div><div class="spec-doc"><p>the statement that makes <code>lisp-call-return</code> observations</p></div></div></div></body></html>