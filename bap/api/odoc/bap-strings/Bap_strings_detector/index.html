<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Bap_strings_detector (bap-strings.Bap_strings_detector)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">bap-strings</a> &#x00BB; Bap_strings_detector</nav><header class="odoc-preamble"><h1>Module <code><span>Bap_strings_detector</span></code></h1><p>String computation detector.</p><p>The detector uses maximum aposteriori likelihood estimator (MAP) to detect code that operates with textual data.</p><p>We define textual data as a contiguous blocks of characters from a specified alphabet.</p><p>In our model a code is a sequence of instructions. Each instruction reads or writes characters. We're observing a set of characters accessed by an instruction (without any distinguishing whether it was a write or a read operation). The characters are produced by unknown values that are used during the computation. Some of these values are textual data. Any particular instruction either works with data produced by textual values or not. Moreover, we're looking for contiguous sequences of instructions that work with textual value.</p><p>The detector doesn't depend on a particular instruction implementation, instead it should be called after each instruction (or whatever granularity a user prefers) with a sequence of characters that were observed on that step.</p><p>The detector distinguishes between two competing hypotheses. The null hypothesis is that we are observing a subsequence of instructions that doesn't interact with textual values. The alternative hypothesis states that the observed subsequence operates with one or more textual values.</p><p>The detector operates in two different modes. In the search mode it looks for a subsequence that operates with textual values. Once it is found it switches to the second mode, and tries to find the end of this sequence, under an assumption that textual values have finite lengths. At the second mode we're switching hypotheses. We now assume as H0 a hypothesis that we're still processing textual values, and the H1 is that there are no longer textual values. Once we found the start and the end of the sequence, as well as all the characters that we attribute to the textual values the detection is considered finished.</p><p>The detection relies on a fact, that when a code processes textual values, built from a specified alphabet, the characters from this alphabet occurs slightly more often, then the it is prescribed by the uniform distribution.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>+'a t</span></span></code></div><div class="spec-doc"><p><code>detector</code></p></div></div><div class="odoc-spec"><div class="spec type" id="type-decision" class="anchored"><a href="#type-decision" class="anchor"></a><code><span><span class="keyword">type</span> <span>+'a decision</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>?alpha:float <span class="arrow">&#45;&gt;</span></span> <span>?beta:float <span class="arrow">&#45;&gt;</span></span> <span>?p1:float <span class="arrow">&#45;&gt;</span></span> <span>?ps:float <span class="arrow">&#45;&gt;</span></span>
<span>?len_pdf:<span>(<span>float <span class="arrow">&#45;&gt;</span></span> float)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Core_kernel</span>.Char.Set.t <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>create alphabet</code> creates a detector.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">alpha</span> <p>a desired probability of the false positive error;</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">beta</span> <p>a desired probability of the false negative error;</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">p1</span> <p>posterior probability of the H1 hypothesis;</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">ps</span> <p>probability of an alphabet character;</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">len_pdf</span> <p>probability distribution function of textual values lengths.</p></li></ul></div></div><p><code>run detector trace</code> runs a <code>detector</code> on a sequence on a <code>trace</code> represented as a sequence of bytes accessed during an execution. Returns a sequence of char sequences, where each subsequence is represented as a string and contains characters that were assumed to belong to the textual data.</p><div class="odoc-spec"><div class="spec value" id="val-run" class="anchored"><a href="#val-run" class="anchor"></a><code><span><span class="keyword">val</span> run : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span> * char)</span> <span class="xref-unresolved">Core_kernel</span>.Sequence.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-decision">decision</a></span> <span class="xref-unresolved">Core_kernel</span>.Sequence.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-step" class="anchored"><a href="#val-step" class="anchor"></a><code><span><span class="keyword">val</span> step : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span>char <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>step t data char</code> performs one observation.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-decision" class="anchored"><a href="#val-decision" class="anchor"></a><code><span><span class="keyword">val</span> decision : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-decision">decision</a></span> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-when_decided" class="anchored"><a href="#val-when_decided" class="anchor"></a><code><span><span class="keyword">val</span> when_decided : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>(<span><span><span class="type-var">'a</span> <a href="#type-decision">decision</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-abort" class="anchored"><a href="#val-abort" class="anchor"></a><code><span><span class="keyword">val</span> abort : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-decision">decision</a></span> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-result" class="anchored"><a href="#val-result" class="anchor"></a><code><span><span class="keyword">val</span> result : <span><span><span class="type-var">'a</span> <a href="#type-decision">decision</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * char)</span> list</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-chars" class="anchored"><a href="#val-chars" class="anchor"></a><code><span><span class="keyword">val</span> chars : <span><span><span class="type-var">'a</span> <a href="#type-decision">decision</a></span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-data" class="anchored"><a href="#val-data" class="anchor"></a><code><span><span class="keyword">val</span> data : <span>?rev:bool <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-decision">decision</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> list</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-pp" class="anchored"><a href="#val-pp" class="anchor"></a><code><span><span class="keyword">val</span> pp : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_decision" class="anchored"><a href="#val-pp_decision" class="anchor"></a><code><span><span class="keyword">val</span> pp_decision : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-decision">decision</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_stats" class="anchored"><a href="#val-pp_stats" class="anchor"></a><code><span><span class="keyword">val</span> pp_stats : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></div></body></html>