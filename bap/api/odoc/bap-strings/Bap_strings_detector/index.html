<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Bap_strings_detector (bap-strings.Bap_strings_detector)</title><link rel="stylesheet" href="../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">bap-strings</a> &#x00BB; Bap_strings_detector</nav><h1>Module <code>Bap_strings_detector</code></h1><p>String computation detector.</p><p>The detector uses maximum aposteriori likelihood estimator (MAP) to detect code that operates with textual data.</p><p>We define textual data as a contiguous blocks of characters from a specified alphabet.</p><p>In our model a code is a sequence of instructions. Each instruction reads or writes characters. We're observing a set of characters accessed by an instruction (without any distinguishing whether it was a write or a read operation). The characters are produced by unknown values that are used during the computation. Some of these values are textual data. Any particular instruction either works with data produced by textual values or not. Moreover, we're looking for contiguous sequences of instructions that work with textual value.</p><p>The detector doesn't depend on a particular instruction implementation, instead it should be called after each instruction (or whatever granularity a user prefers) with a sequence of characters that were observed on that step.</p><p>The detector distinguishes between two competing hypotheses. The null hypothesis is that we are observing a subsequence of instructions that doesn't interact with textual values. The alternative hypothesis states that the observed subsequence operates with one or more textual values.</p><p>The detector operates in two different modes. In the search mode it looks for a subsequence that operates with textual values. Once it is found it switches to the second mode, and tries to find the end of this sequence, under an assumption that textual values have finite lengths. At the second mode we're switching hypotheses. We now assume as H0 a hypothesis that we're still processing textual values, and the H1 is that there are no longer textual values. Once we found the start and the end of the sequence, as well as all the characters that we attribute to the textual values the detection is considered finished.</p><p>The detection relies on a fact, that when a code processes textual values, built from a specified alphabet, the characters from this alphabet occurs slightly more often, then the it is prescribed by the uniform distribution.</p></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> <span>+'a t</span></code></dt><dd><p><code>detector</code></p></dd></dl><dl><dt class="spec type" id="type-decision"><a href="#type-decision" class="anchor"></a><code><span class="keyword">type</span> <span>+'a decision</span></code></dt></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : <span>?&#8288;alpha:float</span> <span>&#45;&gt;</span> <span>?&#8288;beta:float</span> <span>&#45;&gt;</span> <span>?&#8288;p1:float</span> <span>&#45;&gt;</span> <span>?&#8288;ps:float</span> <span>&#45;&gt;</span> <span>?&#8288;len_pdf:<span>(float <span>&#45;&gt;</span> float)</span></span> <span>&#45;&gt;</span> <a href="../../core_kernel/Core_kernel__Char/Set/index.html#type-t">Core_kernel.Char.Set.t</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>create alphabet</code> creates a detector.</p><dl><dt>parameter alpha</dt><dd><p>a desired probability of the false positive error;</p></dd></dl><dl><dt>parameter beta</dt><dd><p>a desired probability of the false negative error;</p></dd></dl><dl><dt>parameter p1</dt><dd><p>posterior probability of the H1 hypothesis;</p></dd></dl><dl><dt>parameter ps</dt><dd><p>probability of an alphabet character;</p></dd></dl><dl><dt>parameter len_pdf</dt><dd><p>probability distribution function of textual values lengths.</p></dd></dl></dd></dl><aside><p><code>run detector trace</code> runs a <code>detector</code> on a sequence on a <code>trace</code> represented as a sequence of bytes accessed during an execution. Returns a sequence of char sequences, where each subsequence is represented as a string and contains characters that were assumed to belong to the textual data.</p></aside><dl><dt class="spec value" id="val-run"><a href="#val-run" class="anchor"></a><code><span class="keyword">val</span> run : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * char)</span> <a href="../../core_kernel/Core_kernel/Sequence/index.html#type-t">Core_kernel.Sequence.t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> <a href="index.html#type-decision">decision</a></span> <a href="../../core_kernel/Core_kernel/Sequence/index.html#type-t">Core_kernel.Sequence.t</a></span></code></dt><dt class="spec value" id="val-step"><a href="#val-step" class="anchor"></a><code><span class="keyword">val</span> step : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> char <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span></code></dt><dd><p><code>step t data char</code> performs one observation.</p></dd></dl><dl><dt class="spec value" id="val-decision"><a href="#val-decision" class="anchor"></a><code><span class="keyword">val</span> decision : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> <a href="index.html#type-decision">decision</a></span> option</span></code></dt><dt class="spec value" id="val-when_decided"><a href="#val-when_decided" class="anchor"></a><code><span class="keyword">val</span> when_decided : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span>f:<span>(<span><span class="type-var">'a</span> <a href="index.html#type-decision">decision</a></span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span></span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dt class="spec value" id="val-abort"><a href="#val-abort" class="anchor"></a><code><span class="keyword">val</span> abort : <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span class="type-var">'a</span> <a href="index.html#type-decision">decision</a></span> option</span></code></dt><dt class="spec value" id="val-result"><a href="#val-result" class="anchor"></a><code><span class="keyword">val</span> result : <span><span class="type-var">'a</span> <a href="index.html#type-decision">decision</a></span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * char)</span> list</span></code></dt><dt class="spec value" id="val-chars"><a href="#val-chars" class="anchor"></a><code><span class="keyword">val</span> chars : <span><span class="type-var">'a</span> <a href="index.html#type-decision">decision</a></span> <span>&#45;&gt;</span> string</code></dt><dt class="spec value" id="val-data"><a href="#val-data" class="anchor"></a><code><span class="keyword">val</span> data : <span>?&#8288;rev:bool</span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-decision">decision</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> list</span></code></dt><dt class="spec value" id="val-pp"><a href="#val-pp" class="anchor"></a><code><span class="keyword">val</span> pp : <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-pp_decision"><a href="#val-pp_decision" class="anchor"></a><code><span class="keyword">val</span> pp_decision : <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-decision">decision</a></span> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-pp_stats"><a href="#val-pp_stats" class="anchor"></a><code><span class="keyword">val</span> pp_stats : <a href="../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> unit</code></dt></dl></div></body></html>