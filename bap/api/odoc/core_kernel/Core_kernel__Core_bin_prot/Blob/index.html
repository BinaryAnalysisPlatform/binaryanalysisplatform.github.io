<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Blob (core_kernel.Core_kernel__Core_bin_prot.Blob)</title><link rel="stylesheet" href="../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">core_kernel</a> &#x00BB; <a href="../index.html">Core_kernel__Core_bin_prot</a> &#x00BB; Blob</nav><h1>Module <code>Core_kernel__Core_bin_prot.Blob</code></h1></header><div><div class="spec include"><div class="doc"><p><code>'a Blob.t</code> is type-equivalent to <code>'a</code>, but has different bin-prot serializers that prefix the representation with the size of <code>'a</code>.</p><p>To understand where this is useful, imagine we have an event type where many applications look at some parts of an event, but not all applications need to deal with all parts of an event. We might define:</p><pre><code class="ml">type 'a event =
  { time : Time.t
  ; source : string
  ; details : 'a
  } with bin_io</code></pre><p>Applications that need to understand all the details of an event could use:</p><pre><code class="ml">type concrete_event = Details.t Blob.t event with bin_io</code></pre><p>An application that filters events to downsteam consumers based on just <code>source</code> or <code>time</code> (but doesn't need to parse <code>details</code>) may use:</p><pre><code class="ml">type opaque_event = Blob.Opaque.Bigstring.t event with bin_io</code></pre><p>This has two advantages:</p><ul><li>(de)serializing messages is faster because potentially costly (de)serialization of <code>details</code> is avoided</li><li>the application can be compiled without any knowledge of any conrete <code>Details.t</code> type, so it's robust to changes in <code>Details.t</code></li></ul><p>An application that's happy to throw away <code>details</code> may use:</p><pre><code class="ml">type ignored_event = Blob.Ignored.t event with bin_read</code></pre><p>Whereas <code>opaque_event</code>s roundtrip, <code>ignored_event</code>s actually drop the bytes representing <code>details</code> when deserializing, and therefore do not roundtrip.</p><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../bin_prot/Bin_prot/Binable/index.html#module-type-S1">Bin_prot.Binable.S1</a> <span class="keyword">with</span> <span class="keyword">type</span> <span>'a <a href="../../../bin_prot/Bin_prot/Binable/module-type-S1/index.html#type-t">t</a></span> = <span class="type-var">'a</span></code></span></summary><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> <span>'a t</span></code><code> = <span class="type-var">'a</span></code></dt></dl><dl><dt class="spec value" id="val-bin_shape_t"><a href="#val-bin_shape_t" class="anchor"></a><code><span class="keyword">val</span> bin_shape_t : <a href="../../../bin_prot/Bin_prot/Shape/index.html#type-t">Bin_prot.Shape.t</a> <span>&#45;&gt;</span> <a href="../../../bin_prot/Bin_prot/Shape/index.html#type-t">Bin_prot.Shape.t</a></code></dt><dt class="spec value" id="val-bin_size_t"><a href="#val-bin_size_t" class="anchor"></a><code><span class="keyword">val</span> bin_size_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span>)</span> <a href="../../../bin_prot/Bin_prot/Size/index.html#type-sizer1">Bin_prot.Size.sizer1</a></span></code></dt><dt class="spec value" id="val-bin_write_t"><a href="#val-bin_write_t" class="anchor"></a><code><span class="keyword">val</span> bin_write_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span>)</span> <a href="../../../bin_prot/Bin_prot/Write/index.html#type-writer1">Bin_prot.Write.writer1</a></span></code></dt><dt class="spec value" id="val-bin_read_t"><a href="#val-bin_read_t" class="anchor"></a><code><span class="keyword">val</span> bin_read_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span>)</span> <a href="../../../bin_prot/Bin_prot/Read/index.html#type-reader1">Bin_prot.Read.reader1</a></span></code></dt><dt class="spec value" id="val-__bin_read_t__"><a href="#val-__bin_read_t__" class="anchor"></a><code><span class="keyword">val</span> __bin_read_t__ : <span><span>(<span class="type-var">'a</span>, int <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span>)</span> <a href="../../../bin_prot/Bin_prot/Read/index.html#type-reader1">Bin_prot.Read.reader1</a></span></code></dt><dt class="spec value" id="val-bin_writer_t"><a href="#val-bin_writer_t" class="anchor"></a><code><span class="keyword">val</span> bin_writer_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span>)</span> <a href="../../../bin_prot/Bin_prot/Type_class/S1/index.html#type-writer">Bin_prot.Type_class.S1.writer</a></span></code></dt><dt class="spec value" id="val-bin_reader_t"><a href="#val-bin_reader_t" class="anchor"></a><code><span class="keyword">val</span> bin_reader_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span>)</span> <a href="../../../bin_prot/Bin_prot/Type_class/S1/index.html#type-reader">Bin_prot.Type_class.S1.reader</a></span></code></dt><dt class="spec value" id="val-bin_t"><a href="#val-bin_t" class="anchor"></a><code><span class="keyword">val</span> bin_t : <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'a</span> <a href="index.html#type-t">t</a></span>)</span> <a href="../../../bin_prot/Bin_prot/Type_class/S1/index.html#type-t">Bin_prot.Type_class.S1.t</a></span></code></dt></dl></details></div></div></div><dl><dt class="spec module" id="module-Opaque"><a href="#module-Opaque" class="anchor"></a><code><span class="keyword">module</span> <a href="Opaque/index.html">Opaque</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>An <code>Opaque.Bigstring.t</code> or <code>Opaque.String.t</code> is an arbitrary piece of bin-prot. The bin-prot (de-)serializers simply read/write the data, prefixed with its size.</p></dd></dl><dl><dt class="spec module" id="module-Ignored"><a href="#module-Ignored" class="anchor"></a><code><span class="keyword">module</span> <a href="Ignored/index.html">Ignored</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>An <code>Ignored.t</code> is an unusable value with special bin-prot converters. The reader reads the size and drops that much data from the buffer. Writing is not supported, however the size of <code>t</code> is kept, so <code>bin_size_t</code> is available.</p></dd></dl></div></body></html>