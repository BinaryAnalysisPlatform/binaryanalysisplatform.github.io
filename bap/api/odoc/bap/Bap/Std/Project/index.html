<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Project (bap.Bap.Std.Project)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../../index.html">bap</a> &#x00BB; <a href="../../index.html">Bap</a> &#x00BB; <a href="../index.html">Std</a> &#x00BB; Project</nav><h1>Module <code>Std.Project</code></h1><p>Disassembled program.</p><p>Project contains data that we were able to reconstruct during the disassembly, semantic analysis, and other arbitrary amount of analyses.</p><p>Actually, project allows to associate arbitrary data with memory regions, program terms, and even attach them globally to itself. So it can be seen as a knowledge base of deeply interconnected facts.</p><p>Other than delivering information, from the bap to a passes, it can be also used as a communication media between different passes, (see <a href="../index.html#project"><span>Working with project</span></a>).</p><nav class="toc"><ul><li><a href="#extensible-record">Extensible record</a></li><li><a href="#registering-passes">Registering passes</a></li></ul></nav></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = <a href="../index.html#type-project">project</a></code></dt><dt class="spec type" id="type-state"><a href="#type-state" class="anchor"></a><code><span class="keyword">type</span> state</code></dt></dl><div><div class="spec include"><div class="doc"><dl><dt class="spec value" id="val-bin_shape_state"><a href="#val-bin_shape_state" class="anchor"></a><code><span class="keyword">val</span> bin_shape_state : Core_kernel.Bin_prot.Shape.t</code></dt><dt class="spec value" id="val-bin_size_state"><a href="#val-bin_size_state" class="anchor"></a><code><span class="keyword">val</span> bin_size_state : <span><a href="index.html#type-state">state</a> Core_kernel.Bin_prot.Size.sizer</span></code></dt><dt class="spec value" id="val-bin_write_state"><a href="#val-bin_write_state" class="anchor"></a><code><span class="keyword">val</span> bin_write_state : <span><a href="index.html#type-state">state</a> Core_kernel.Bin_prot.Write.writer</span></code></dt><dt class="spec value" id="val-bin_writer_state"><a href="#val-bin_writer_state" class="anchor"></a><code><span class="keyword">val</span> bin_writer_state : <span><a href="index.html#type-state">state</a> Core_kernel.Bin_prot.Type_class.writer</span></code></dt><dt class="spec value" id="val-bin_read_state"><a href="#val-bin_read_state" class="anchor"></a><code><span class="keyword">val</span> bin_read_state : <span><a href="index.html#type-state">state</a> Core_kernel.Bin_prot.Read.reader</span></code></dt><dt class="spec value" id="val-__bin_read_state__"><a href="#val-__bin_read_state__" class="anchor"></a><code><span class="keyword">val</span> __bin_read_state__ : <span><span>(int <span>&#45;&gt;</span> <a href="index.html#type-state">state</a>)</span> Core_kernel.Bin_prot.Read.reader</span></code></dt><dt class="spec value" id="val-bin_reader_state"><a href="#val-bin_reader_state" class="anchor"></a><code><span class="keyword">val</span> bin_reader_state : <span><a href="index.html#type-state">state</a> Core_kernel.Bin_prot.Type_class.reader</span></code></dt><dt class="spec value" id="val-bin_state"><a href="#val-bin_state" class="anchor"></a><code><span class="keyword">val</span> bin_state : <span><a href="index.html#type-state">state</a> Core_kernel.Bin_prot.Type_class.t</span></code></dt></dl></div></div></div><dl><dt class="spec type" id="type-input"><a href="#type-input" class="anchor"></a><code><span class="keyword">type</span> input</code></dt></dl><div><div class="spec include"><div class="doc"><p>IO interface to a project data structure.</p><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../../regular/Regular/Std/Data/index.html#module-type-S">Regular.Std.Data.S</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../../../../regular/Regular/Std/Data/module-type-S/index.html#type-t">t</a> := <a href="index.html#type-t">t</a></code></span></summary><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>type constructor</p></dd></dl><dl><dt class="spec type" id="type-info"><a href="#type-info" class="anchor"></a><code><span class="keyword">type</span> info</code><code> = string * <span>[ <span>`Ver of string</span> ]</span> * <span>string option</span></code></dt><dd><p><code>name,Ver v,desc</code> information attached to a particular reader or writer.</p></dd></dl><dl><dt class="spec value" id="val-version"><a href="#val-version" class="anchor"></a><code><span class="keyword">val</span> version : string</code></dt><dd><p>Data representation version. After any change in data representation the version should be increased.</p><p>Serializers that are derived from a data representation must have the same version as a version of the data structure, from which it is derived. This kind of serializers can only read and write data of the same version.</p><p>Other serializers can actually read and write data independent on its representation version. A serializer, that can't store data of current version simply shouldn't be added to a set of serializers.</p><p>It is assumed, that if a reader and a writer has the same name and version, then whatever was written by the writer should be readable by the reader. The round-trip equality is not required, thus it is acceptable if some information is lost.</p><p>It is also possible, that a reader and a writer that has the same name are compatible. In that case it is recommended to use semantic versioning.</p></dd></dl><dl><dt class="spec value" id="val-size_in_bytes"><a href="#val-size_in_bytes" class="anchor"></a><code><span class="keyword">val</span> size_in_bytes : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> <span>?&#8288;fmt:string</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p><code>size_in_bytes ?ver ?fmt datum</code> returns the amount of bytes that is needed to represent <code>datum</code> in the given format and version</p></dd></dl><dl><dt class="spec value" id="val-of_bytes"><a href="#val-of_bytes" class="anchor"></a><code><span class="keyword">val</span> of_bytes : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> <span>?&#8288;fmt:string</span> <span>&#45;&gt;</span> <a href="../../../../regular/Regular/Std/index.html#type-bytes">Regular.Std.bytes</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_bytes ?ver ?fmt bytes</code> deserializes a value from bytes.</p></dd></dl><dl><dt class="spec value" id="val-to_bytes"><a href="#val-to_bytes" class="anchor"></a><code><span class="keyword">val</span> to_bytes : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> <span>?&#8288;fmt:string</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../../../regular/Regular/Std/index.html#type-bytes">Regular.Std.bytes</a></code></dt><dd><p><code>to_bytes ?ver ?fmt datum</code> serializes a <code>datum</code> to a sequence of bytes.</p></dd></dl><dl><dt class="spec value" id="val-blit_to_bytes"><a href="#val-blit_to_bytes" class="anchor"></a><code><span class="keyword">val</span> blit_to_bytes : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> <span>?&#8288;fmt:string</span> <span>&#45;&gt;</span> <a href="../../../../regular/Regular/Std/index.html#type-bytes">Regular.Std.bytes</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>blit_to_bytes ?ver ?fmt buffer datum offset</code> copies a serialized representation of datum into a <code>buffer</code>, starting from the <code>offset</code>.</p></dd></dl><dl><dt class="spec value" id="val-of_bigstring"><a href="#val-of_bigstring" class="anchor"></a><code><span class="keyword">val</span> of_bigstring : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> <span>?&#8288;fmt:string</span> <span>&#45;&gt;</span> Core_kernel.bigstring <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>of_bigstring ?ver ?fmt buf</code> deserializes a datum from bigstring</p></dd></dl><dl><dt class="spec value" id="val-to_bigstring"><a href="#val-to_bigstring" class="anchor"></a><code><span class="keyword">val</span> to_bigstring : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> <span>?&#8288;fmt:string</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Core_kernel.bigstring</code></dt><dd><p><code>of_bigstring ?ver ?fmt datum</code> serializes a datum to a sequence of bytes represented as bigstring</p></dd></dl><dl><dt class="spec value" id="val-blit_to_bigstring"><a href="#val-blit_to_bigstring" class="anchor"></a><code><span class="keyword">val</span> blit_to_bigstring : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> <span>?&#8288;fmt:string</span> <span>&#45;&gt;</span> Core_kernel.bigstring <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit</code></dt><dd><p><code>blit_to_bigstring ?ver ?fmt buffer datum offset</code> copies a serialized representation of datum into a <code>buffer</code>, starting from <code>offset</code>.</p></dd></dl><dl><dt class="spec module" id="module-Io"><a href="#module-Io" class="anchor"></a><code><span class="keyword">module</span> <a href="Io/index.html">Io</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Input/Output functions for the given datum.</p></dd></dl><dl><dt class="spec module" id="module-Cache"><a href="#module-Cache" class="anchor"></a><code><span class="keyword">module</span> <a href="Cache/index.html">Cache</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Data cache.</p></dd></dl><dl><dt class="spec value" id="val-add_reader"><a href="#val-add_reader" class="anchor"></a><code><span class="keyword">val</span> add_reader : <span>?&#8288;desc:string</span> <span>&#45;&gt;</span> <span>ver:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> <a href="../../../../regular/Regular/Std/index.html#type-reader">Regular.Std.reader</a></span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_reader ?desc ~ver name reader</code> registers a new <code>reader</code> with a provided <code>name</code>, version <code>ver</code> and optional description <code>desc</code></p></dd></dl><dl><dt class="spec value" id="val-add_writer"><a href="#val-add_writer" class="anchor"></a><code><span class="keyword">val</span> add_writer : <span>?&#8288;desc:string</span> <span>&#45;&gt;</span> <span>ver:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> <a href="../../../../regular/Regular/Std/index.html#type-writer">Regular.Std.writer</a></span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>add_writer ?desc ~ver name writer</code> registers a new <code>writer</code> with a provided <code>name</code>, version <code>ver</code> and optional description <code>desc</code></p></dd></dl><dl><dt class="spec value" id="val-available_readers"><a href="#val-available_readers" class="anchor"></a><code><span class="keyword">val</span> available_readers : unit <span>&#45;&gt;</span> <span><a href="index.html#type-info">info</a> list</span></code></dt><dd><p><code>available_reader ()</code> lists available readers for the data type</p></dd></dl><dl><dt class="spec value" id="val-default_reader"><a href="#val-default_reader" class="anchor"></a><code><span class="keyword">val</span> default_reader : unit <span>&#45;&gt;</span> <a href="index.html#type-info">info</a></code></dt><dd><p><code>default_reader</code> returns information about default reader</p></dd></dl><dl><dt class="spec value" id="val-set_default_reader"><a href="#val-set_default_reader" class="anchor"></a><code><span class="keyword">val</span> set_default_reader : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>set_default_reader ?ver name</code> sets new default reader. If version is not specified then the latest available version is used. Raises an exception if a reader with a given name doesn't exist.</p></dd></dl><dl><dt class="spec value" id="val-with_reader"><a href="#val-with_reader" class="anchor"></a><code><span class="keyword">val</span> with_reader : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>(unit <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>with_reader ?ver name operation</code> temporary sets a default reader to a reader with a specified name and version. The default reader is restored after <code>operation</code> is finished.</p></dd></dl><dl><dt class="spec value" id="val-available_writers"><a href="#val-available_writers" class="anchor"></a><code><span class="keyword">val</span> available_writers : unit <span>&#45;&gt;</span> <span><a href="index.html#type-info">info</a> list</span></code></dt><dd><p><code>available_writer ()</code> lists available writers for the data type</p></dd></dl><dl><dt class="spec value" id="val-default_writer"><a href="#val-default_writer" class="anchor"></a><code><span class="keyword">val</span> default_writer : unit <span>&#45;&gt;</span> <a href="index.html#type-info">info</a></code></dt><dd><p><code>default_writer</code> returns information about the default writer</p></dd></dl><dl><dt class="spec value" id="val-set_default_writer"><a href="#val-set_default_writer" class="anchor"></a><code><span class="keyword">val</span> set_default_writer : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>set_default_writer ?ver name</code> sets new default writer. If version is not specified then the latest available version is used. Raises an exception if a writer with a given name doesn't exist.</p></dd></dl><dl><dt class="spec value" id="val-with_writer"><a href="#val-with_writer" class="anchor"></a><code><span class="keyword">val</span> with_writer : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>(unit <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>with_writer ?ver name operation</code> temporary sets a default writer to a writer with a specified name and version. The default writer is restored after <code>operation</code> is finished.</p></dd></dl><dl><dt class="spec value" id="val-default_printer"><a href="#val-default_printer" class="anchor"></a><code><span class="keyword">val</span> default_printer : unit <span>&#45;&gt;</span> <span><a href="index.html#type-info">info</a> option</span></code></dt><dd><p><code>default_writer</code> optionally returns an information about default printer</p></dd></dl><dl><dt class="spec value" id="val-set_default_printer"><a href="#val-set_default_printer" class="anchor"></a><code><span class="keyword">val</span> set_default_printer : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dd><p><code>set_default_printer ?ver name</code> sets new default printer. If version is not specified then the latest available version is used. Raises an exception if a printer with a given name doesn't exist.</p></dd></dl><dl><dt class="spec value" id="val-with_printer"><a href="#val-with_printer" class="anchor"></a><code><span class="keyword">val</span> with_printer : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span>(unit <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>with_printer ?ver name operation</code> temporary sets a default printer to a printer with a specified name and version. The default printer is restored after <code>operation</code> is finished.</p></dd></dl><section><header><h3 id="low-level-access-to-serializers"><a href="#low-level-access-to-serializers" class="anchor"></a>Low level access to serializers</h3></header><dl><dt class="spec value" id="val-find_reader"><a href="#val-find_reader" class="anchor"></a><code><span class="keyword">val</span> find_reader : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span><a href="index.html#type-t">t</a> <a href="../../../../regular/Regular/Std/index.html#type-reader">Regular.Std.reader</a></span> option</span></code></dt><dd><p><code>find_reader ?ver name</code> lookups a reader with a given name. If version is not specified, then a reader with maximum version is returned.</p></dd></dl><dl><dt class="spec value" id="val-find_writer"><a href="#val-find_writer" class="anchor"></a><code><span class="keyword">val</span> find_writer : <span>?&#8288;ver:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span><a href="index.html#type-t">t</a> <a href="../../../../regular/Regular/Std/index.html#type-writer">Regular.Std.writer</a></span> option</span></code></dt><dd><p><code>find_writer ?ver name</code> lookups a writer with a given name. If version is not specified, then a writer with maximum version is returned.</p></dd></dl></section></details></div></div></div><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : <span>?&#8288;package:string</span> <span>&#45;&gt;</span> <span>?&#8288;state:<a href="index.html#type-state">state</a></span> <span>&#45;&gt;</span> <span>?&#8288;disassembler:string</span> <span>&#45;&gt;</span> <span>?&#8288;brancher:<span><a href="../index.html#type-brancher">brancher</a> <a href="../index.html#type-source">source</a></span></span> <span>&#45;&gt;</span> <span>?&#8288;symbolizer:<span><a href="../index.html#type-symbolizer">symbolizer</a> <a href="../index.html#type-source">source</a></span></span> <span>&#45;&gt;</span> <span>?&#8288;rooter:<span><a href="../index.html#type-rooter">rooter</a> <a href="../index.html#type-source">source</a></span></span> <span>&#45;&gt;</span> <span>?&#8288;reconstructor:<span><a href="../index.html#type-reconstructor">reconstructor</a> <a href="../index.html#type-source">source</a></span></span> <span>&#45;&gt;</span> <a href="index.html#type-input">input</a> <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> Core_kernel.Or_error.t</span></code></dt><dd><p><code>from_file filename</code> creates a project from the provided input source.</p><p>The input code regions are speculatively disassembled and the set of basic blocks is determined, using the algorithm described in <a href="../Disasm/Driver/index.html"><code>Disasm.Driver</code></a>. After that the concrete whole program control-flow graph (CFG) is built, which can be accessed with the <a href="index.html#val-disasm"><code>Project.disasm</code></a> function. The whole program CFG is then partitioned into a set of subroutines using the dominators analsysis, see <a href="../Disasm/Subroutines/index.html"><code>Disasm.Subroutines</code></a> for details. Based on this partition a symbol table, which is a set of a subroutines control-flow graphs, is built. The symbol table, which can be accessed with <a href="index.html#val-symbols"><code>Project.symbols</code></a>, also contains information about the interprocedural control flow. Finally, the symbol table is translated into the intermediate representation, which can be accessed using the <a href="index.html#val-program"><code>Project.program</code></a> function. The whole process is pictured below.</p><pre>                         ---------------------
                        (    Disassembling    )
                         ---------------------
                                  |
                        +---------------------+
                        |                     |
                        |  All instructions   |
                        |  and basic blocks   |
                        |                     |
                        +---------------------+
                                  |
                         ---------------------
                        ( CFG  reconstruction )
                         ---------------------
                                  |
                        +---------------------+
                        |                     |
                        |  The whole program  |
                        |  control-flow graph |
                        |                     |
                        +---------------------+
                                  |
                         ---------------------
                        (    Partitioning     )
                         ---------------------
                                  |
                        +---------------------+
                        |                     |
                        | The quotient set of |
                        |    basic  blocks    |
                        |                     |
                        +---------------------+
                                  |
                         ---------------------
                        ( Constructing Symtab )
                         ---------------------
                                  |
                        +---------------------+
                        |                     |
                        |   The symbol table  |
                        |  and the  callgraph |
                        |                     |
                        +---------------------+
                                  |
                         ---------------------
                        (  IR Reconstruction  )
                         ---------------------
                                  |
                        +---------------------+
                        |                     |
                        |    The IR of the    |
                        |   binary  program   |
                        |                     |
                        +---------------------+</pre><p>The disassembling process is fully integrated with the knowledge base. If the input source provides information about symbols and their location, then this information will be automatically reflected to the knowledge base.</p><p>The <code>brancher</code>, <code>symbolizer</code>, and <code>rooter</code> parameters are ignored since 2.0.0 and their information could be reflected to the knowledge base using, correspondingly, <a href="../Brancher/index.html#val-provide"><code>Brancher.provide</code></a>, <a href="../Symbolizer/index.html#val-provide"><code>Symbolizer.provide</code></a>, and <a href="../Rooter/index.html#val-provide"><code>Rooter.provide</code></a> functions.</p><dl><dt>parameter state</dt><dd><p>if specified then the provided <code>state</code> will be used as the initial state</p></dd></dl><dl><dt>parameter package</dt><dd><p>if specified, then all symbols during the disassembly will be created (interned) in the specified package.</p></dd></dl><dl><dt>since</dt><dd>2.0.0 the state parameter is added</dd></dl><dl><dt>since</dt><dd>2.0.0 the parameter [disassembler] is unused</dd></dl><dl><dt>since</dt><dd>2.0.0 the parameter [brancher] is unused</dd></dl><dl><dt>since</dt><dd>2.0.0 the parameter [symbolizer] is unused</dd></dl><dl><dt>since</dt><dd>2.0.0 the parameter [rooter] is unused</dd></dl><dl><dt>since</dt><dd>2.0.0 the parameter [reconstructor] is unused</dd></dl><dl><dt>since</dt><dd>2.2.0 the package parameter is added</dd></dl></dd></dl><dl><dt class="spec value" id="val-empty"><a href="#val-empty" class="anchor"></a><code><span class="keyword">val</span> empty : <a href="../../../../bap-core-theory/Bap_core_theory/Theory/Target/index.html#type-t">Bap_core_theory.Theory.Target.t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>empty target</code> creates a for the given <code>target</code>.</p></dd></dl><dl><dt class="spec value" id="val-arch"><a href="#val-arch" class="anchor"></a><code><span class="keyword">val</span> arch : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-arch">arch</a></code></dt><dd><p><code>arch project</code> reveals the architecture of a loaded file</p><dl><dt>deprecated</dt><dd><p>use <code>target project</code> instead.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-target"><a href="#val-target" class="anchor"></a><code><span class="keyword">val</span> target : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../../../bap-core-theory/Bap_core_theory/Theory/Target/index.html#type-t">Bap_core_theory.Theory.Target.t</a></code></dt><dd><p><code>target project</code> returns the target system of the project.</p><dl><dt>since</dt><dd>2.2.0</dd></dl></dd></dl><dl><dt class="spec value" id="val-specification"><a href="#val-specification" class="anchor"></a><code><span class="keyword">val</span> specification : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../../../../ogre/Ogre/index.html#type-doc">Ogre.doc</a></code></dt><dd><p><code>specification p</code> returns the specification of the binary.</p><dl><dt>since</dt><dd>2.2.0</dd></dl></dd></dl><dl><dt class="spec value" id="val-state"><a href="#val-state" class="anchor"></a><code><span class="keyword">val</span> state : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-state">state</a></code></dt><dd><p><code>state project</code> returns the core state of the <code>project</code>.</p><dl><dt>since</dt><dd>2.0.0</dd></dl></dd></dl><dl><dt class="spec value" id="val-disasm"><a href="#val-disasm" class="anchor"></a><code><span class="keyword">val</span> disasm : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-disasm">disasm</a></code></dt><dd><p><code>disasm project</code> returns results of disassembling</p></dd></dl><dl><dt class="spec value" id="val-program"><a href="#val-program" class="anchor"></a><code><span class="keyword">val</span> program : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../index.html#type-program">program</a> <a href="../index.html#type-term">term</a></span></code></dt><dd><p><code>program project</code> returns a program lifted into <a href="../index.html#sema"><span>IR</span></a></p></dd></dl><dl><dt class="spec value" id="val-with_program"><a href="#val-with_program" class="anchor"></a><code><span class="keyword">val</span> with_program : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../index.html#type-program">program</a> <a href="../index.html#type-term">term</a></span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>with_program project program</code> updates a project program</p></dd></dl><dl><dt class="spec value" id="val-map_program"><a href="#val-map_program" class="anchor"></a><code><span class="keyword">val</span> map_program : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>f:<span>(<span><a href="../index.html#type-program">program</a> <a href="../index.html#type-term">term</a></span> <span>&#45;&gt;</span> <span><a href="../index.html#type-program">program</a> <a href="../index.html#type-term">term</a></span>)</span></span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>map_program t ~f</code> maps the IR representation of the program with function <code>f</code>.</p><p>Note: since the program is computed lazily this function should be preferred to <code>program</code> composed <code>with_program</code> for passes that transform the program representation so that they are not run if the program is never ever used.</p></dd></dl><dl><dt class="spec value" id="val-symbols"><a href="#val-symbols" class="anchor"></a><code><span class="keyword">val</span> symbols : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-symtab">symtab</a></code></dt><dd><p><code>symbols t</code> returns reconstructed symbol table</p></dd></dl><dl><dt class="spec value" id="val-with_symbols"><a href="#val-with_symbols" class="anchor"></a><code><span class="keyword">val</span> with_symbols : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-symtab">symtab</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>with_symbols project symbols</code> updates <code>project</code> symbols</p></dd></dl><dl><dt class="spec value" id="val-storage"><a href="#val-storage" class="anchor"></a><code><span class="keyword">val</span> storage : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-dict">dict</a></code></dt><dd><p>returns an attribute storage of the project</p></dd></dl><dl><dt class="spec value" id="val-with_storage"><a href="#val-with_storage" class="anchor"></a><code><span class="keyword">val</span> with_storage : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-dict">dict</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>updates the attribute storage</p></dd></dl><dl><dt class="spec value" id="val-memory"><a href="#val-memory" class="anchor"></a><code><span class="keyword">val</span> memory : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../index.html#type-value">value</a> <a href="../index.html#type-memmap">memmap</a></span></code></dt><dd><p><code>memory t</code> returns the memory as an interval tree marked with arbitrary values.</p></dd></dl><dl><dt class="spec value" id="val-memory_slot"><a href="#val-memory_slot" class="anchor"></a><code><span class="keyword">val</span> memory_slot : <span><span>(<a href="../../../../bap-core-theory/Bap_core_theory/Theory/Unit/index.html#type-cls">Bap_core_theory.Theory.Unit.cls</a>, <span><a href="../index.html#type-value">value</a> <a href="../index.html#type-memmap">memmap</a></span>)</span> <a href="../../../../bap-knowledge/Bap_knowledge/Knowledge/index.html#type-slot">Bap_core_theory.KB.slot</a></span></code></dt><dd><p>the memory of the unit in the knowledge base.</p><dl><dt>since</dt><dd>2.2.0</dd></dl></dd></dl><dl><dt class="spec value" id="val-tag_memory"><a href="#val-tag_memory" class="anchor"></a><code><span class="keyword">val</span> tag_memory : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-mem">mem</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../index.html#type-tag">tag</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>tag_memory project region tag value</code> tags a given <code>region</code> of memory in <code>project</code> with a given <code>tag</code> and <code>value</code>. Example: <code>Project.tag_memory project tained color red</code></p></dd></dl><dl><dt class="spec value" id="val-substitute"><a href="#val-substitute" class="anchor"></a><code><span class="keyword">val</span> substitute : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="../index.html#type-mem">mem</a> <span>&#45;&gt;</span> <span>string <a href="../index.html#type-tag">tag</a></span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>substitute p region tag value</code> is like <a href="index.html#val-tag_memory"><span>tag_memory</span></a>, but it will also apply substitutions in the provided string value, as per OCaml standard library's <code>Buffer.add_substitute</code> function.</p><p>Example: </p><pre><code class="ml">Project.substitute project comment &quot;$symbol starts at $symbol_addr&quot;</code></pre><p>The following substitutions are supported:</p><ul><li><code>$section{_name,_addr,_min_addr,_max_addr}</code> - name of region of file to which it belongs. For example, in ELF this name will correspond to the section name</li></ul><ul><li><code>$symbol{_name,_addr,_min_addr,_max_addr}</code> - name or address of the symbol to which this memory belongs</li></ul><ul><li><code>$asm</code> - assembler listing of the memory region</li></ul><ul><li><code>$bil</code> - BIL code of the tagged memory region</li></ul><ul><li><code>$block{_name,_addr,_min_addr,_max_addr}</code> - name or address of a basic block to which this region belongs</li></ul><ul><li><code>$min_addr, $addr</code> - starting address of a memory region</li></ul><ul><li><code>$max_addr</code> - address of the last byte of a memory region.</li></ul></dd></dl><dl><dt class="spec value" id="val-with_memory"><a href="#val-with_memory" class="anchor"></a><code><span class="keyword">val</span> with_memory : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="../index.html#type-value">value</a> <a href="../index.html#type-memmap">memmap</a></span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>with_memory project</code> updates project memory. It is recommended to use <a href="index.html#val-tag_memory"><code>tag_memory</code></a> and <a href="index.html#val-substitute"><code>substitute</code></a> instead of this function, if possible.</p></dd></dl><section><header><h4 id="extensible-record"><a href="#extensible-record" class="anchor"></a>Extensible record</h4><p>Project can also be viewed as an extensible record, where one can store arbitrary values. Example,</p><pre><code class="ml">let p = Project.set project color `green</code></pre><p>This will set field <code>color</code> to a value <code>`green</code>.</p></header><dl><dt class="spec value" id="val-set"><a href="#val-set" class="anchor"></a><code><span class="keyword">val</span> set : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../index.html#type-tag">tag</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>set project field value</code> sets a <code>field</code> to a give value. If <code>field</code> was already set, then new value overrides the old one. Otherwise the field is added.</p></dd></dl><dl><dt class="spec value" id="val-get"><a href="#val-get" class="anchor"></a><code><span class="keyword">val</span> get : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../index.html#type-tag">tag</a></span> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> option</span></code></dt><dd><p><code>get project field</code> returns the value of the <code>field</code> if it exists</p></dd></dl><dl><dt class="spec value" id="val-has"><a href="#val-has" class="anchor"></a><code><span class="keyword">val</span> has : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../index.html#type-tag">tag</a></span> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>has project field</code> checks whether field exists or not. Useful for fields of type unit, that actually isomorphic to bool fields, e.g., <code>if Project.has project mark</code></p></dd></dl><dl><dt class="spec value" id="val-del"><a href="#val-del" class="anchor"></a><code><span class="keyword">val</span> del : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span class="type-var">'a</span> <a href="../index.html#type-tag">tag</a></span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>del project attr</code> removes an attribute from a project</p></dd></dl><dl><dt class="spec module" id="module-Info"><a href="#module-Info" class="anchor"></a><code><span class="keyword">module</span> <a href="Info/index.html">Info</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Information obtained during project reconstruction.</p></dd></dl><dl><dt class="spec module" id="module-State"><a href="#module-State" class="anchor"></a><code><span class="keyword">module</span> <a href="State/index.html">State</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>The core state of the project.</p></dd></dl><dl><dt class="spec module" id="module-Input"><a href="#module-Input" class="anchor"></a><code><span class="keyword">module</span> <a href="Input/index.html">Input</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Input information.</p></dd></dl></section><section><header><h4 id="registering-passes"><a href="#registering-passes" class="anchor"></a>Registering passes</h4><p>To add new pass one of the following <code>register_*</code> functions should be called.</p></header><dl><dt class="spec type" id="type-pass"><a href="#type-pass" class="anchor"></a><code><span class="keyword">type</span> pass</code></dt></dl><dl><dt class="spec value" id="val-register_pass"><a href="#val-register_pass" class="anchor"></a><code><span class="keyword">val</span> register_pass : <span>?&#8288;autorun:bool</span> <span>&#45;&gt;</span> <span>?&#8288;runonce:bool</span> <span>&#45;&gt;</span> <span>?&#8288;deps:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;name:string</span> <span>&#45;&gt;</span> <span>(<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a>)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>register_pass ?autorun ?runonce ?deps ?name pass</code> registers a <code>pass</code> over a project.</p><p>If <code>autorun</code> is <code>true</code>, then the host program will run this pass automatically. If <code>runonce</code> is true, then for a given project the pass will be run only once. Each repeating attempts to run the pass will be ignored. The <code>runonce</code> parameter defaults to <code>false</code> when <code>autorun</code> is <code>false</code>, and to <code>true</code> otherwise.</p><p>Parameter <code>deps</code> is list of dependencies. Each dependency is a name of a pass, that should be run before the <code>pass</code>. The dependencies will be run in a specified order every time the <code>pass</code> is run.</p><p>To get access to command line arguments use <code>Plugin.argv</code></p></dd></dl><dl><dt class="spec value" id="val-register_pass'"><a href="#val-register_pass'" class="anchor"></a><code><span class="keyword">val</span> register_pass' : <span>?&#8288;autorun:bool</span> <span>&#45;&gt;</span> <span>?&#8288;runonce:bool</span> <span>&#45;&gt;</span> <span>?&#8288;deps:<span>string list</span></span> <span>&#45;&gt;</span> <span>?&#8288;name:string</span> <span>&#45;&gt;</span> <span>(<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>register_pass' pass</code> registers <code>pass</code> that doesn't modify the project effect and is run only for side effect. (See <a href="index.html#val-register_pass"><code>register_pass</code></a>)</p></dd></dl><dl><dt class="spec value" id="val-passes"><a href="#val-passes" class="anchor"></a><code><span class="keyword">val</span> passes : unit <span>&#45;&gt;</span> <span><a href="index.html#type-pass">pass</a> list</span></code></dt><dd><p><code>passes ()</code> returns all currently registered passes.</p></dd></dl><dl><dt class="spec value" id="val-find_pass"><a href="#val-find_pass" class="anchor"></a><code><span class="keyword">val</span> find_pass : string <span>&#45;&gt;</span> <span><a href="index.html#type-pass">pass</a> option</span></code></dt><dd><p><code>find_pass name</code> returns a pass with the given name.</p></dd></dl><dl><dt class="spec type" id="type-second"><a href="#type-second" class="anchor"></a><code><span class="keyword">type</span> second</code><code> = float</code></dt><dd><p>time duration in seconds</p></dd></dl><dl><dt class="spec module" id="module-Pass"><a href="#module-Pass" class="anchor"></a><code><span class="keyword">module</span> <a href="Pass/index.html">Pass</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>A program analysis pass.</p></dd></dl><dl><dt class="spec module" id="module-Collator"><a href="#module-Collator" class="anchor"></a><code><span class="keyword">module</span> <a href="Collator/index.html">Collator</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>A pass that collates projects.</p></dd></dl><dl><dt class="spec module" id="module-Analysis"><a href="#module-Analysis" class="anchor"></a><code><span class="keyword">module</span> <a href="Analysis/index.html">Analysis</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Knowledge base analyses.</p></dd></dl></section></div></body></html>