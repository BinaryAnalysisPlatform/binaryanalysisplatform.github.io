<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Project (bap.Bap.Std.Project)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">bap</a> &#x00BB; <a href="../../index.html">Bap</a> &#x00BB; <a href="../index.html">Std</a> &#x00BB; Project</nav><header class="odoc-preamble"><h1>Module <code><span>Std.Project</span></code></h1><p>Disassembled program.</p><p>Project contains data that we were able to reconstruct during the disassembly, semantic analysis, and other arbitrary amount of analyses.</p><p>Actually, project allows to associate arbitrary data with memory regions, program terms, and even attach them globally to itself. So it can be seen as a knowledge base of deeply interconnected facts.</p><p>Other than delivering information, from the bap to a passes, it can be also used as a communication media between different passes, (see <a href="../index.html#project">Working with project</a>).</p></header><nav class="odoc-toc"><ul><li><a href="#extensible-record">Extensible record</a></li><li><a href="#registering-passes">Registering passes</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span><span> = <a href="../index.html#type-project">project</a></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-state" class="anchored"><a href="#type-state" class="anchor"></a><code><span><span class="keyword">type</span> state</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_shape_state" class="anchored"><a href="#val-bin_shape_state" class="anchor"></a><code><span><span class="keyword">val</span> bin_shape_state : <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Shape.t</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_size_state" class="anchored"><a href="#val-bin_size_state" class="anchor"></a><code><span><span class="keyword">val</span> bin_size_state : <span><a href="#type-state">state</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Size.sizer</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_write_state" class="anchored"><a href="#val-bin_write_state" class="anchor"></a><code><span><span class="keyword">val</span> bin_write_state : <span><a href="#type-state">state</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Write.writer</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_writer_state" class="anchored"><a href="#val-bin_writer_state" class="anchor"></a><code><span><span class="keyword">val</span> bin_writer_state : <span><a href="#type-state">state</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Type_class.writer</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_read_state" class="anchored"><a href="#val-bin_read_state" class="anchor"></a><code><span><span class="keyword">val</span> bin_read_state : <span><a href="#type-state">state</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Read.reader</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-__bin_read_state__" class="anchored"><a href="#val-__bin_read_state__" class="anchor"></a><code><span><span class="keyword">val</span> __bin_read_state__ : <span><span>( <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-state">state</a> )</span> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Read.reader</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_reader_state" class="anchored"><a href="#val-bin_reader_state" class="anchor"></a><code><span><span class="keyword">val</span> bin_reader_state : <span><a href="#type-state">state</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Type_class.reader</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bin_state" class="anchored"><a href="#val-bin_state" class="anchor"></a><code><span><span class="keyword">val</span> bin_state : <span><a href="#type-state">state</a> <span class="xref-unresolved">Core_kernel</span>.Bin_prot.Type_class.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-input" class="anchored"><a href="#type-input" class="anchor"></a><code><span><span class="keyword">type</span> input</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-library" class="anchored"><a href="#type-library" class="anchor"></a><code><span><span class="keyword">type</span> library</span></code></div></div><div class="odoc-include"><div class="spec-doc"><p>IO interface to a project data structure.</p></div><details open="open"><summary class="spec include"><code><span><span class="keyword">include</span> <a href="../../../../regular/Regular/Std/Data/module-type-S/index.html">Regular.Std.Data.S</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="../../../../regular/Regular/Std/Data/module-type-S/index.html#type-t">t</a> := <a href="#type-t">t</a></span></span></code></summary><div class="odoc-spec"><div class="spec type" id="type-info" class="anchored"><a href="#type-info" class="anchor"></a><code><span><span class="keyword">type</span> info</span><span> = string * <span>[ <span>`Ver of string</span> ]</span> * <span>string option</span></span></code></div><div class="spec-doc"><p><code>name,Ver v,desc</code> information attached to a particular reader or writer.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-version" class="anchored"><a href="#val-version" class="anchor"></a><code><span><span class="keyword">val</span> version : string</span></code></div><div class="spec-doc"><p>Data representation version. After any change in data representation the version should be increased.</p><p>Serializers that are derived from a data representation must have the same version as a version of the data structure, from which it is derived. This kind of serializers can only read and write data of the same version.</p><p>Other serializers can actually read and write data independent on its representation version. A serializer, that can't store data of current version simply shouldn't be added to a set of serializers.</p><p>It is assumed, that if a reader and a writer has the same name and version, then whatever was written by the writer should be readable by the reader. The round-trip equality is not required, thus it is acceptable if some information is lost.</p><p>It is also possible, that a reader and a writer that has the same name are compatible. In that case it is recommended to use semantic versioning.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-size_in_bytes" class="anchored"><a href="#val-size_in_bytes" class="anchor"></a><code><span><span class="keyword">val</span> size_in_bytes : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>?fmt:string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> int</span></code></div><div class="spec-doc"><p><code>size_in_bytes ?ver ?fmt datum</code> returns the amount of bytes that is needed to represent <code>datum</code> in the given format and version</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_bytes" class="anchored"><a href="#val-of_bytes" class="anchor"></a><code><span><span class="keyword">val</span> of_bytes : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>?fmt:string <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../../regular/Regular/Std/index.html#type-bytes">Regular.Std.bytes</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>of_bytes ?ver ?fmt bytes</code> deserializes a value from bytes.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_bytes" class="anchored"><a href="#val-to_bytes" class="anchor"></a><code><span><span class="keyword">val</span> to_bytes : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>?fmt:string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../regular/Regular/Std/index.html#type-bytes">Regular.Std.bytes</a></span></code></div><div class="spec-doc"><p><code>to_bytes ?ver ?fmt datum</code> serializes a <code>datum</code> to a sequence of bytes.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-blit_to_bytes" class="anchored"><a href="#val-blit_to_bytes" class="anchor"></a><code><span><span class="keyword">val</span> blit_to_bytes : 
  <span>?ver:string <span class="arrow">&#45;&gt;</span></span>
  <span>?fmt:string <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../../regular/Regular/Std/index.html#type-bytes">Regular.Std.bytes</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>blit_to_bytes ?ver ?fmt buffer datum offset</code> copies a serialized representation of datum into a <code>buffer</code>, starting from the <code>offset</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-of_bigstring" class="anchored"><a href="#val-of_bigstring" class="anchor"></a><code><span><span class="keyword">val</span> of_bigstring : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>?fmt:string <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Core_kernel</span>.bigstring <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>of_bigstring ?ver ?fmt buf</code> deserializes a datum from bigstring</p></div></div><div class="odoc-spec"><div class="spec value" id="val-to_bigstring" class="anchored"><a href="#val-to_bigstring" class="anchor"></a><code><span><span class="keyword">val</span> to_bigstring : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>?fmt:string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Core_kernel</span>.bigstring</span></code></div><div class="spec-doc"><p><code>of_bigstring ?ver ?fmt datum</code> serializes a datum to a sequence of bytes represented as bigstring</p></div></div><div class="odoc-spec"><div class="spec value" id="val-blit_to_bigstring" class="anchored"><a href="#val-blit_to_bigstring" class="anchor"></a><code><span><span class="keyword">val</span> blit_to_bigstring : 
  <span>?ver:string <span class="arrow">&#45;&gt;</span></span>
  <span>?fmt:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Core_kernel</span>.bigstring <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>blit_to_bigstring ?ver ?fmt buffer datum offset</code> copies a serialized representation of datum into a <code>buffer</code>, starting from <code>offset</code>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Io" class="anchored"><a href="#module-Io" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Io/index.html">Io</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Input/Output functions for the given datum.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Cache" class="anchored"><a href="#module-Cache" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Cache/index.html">Cache</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Data cache.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-add_reader" class="anchored"><a href="#val-add_reader" class="anchor"></a><code><span><span class="keyword">val</span> add_reader : 
  <span>?desc:string <span class="arrow">&#45;&gt;</span></span>
  <span>ver:string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-t">t</a> <a href="../../../../regular/Regular/Std/index.html#type-reader">Regular.Std.reader</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>add_reader ?desc ~ver name reader</code> registers a new <code>reader</code> with a provided <code>name</code>, version <code>ver</code> and optional description <code>desc</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-add_writer" class="anchored"><a href="#val-add_writer" class="anchor"></a><code><span><span class="keyword">val</span> add_writer : 
  <span>?desc:string <span class="arrow">&#45;&gt;</span></span>
  <span>ver:string <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="#type-t">t</a> <a href="../../../../regular/Regular/Std/index.html#type-writer">Regular.Std.writer</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>add_writer ?desc ~ver name writer</code> registers a new <code>writer</code> with a provided <code>name</code>, version <code>ver</code> and optional description <code>desc</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-available_readers" class="anchored"><a href="#val-available_readers" class="anchor"></a><code><span><span class="keyword">val</span> available_readers : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-info">info</a> list</span></span></code></div><div class="spec-doc"><p><code>available_reader ()</code> lists available readers for the data type</p></div></div><div class="odoc-spec"><div class="spec value" id="val-default_reader" class="anchored"><a href="#val-default_reader" class="anchor"></a><code><span><span class="keyword">val</span> default_reader : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-info">info</a></span></code></div><div class="spec-doc"><p><code>default_reader</code> returns information about default reader</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_default_reader" class="anchored"><a href="#val-set_default_reader" class="anchor"></a><code><span><span class="keyword">val</span> set_default_reader : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>set_default_reader ?ver name</code> sets new default reader. If version is not specified then the latest available version is used. Raises an exception if a reader with a given name doesn't exist.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_reader" class="anchored"><a href="#val-with_reader" class="anchor"></a><code><span><span class="keyword">val</span> with_reader : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_reader ?ver name operation</code> temporary sets a default reader to a reader with a specified name and version. The default reader is restored after <code>operation</code> is finished.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-available_writers" class="anchored"><a href="#val-available_writers" class="anchor"></a><code><span><span class="keyword">val</span> available_writers : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-info">info</a> list</span></span></code></div><div class="spec-doc"><p><code>available_writer ()</code> lists available writers for the data type</p></div></div><div class="odoc-spec"><div class="spec value" id="val-default_writer" class="anchored"><a href="#val-default_writer" class="anchor"></a><code><span><span class="keyword">val</span> default_writer : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-info">info</a></span></code></div><div class="spec-doc"><p><code>default_writer</code> returns information about the default writer</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_default_writer" class="anchored"><a href="#val-set_default_writer" class="anchor"></a><code><span><span class="keyword">val</span> set_default_writer : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>set_default_writer ?ver name</code> sets new default writer. If version is not specified then the latest available version is used. Raises an exception if a writer with a given name doesn't exist.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_writer" class="anchored"><a href="#val-with_writer" class="anchor"></a><code><span><span class="keyword">val</span> with_writer : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_writer ?ver name operation</code> temporary sets a default writer to a writer with a specified name and version. The default writer is restored after <code>operation</code> is finished.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-default_printer" class="anchored"><a href="#val-default_printer" class="anchor"></a><code><span><span class="keyword">val</span> default_printer : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-info">info</a> option</span></span></code></div><div class="spec-doc"><p><code>default_writer</code> optionally returns an information about default printer</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_default_printer" class="anchored"><a href="#val-set_default_printer" class="anchor"></a><code><span><span class="keyword">val</span> set_default_printer : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>set_default_printer ?ver name</code> sets new default printer. If version is not specified then the latest available version is used. Raises an exception if a printer with a given name doesn't exist.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_printer" class="anchored"><a href="#val-with_printer" class="anchor"></a><code><span><span class="keyword">val</span> with_printer : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>with_printer ?ver name operation</code> temporary sets a default printer to a printer with a specified name and version. The default printer is restored after <code>operation</code> is finished.</p></div></div><h3 id="low-level-access-to-serializers"><a href="#low-level-access-to-serializers" class="anchor"></a>Low level access to serializers</h3><div class="odoc-spec"><div class="spec value" id="val-find_reader" class="anchored"><a href="#val-find_reader" class="anchor"></a><code><span><span class="keyword">val</span> find_reader : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-t">t</a> <a href="../../../../regular/Regular/Std/index.html#type-reader">Regular.Std.reader</a></span> option</span></span></code></div><div class="spec-doc"><p><code>find_reader ?ver name</code> lookups a reader with a given name. If version is not specified, then a reader with maximum version is returned.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find_writer" class="anchored"><a href="#val-find_writer" class="anchor"></a><code><span><span class="keyword">val</span> find_writer : <span>?ver:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-t">t</a> <a href="../../../../regular/Regular/Std/index.html#type-writer">Regular.Std.writer</a></span> option</span></span></code></div><div class="spec-doc"><p><code>find_writer ?ver name</code> lookups a writer with a given name. If version is not specified, then a writer with maximum version is returned.</p></div></div></details></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : 
  <span>?package:string <span class="arrow">&#45;&gt;</span></span>
  <span>?state:<a href="#type-state">state</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?disassembler:string <span class="arrow">&#45;&gt;</span></span>
  <span>?brancher:<span><a href="../index.html#type-brancher">brancher</a> <a href="../index.html#type-source">source</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>?symbolizer:<span><a href="../index.html#type-symbolizer">symbolizer</a> <a href="../index.html#type-source">source</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>?rooter:<span><a href="../index.html#type-rooter">rooter</a> <a href="../index.html#type-source">source</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span>?reconstructor:<span><a href="../index.html#type-reconstructor">reconstructor</a> <a href="../index.html#type-source">source</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-input">input</a> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="#type-t">t</a> <span class="xref-unresolved">Core_kernel</span>.Or_error.t</span></span></code></div><div class="spec-doc"><p><code>create input</code> creates a project from the provided input source.</p><p>The input code regions are speculatively disassembled and the set of basic blocks is determined, using the algorithm described in <a href="../Disasm/Driver/index.html"><code>Disasm.Driver</code></a>. After that the concrete whole program control-flow graph (CFG) is built, which can be accessed with the <a href="#val-disasm"><code>Project.disasm</code></a> function. The whole program CFG is then partitioned into a set of subroutines using the dominators analsysis, see <a href="../Disasm/Subroutines/index.html"><code>Disasm.Subroutines</code></a> for details. Based on this partition a symbol table, which is a set of a subroutines control-flow graphs, is built. The symbol table, which can be accessed with <a href="#val-symbols"><code>Project.symbols</code></a>, also contains information about the interprocedural control flow. Finally, the symbol table is translated into the intermediate representation, which can be accessed using the <a href="#val-program"><code>Project.program</code></a> function. The whole process is pictured below.</p><pre>                         ---------------------
                        (    Disassembling    )
                         ---------------------
                                  |
                        +---------------------+
                        |                     |
                        |  All instructions   |
                        |  and basic blocks   |
                        |                     |
                        +---------------------+
                                  |
                         ---------------------
                        ( CFG  reconstruction )
                         ---------------------
                                  |
                        +---------------------+
                        |                     |
                        |  The whole program  |
                        |  control-flow graph |
                        |                     |
                        +---------------------+
                                  |
                         ---------------------
                        (    Partitioning     )
                         ---------------------
                                  |
                        +---------------------+
                        |                     |
                        | The quotient set of |
                        |    basic  blocks    |
                        |                     |
                        +---------------------+
                                  |
                         ---------------------
                        ( Constructing Symtab )
                         ---------------------
                                  |
                        +---------------------+
                        |                     |
                        |   The symbol table  |
                        |  and the  callgraph |
                        |                     |
                        +---------------------+
                                  |
                         ---------------------
                        (  IR Reconstruction  )
                         ---------------------
                                  |
                        +---------------------+
                        |                     |
                        |    The IR of the    |
                        |   binary  program   |
                        |                     |
                        +---------------------+</pre><p>The disassembling process is fully integrated with the knowledge base. If the input source provides information about symbols and their location, then this information will be automatically reflected to the knowledge base.</p><p>The <code>brancher</code>, <code>symbolizer</code>, and <code>rooter</code> parameters are ignored since 2.0.0 and their information could be reflected to the knowledge base using, correspondingly, <a href="../Brancher/index.html#val-provide"><code>Brancher.provide</code></a>, <a href="../Symbolizer/index.html#val-provide"><code>Symbolizer.provide</code></a>, and <a href="../Rooter/index.html#val-provide"><code>Rooter.provide</code></a> functions.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">state</span> <p>if specified then the provided <code>state</code> will be used as the initial state</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">package</span> <p>if specified, then all symbols during the disassembly will be created (interned) in the specified package.</p></li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.0.0 the state parameter is added</li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.0.0 the parameter [disassembler] is unused</li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.0.0 the parameter [brancher] is unused</li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.0.0 the parameter [symbolizer] is unused</li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.0.0 the parameter [rooter] is unused</li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.0.0 the parameter [reconstructor] is unused</li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.2.0 the parameter [package] is added</li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.6.0 if [input] consists of library files in addition</li></ul><p>to the main binary, then the accessors to the state of the project reflect that of the main binary, except for <code>program</code>, which contains the code of both the main program and the library programs linked together.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-empty" class="anchored"><a href="#val-empty" class="anchor"></a><code><span><span class="keyword">val</span> empty : <span><a href="../../../../bap-core-theory/Bap_core_theory/Theory/Target/index.html#type-t">Bap_core_theory.Theory.Target.t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>empty target</code> creates a for the given <code>target</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-arch" class="anchored"><a href="#val-arch" class="anchor"></a><code><span><span class="keyword">val</span> arch : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-arch">arch</a></span></code></div><div class="spec-doc"><p><code>arch project</code> reveals the architecture of a loaded file</p><ul class="at-tags"><li class="deprecated"><span class="at-tag">deprecated</span> <p>use <code>target project</code> instead.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-target" class="anchored"><a href="#val-target" class="anchor"></a><code><span><span class="keyword">val</span> target : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../bap-core-theory/Bap_core_theory/Theory/Target/index.html#type-t">Bap_core_theory.Theory.Target.t</a></span></code></div><div class="spec-doc"><p><code>target project</code> returns the target system of the project.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.2.0</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-specification" class="anchored"><a href="#val-specification" class="anchor"></a><code><span><span class="keyword">val</span> specification : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../../../../ogre/Ogre/index.html#type-doc">Ogre.doc</a></span></code></div><div class="spec-doc"><p><code>specification p</code> returns the specification of the binary.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.2.0</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-state" class="anchored"><a href="#val-state" class="anchor"></a><code><span><span class="keyword">val</span> state : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-state">state</a></span></code></div><div class="spec-doc"><p><code>state project</code> returns the core state of the <code>project</code>.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.0.0</li></ul><p><code>disasm project</code> returns results of disassembling</p></div></div><div class="odoc-spec"><div class="spec value" id="val-disasm" class="anchored"><a href="#val-disasm" class="anchor"></a><code><span><span class="keyword">val</span> disasm : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-disasm">disasm</a></span></code></div><div class="spec-doc"><p><code>disasm project</code> returns results of disassembling</p></div></div><div class="odoc-spec"><div class="spec value" id="val-program" class="anchored"><a href="#val-program" class="anchor"></a><code><span><span class="keyword">val</span> program : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-program">program</a> <a href="../index.html#type-term">term</a></span></span></code></div><div class="spec-doc"><p><code>program project</code> returns a program lifted into <a href="../index.html#sema">IR</a></p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_program" class="anchored"><a href="#val-with_program" class="anchor"></a><code><span><span class="keyword">val</span> with_program : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="../index.html#type-program">program</a> <a href="../index.html#type-term">term</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>with_program project program</code> updates a project program</p></div></div><div class="odoc-spec"><div class="spec value" id="val-map_program" class="anchored"><a href="#val-map_program" class="anchor"></a><code><span><span class="keyword">val</span> map_program : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span>f:<span>( <span><span><a href="../index.html#type-program">program</a> <a href="../index.html#type-term">term</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-program">program</a> <a href="../index.html#type-term">term</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>map_program t ~f</code> maps the IR representation of the program with function <code>f</code>.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.6.0 the program is no longer lazily computed.</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-symbols" class="anchored"><a href="#val-symbols" class="anchor"></a><code><span><span class="keyword">val</span> symbols : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-symtab">symtab</a></span></code></div><div class="spec-doc"><p><code>symbols t</code> returns reconstructed symbol table</p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_symbols" class="anchored"><a href="#val-with_symbols" class="anchor"></a><code><span><span class="keyword">val</span> with_symbols : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-symtab">symtab</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>with_symbols project symbols</code> updates <code>project</code> symbols</p></div></div><div class="odoc-spec"><div class="spec value" id="val-storage" class="anchored"><a href="#val-storage" class="anchor"></a><code><span><span class="keyword">val</span> storage : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="../index.html#type-dict">dict</a></span></code></div><div class="spec-doc"><p>returns an attribute storage of the project</p></div></div><div class="odoc-spec"><div class="spec value" id="val-with_storage" class="anchored"><a href="#val-with_storage" class="anchor"></a><code><span><span class="keyword">val</span> with_storage : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-dict">dict</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>updates the attribute storage</p></div></div><div class="odoc-spec"><div class="spec value" id="val-memory" class="anchored"><a href="#val-memory" class="anchor"></a><code><span><span class="keyword">val</span> memory : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-value">value</a> <a href="../index.html#type-memmap">memmap</a></span></span></code></div><div class="spec-doc"><p><code>memory t</code> returns the memory as an interval tree marked with arbitrary values.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-memory_slot" class="anchored"><a href="#val-memory_slot" class="anchor"></a><code><span><span class="keyword">val</span> memory_slot : 
  <span><span>( <a href="../../../../bap-core-theory/Bap_core_theory/Theory/Unit/index.html#type-cls">Bap_core_theory.Theory.Unit.cls</a>, <span><a href="../index.html#type-value">value</a> <a href="../index.html#type-memmap">memmap</a></span> )</span> <a href="../../../../bap-knowledge/Bap_knowledge/Knowledge/index.html#type-slot">Bap_core_theory.KB.slot</a></span></span></code></div><div class="spec-doc"><p>the memory of the unit in the knowledge base.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 2.2.0</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-tag_memory" class="anchored"><a href="#val-tag_memory" class="anchor"></a><code><span><span class="keyword">val</span> tag_memory : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-mem">mem</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../index.html#type-tag">tag</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>tag_memory project region tag value</code> tags a given <code>region</code> of memory in <code>project</code> with a given <code>tag</code> and <code>value</code>. Example: <code>Project.tag_memory project tained color red</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-substitute" class="anchored"><a href="#val-substitute" class="anchor"></a><code><span><span class="keyword">val</span> substitute : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-mem">mem</a> <span class="arrow">&#45;&gt;</span></span> <span><span>string <a href="../index.html#type-tag">tag</a></span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>substitute p region tag value</code> is like <a href="#val-tag_memory">tag_memory</a>, but it will also apply substitutions in the provided string value, as per OCaml standard library's <code>Buffer.add_substitute</code> function.</p><p>Example: </p><pre><code>Project.substitute project comment &quot;$symbol starts at $symbol_addr&quot;</code></pre><p>The following substitutions are supported:</p><ul><li><code>$section{_name,_addr,_min_addr,_max_addr}</code> - name of region of file to which it belongs. For example, in ELF this name will correspond to the section name</li></ul><ul><li><code>$symbol{_name,_addr,_min_addr,_max_addr}</code> - name or address of the symbol to which this memory belongs</li></ul><ul><li><code>$asm</code> - assembler listing of the memory region</li></ul><ul><li><code>$bil</code> - BIL code of the tagged memory region</li></ul><ul><li><code>$block{_name,_addr,_min_addr,_max_addr}</code> - name or address of a basic block to which this region belongs</li></ul><ul><li><code>$min_addr, $addr</code> - starting address of a memory region</li></ul><ul><li><code>$max_addr</code> - address of the last byte of a memory region.</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-with_memory" class="anchored"><a href="#val-with_memory" class="anchor"></a><code><span><span class="keyword">val</span> with_memory : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><a href="../index.html#type-value">value</a> <a href="../index.html#type-memmap">memmap</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>with_memory project</code> updates project memory. It is recommended to use <a href="#val-tag_memory"><code>tag_memory</code></a> and <a href="#val-substitute"><code>substitute</code></a> instead of this function, if possible.</p></div></div><h4 id="extensible-record"><a href="#extensible-record" class="anchor"></a>Extensible record</h4><p>Project can also be viewed as an extensible record, where one can store arbitrary values. Example,</p><pre><code>let p = Project.set project color `green</code></pre><p>This will set field <code>color</code> to a value <code>`green</code>.</p><div class="odoc-spec"><div class="spec value" id="val-set" class="anchored"><a href="#val-set" class="anchor"></a><code><span><span class="keyword">val</span> set : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../index.html#type-tag">tag</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>set project field value</code> sets a <code>field</code> to a give value. If <code>field</code> was already set, then new value overrides the old one. Otherwise the field is added.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-get" class="anchored"><a href="#val-get" class="anchor"></a><code><span><span class="keyword">val</span> get : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../index.html#type-tag">tag</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> option</span></span></code></div><div class="spec-doc"><p><code>get project field</code> returns the value of the <code>field</code> if it exists</p></div></div><div class="odoc-spec"><div class="spec value" id="val-has" class="anchored"><a href="#val-has" class="anchor"></a><code><span><span class="keyword">val</span> has : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../index.html#type-tag">tag</a></span> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>has project field</code> checks whether field exists or not. Useful for fields of type unit, that actually isomorphic to bool fields, e.g., <code>if Project.has project mark</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-del" class="anchored"><a href="#val-del" class="anchor"></a><code><span><span class="keyword">val</span> del : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../index.html#type-tag">tag</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>del project attr</code> removes an attribute from a project</p></div></div><div class="odoc-spec"><div class="spec value" id="val-libraries" class="anchored"><a href="#val-libraries" class="anchor"></a><code><span><span class="keyword">val</span> libraries : <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-library">library</a> list</span></span></code></div><div class="spec-doc"><p><code>libraries project</code> returns the shared libraries that were loaded with <code>project</code>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Library" class="anchored"><a href="#module-Library" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Library/index.html">Library</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A library that was loaded alongside the main program.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Info" class="anchored"><a href="#module-Info" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Info/index.html">Info</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Information obtained during project reconstruction.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-State" class="anchored"><a href="#module-State" class="anchor"></a><code><span><span class="keyword">module</span> <a href="State/index.html">State</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The core state of the project.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Input" class="anchored"><a href="#module-Input" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Input/index.html">Input</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Input information.</p></div></div><h4 id="registering-passes"><a href="#registering-passes" class="anchor"></a>Registering passes</h4><p>To add new pass one of the following <code>register_*</code> functions should be called.</p><div class="odoc-spec"><div class="spec type" id="type-pass" class="anchored"><a href="#type-pass" class="anchor"></a><code><span><span class="keyword">type</span> pass</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-register_pass" class="anchored"><a href="#val-register_pass" class="anchor"></a><code><span><span class="keyword">val</span> register_pass : 
  <span>?autorun:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?runonce:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?deps:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?name:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a> )</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>register_pass ?autorun ?runonce ?deps ?name pass</code> registers a <code>pass</code> over a project.</p><p>If <code>autorun</code> is <code>true</code>, then the host program will run this pass automatically. If <code>runonce</code> is true, then for a given project the pass will be run only once. Each repeating attempts to run the pass will be ignored. The <code>runonce</code> parameter defaults to <code>false</code> when <code>autorun</code> is <code>false</code>, and to <code>true</code> otherwise.</p><p>Parameter <code>deps</code> is list of dependencies. Each dependency is a name of a pass, that should be run before the <code>pass</code>. The dependencies will be run in a specified order every time the <code>pass</code> is run.</p><p>To get access to command line arguments use <code>Plugin.argv</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-register_pass'" class="anchored"><a href="#val-register_pass'" class="anchor"></a><code><span><span class="keyword">val</span> register_pass' : 
  <span>?autorun:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?runonce:bool <span class="arrow">&#45;&gt;</span></span>
  <span>?deps:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span>?name:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>( <span><a href="#type-t">t</a> <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>register_pass' pass</code> registers <code>pass</code> that doesn't modify the project effect and is run only for side effect. (See <a href="#val-register_pass"><code>register_pass</code></a>)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-passes" class="anchored"><a href="#val-passes" class="anchor"></a><code><span><span class="keyword">val</span> passes : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-pass">pass</a> list</span></span></code></div><div class="spec-doc"><p><code>passes ()</code> returns all currently registered passes.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find_pass" class="anchored"><a href="#val-find_pass" class="anchor"></a><code><span><span class="keyword">val</span> find_pass : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-pass">pass</a> option</span></span></code></div><div class="spec-doc"><p><code>find_pass name</code> returns a pass with the given name.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-second" class="anchored"><a href="#type-second" class="anchor"></a><code><span><span class="keyword">type</span> second</span><span> = float</span></code></div><div class="spec-doc"><p>time duration in seconds</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Pass" class="anchored"><a href="#module-Pass" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Pass/index.html">Pass</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A program analysis pass.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Collator" class="anchored"><a href="#module-Collator" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Collator/index.html">Collator</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A pass that collates projects.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Analysis" class="anchored"><a href="#module-Analysis" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Analysis/index.html">Analysis</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Knowledge base analyses.</p></div></div></div></body></html>