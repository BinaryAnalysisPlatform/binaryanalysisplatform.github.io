<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Self (bap.Bap.Std.Self)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../../index.html">bap</a> &#x00BB; <a href="../../index.html">Bap</a> &#x00BB; <a href="../index.html">Std</a> &#x00BB; Self</nav><h1>Module <code>Std.Self</code></h1><p>A self reflection.</p><p>This is a generative functor module refers to an information bundled with an application. Use <code>include Self()</code> syntax to bring this definitions to the scope.</p><p>It is designed to be used inside a plugin, but can be used in a standalone program as well (this is usefull, for debugging plugins, by running them as a standalone applications).</p><p>If run in a standalone mode, then field <code>name</code> would be set to <code>Sys.executable_name</code> and <code>argv</code> to <code>Sys.argv</code>.</p></header><h3 class="heading">Parameters</h3><ul></ul><h3 class="heading">Signature</h3><dl><dt class="spec value" id="val-name"><a href="#val-name" class="anchor"></a><code><span class="keyword">val</span> name : string</code></dt><dd><p><code>name of a plugin</code></p></dd></dl><dl><dt class="spec value" id="val-version"><a href="#val-version" class="anchor"></a><code><span class="keyword">val</span> version : string</code></dt><dd><p><code>version number</code></p></dd></dl><dl><dt class="spec value" id="val-doc"><a href="#val-doc" class="anchor"></a><code><span class="keyword">val</span> doc : string</code></dt><dd><p>A short, one-line description</p></dd></dl><dl><dt class="spec value" id="val-argv"><a href="#val-argv" class="anchor"></a><code><span class="keyword">val</span> argv : string array</code></dt><dd><p><code>args name</code> returns an array of arguments designated for a plugin with a given <code>name</code>.</p><p>The arguments will be extracted from <code>Sys.argv</code> array by removing all arguments that doesn't start with <code>--name-</code>. Then, from all command arguments that are left, the <code>--name-</code> prefix is substituted with <code>--</code>. For example, if <code>argv</code> contained <code> [| &quot;bap&quot;; &quot;-lcallgraph&quot;; &quot;--callgraph&quot;
        &quot;--callgraph-help&quot;|]</code> then pass that registered itself under <code>callgraph</code> name will receive the following array of arguments <code> [| &quot;callgraph&quot;; --help |] </code>. That means, that plugins can't accept arguments that are anonymous or short options</p></dd></dl><dl><dt class="spec value" id="val-debug"><a href="#val-debug" class="anchor"></a><code><span class="keyword">val</span> debug : (<span class="type-var">'a</span>, <a href="../../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a>, unit) <a href="../../../../core_kernel/Core_kernel/index.html#type-format">Core_kernel.format</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>debug fmt ...</code> send a debug message</p></dd></dl><dl><dt class="spec value" id="val-info"><a href="#val-info" class="anchor"></a><code><span class="keyword">val</span> info : (<span class="type-var">'a</span>, <a href="../../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a>, unit) <a href="../../../../core_kernel/Core_kernel/index.html#type-format">Core_kernel.format</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>info fmt ...</code> send an info message</p></dd></dl><dl><dt class="spec value" id="val-warning"><a href="#val-warning" class="anchor"></a><code><span class="keyword">val</span> warning : (<span class="type-var">'a</span>, <a href="../../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a>, unit) <a href="../../../../core_kernel/Core_kernel/index.html#type-format">Core_kernel.format</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>warning fmt ...</code> send a warning message</p></dd></dl><dl><dt class="spec value" id="val-error"><a href="#val-error" class="anchor"></a><code><span class="keyword">val</span> error : (<span class="type-var">'a</span>, <a href="../../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a>, unit) <a href="../../../../core_kernel/Core_kernel/index.html#type-format">Core_kernel.format</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p><code>error fmt ...</code> send an error message</p></dd></dl><dl><dt class="spec value" id="val-debug_formatter"><a href="#val-debug_formatter" class="anchor"></a><code><span class="keyword">val</span> debug_formatter : <a href="../../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a></code></dt><dd><p>formatter that sends debug messages</p></dd></dl><dl><dt class="spec value" id="val-info_formatter"><a href="#val-info_formatter" class="anchor"></a><code><span class="keyword">val</span> info_formatter : <a href="../../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a></code></dt><dd><p>formatter that sends info messages</p></dd></dl><dl><dt class="spec value" id="val-warning_formatter"><a href="#val-warning_formatter" class="anchor"></a><code><span class="keyword">val</span> warning_formatter : <a href="../../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a></code></dt><dd><p>formatter that sends warning messages</p></dd></dl><dl><dt class="spec value" id="val-error_formatter"><a href="#val-error_formatter" class="anchor"></a><code><span class="keyword">val</span> error_formatter : <a href="../../../../ocaml/Stdlib/Format/index.html#type-formatter">Stdlib.Format.formatter</a></code></dt><dd><p>formatter that sends error messages</p></dd></dl><dl><dt class="spec value" id="val-report_progress"><a href="#val-report_progress" class="anchor"></a><code><span class="keyword">val</span> report_progress : ?&#8288;task:string <span>&#45;&gt;</span> ?&#8288;note:string <span>&#45;&gt;</span> ?&#8288;stage:int <span>&#45;&gt;</span> ?&#8288;total:int <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> unit</code></dt><dd><p><code>report_progress ~task:t ~note:n ~state:s ~total:s' ()</code> reports a progress of the task <code>t</code>.</p><p>Reports that the task <code>t</code> made a progress to the stage <code>s</code> out the total number of stages <code>s'</code>. The note <code>n</code> may provide an additional textual explanation of the current stage. The report doesn't mean that the stage is finished, but rather that it is entered. Thus for <code>s'</code> stages we expect to recieve <code>s'-1</code> reports. (This approach works fine with functional programming and iterating - as in functional programming it is more convinient to report before computation, and during the indexed iteration the index of the last element is one less than the total number of elements).</p><p>All parameters are optional, and have the following default values if not specified:</p><dl><dt>parameter task</dt><dd><p>defaults to the plugin <code>name</code>;</p></dd></dl><dl><dt>parameter note</dt><dd><p>defaults to the empty string;</p></dd></dl><dl><dt>parameter stage</dt><dd><p>defaults to <code>None</code></p></dd></dl><dl><dt>parameter total</dt><dd><p>defaults to <code>None</code> or to the last value of this parameter for the given task.</p><p>The <code>report_progress</code> bar is an easy way to provide some feedback to the system, either in the form of a progress (if the total number of stages is known) or in the form of a friendly ping back.</p><p>The mechanism should be used by analyses that expect to take some time to complete. Usually, one plugin implements only one task, so the task name may be omitted. If an analysis is built from several tasks, then they can be represented as subtasks, and the main task should represent the whole work.</p><p>Example:</p><pre><code class="ml">let find_interesting_points prog =
  report_progress ~task:&quot;discover&quot; ~total:(Term.length sub_t prog) ();
  Term.enum sub_t prog |&gt; Seq.concat_mapi ~f:(fun stage sub -&gt;
      report_progress ~note:(Sub.name sub) ~task:&quot;discover&quot; ~stage ();
      interesting_points_of_sub sub)

let check_interesting_points points =
  report_progress ~task:&quot;checking&quot; ~total:(Seq.length points) ();
  Seq.iteri ~f:(fun stage p -&gt;
      report_progress ~note:(Point.name p) ~task:&quot;checking&quot; ~stage ();
      check_point p)</code></pre></dd></dl></dd></dl><dl><dt class="spec module" id="module-Config"><a href="#module-Config" class="anchor"></a><code><span class="keyword">module</span> <a href="Config/index.html">Config</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>This module allows plugins to access BAP configuration variables.</p></dd></dl></div></body></html>