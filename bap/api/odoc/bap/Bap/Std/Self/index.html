<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Self (bap.Bap.Std.Self)</title><link rel="stylesheet" href="../../../../_odoc-theme/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">bap</a> &#x00BB; <a href="../../index.html">Bap</a> &#x00BB; <a href="../index.html">Std</a> &#x00BB; Self</nav><header class="odoc-preamble"><h1>Module <code><span>Std.Self</span></code></h1><p>A self reflection.</p><p>This is a generative functor module refers to an information bundled with an application. Use <code>include Self()</code> syntax to bring this definitions to the scope.</p><p>It is designed to be used inside a plugin, but can be used in a standalone program as well (this is useful, for debugging plugins, by running them as a standalone applications).</p><p>If run in a standalone mode, then field <code>name</code> would be set to <code>Sys.executable_name</code> and <code>argv</code> to <code>Sys.argv</code>.</p><p>Note: this module uses the <code>Event.Self()</code> module and extends it with several more fields, such as <code>name</code>, <code>version</code>, <code>doc</code>, and <code>argv</code>. It is recommended to use <code>Event.Self()</code> aka <code>Bap_main_event.Self()</code> instead.</p></header><nav class="odoc-toc"><ul><li><a href="#parameters">Parameters</a></li><li><a href="#signature">Signature</a></li></ul></nav><div class="odoc-content"><h2 id="parameters"><a href="#parameters" class="anchor"></a>Parameters</h2><h2 id="signature"><a href="#signature" class="anchor"></a>Signature</h2><div class="odoc-spec"><div class="spec value" id="val-name" class="anchored"><a href="#val-name" class="anchor"></a><code><span><span class="keyword">val</span> name : string</span></code></div><div class="spec-doc"><p><code>name of a plugin</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-version" class="anchored"><a href="#val-version" class="anchor"></a><code><span><span class="keyword">val</span> version : string</span></code></div><div class="spec-doc"><p><code>version number</code></p></div></div><div class="odoc-spec"><div class="spec value" id="val-doc" class="anchored"><a href="#val-doc" class="anchor"></a><code><span><span class="keyword">val</span> doc : string</span></code></div><div class="spec-doc"><p>A short, one-line description</p></div></div><div class="odoc-spec"><div class="spec value" id="val-argv" class="anchored"><a href="#val-argv" class="anchor"></a><code><span><span class="keyword">val</span> argv : <span>string array</span></span></code></div><div class="spec-doc"><p><code>args name</code> returns an array of arguments designated for a plugin with a given <code>name</code>.</p><p>The arguments will be extracted from <code>Sys.argv</code> array by removing all arguments that doesn't start with <code>--name-</code>. Then, from all command arguments that are left, the <code>--name-</code> prefix is substituted with <code>--</code>. For example, if <code>argv</code> contained <code> [| &quot;bap&quot;; &quot;-lcallgraph&quot;; &quot;--callgraph&quot;
        &quot;--callgraph-help&quot;|]</code> then pass that registered itself under <code>callgraph</code> name will receive the following array of arguments <code> [| &quot;callgraph&quot;; --help |] </code>. That means, that plugins can't accept arguments that are anonymous or short options</p></div></div><div class="odoc-spec"><div class="spec value" id="val-debug" class="anchored"><a href="#val-debug" class="anchor"></a><code><span><span class="keyword">val</span> debug : <span><span><span>( <span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit )</span> <span class="xref-unresolved">Core_kernel</span>.format</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>debug fmt ...</code> send a debug message</p></div></div><div class="odoc-spec"><div class="spec value" id="val-info" class="anchored"><a href="#val-info" class="anchor"></a><code><span><span class="keyword">val</span> info : <span><span><span>( <span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit )</span> <span class="xref-unresolved">Core_kernel</span>.format</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>info fmt ...</code> send an info message</p></div></div><div class="odoc-spec"><div class="spec value" id="val-warning" class="anchored"><a href="#val-warning" class="anchor"></a><code><span><span class="keyword">val</span> warning : <span><span><span>( <span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit )</span> <span class="xref-unresolved">Core_kernel</span>.format</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>warning fmt ...</code> send a warning message</p></div></div><div class="odoc-spec"><div class="spec value" id="val-error" class="anchored"><a href="#val-error" class="anchor"></a><code><span><span class="keyword">val</span> error : <span><span><span>( <span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit )</span> <span class="xref-unresolved">Core_kernel</span>.format</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>error fmt ...</code> send an error message</p></div></div><div class="odoc-spec"><div class="spec value" id="val-debug_formatter" class="anchored"><a href="#val-debug_formatter" class="anchor"></a><code><span><span class="keyword">val</span> debug_formatter : <span class="xref-unresolved">Stdlib</span>.Format.formatter</span></code></div><div class="spec-doc"><p>formatter that sends debug messages</p></div></div><div class="odoc-spec"><div class="spec value" id="val-info_formatter" class="anchored"><a href="#val-info_formatter" class="anchor"></a><code><span><span class="keyword">val</span> info_formatter : <span class="xref-unresolved">Stdlib</span>.Format.formatter</span></code></div><div class="spec-doc"><p>formatter that sends info messages</p></div></div><div class="odoc-spec"><div class="spec value" id="val-warning_formatter" class="anchored"><a href="#val-warning_formatter" class="anchor"></a><code><span><span class="keyword">val</span> warning_formatter : <span class="xref-unresolved">Stdlib</span>.Format.formatter</span></code></div><div class="spec-doc"><p>formatter that sends warning messages</p></div></div><div class="odoc-spec"><div class="spec value" id="val-error_formatter" class="anchored"><a href="#val-error_formatter" class="anchor"></a><code><span><span class="keyword">val</span> error_formatter : <span class="xref-unresolved">Stdlib</span>.Format.formatter</span></code></div><div class="spec-doc"><p>formatter that sends error messages</p></div></div><div class="odoc-spec"><div class="spec value" id="val-report_progress" class="anchored"><a href="#val-report_progress" class="anchor"></a><code><span><span class="keyword">val</span> report_progress : 
  <span>?task:string <span class="arrow">&#45;&gt;</span></span>
  <span>?note:string <span class="arrow">&#45;&gt;</span></span>
  <span>?stage:int <span class="arrow">&#45;&gt;</span></span>
  <span>?total:int <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code>report_progress ~task:t ~note:n ~state:s ~total:s' ()</code> reports a progress of the task <code>t</code>.</p><p>Reports that the task <code>t</code> made a progress to the stage <code>s</code> out the total number of stages <code>s'</code>. The note <code>n</code> may provide an additional textual explanation of the current stage. The report doesn't mean that the stage is finished, but rather that it is entered. Thus for <code>s'</code> stages we expect to receive <code>s'-1</code> reports. (This approach works fine with functional programming and iterating - as in functional programming it is more convenient to report before computation, and during the indexed iteration the index of the last element is one less than the total number of elements).</p><p>All parameters are optional, and have the following default values if not specified:</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">task</span> <p>defaults to the plugin <code>name</code>;</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">note</span> <p>defaults to the empty string;</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">stage</span> <p>defaults to <code>None</code></p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">total</span> <p>defaults to <code>None</code> or to the last value of this parameter for the given task.</p><p>The <code>report_progress</code> bar is an easy way to provide some feedback to the system, either in the form of a progress (if the total number of stages is known) or in the form of a friendly ping back.</p><p>The mechanism should be used by analyses that expect to take some time to complete. Usually, one plugin implements only one task, so the task name may be omitted. If an analysis is built from several tasks, then they can be represented as subtasks, and the main task should represent the whole work.</p><p>Example:</p><pre><code>let find_interesting_points prog =
  report_progress ~task:&quot;discover&quot; ~total:(Term.length sub_t prog) ();
  Term.enum sub_t prog |&gt; Seq.concat_mapi ~f:(fun stage sub -&gt;
      report_progress ~note:(Sub.name sub) ~task:&quot;discover&quot; ~stage ();
      interesting_points_of_sub sub)

let check_interesting_points points =
  report_progress ~task:&quot;checking&quot; ~total:(Seq.length points) ();
  Seq.iteri ~f:(fun stage p -&gt;
      report_progress ~note:(Point.name p) ~task:&quot;checking&quot; ~stage ();
      check_point p)</code></pre></li></ul></div></div><div class="odoc-spec"><div class="spec module" id="module-Config" class="anchored"><a href="#module-Config" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Config/index.html">Config</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>This module allows plugins to access BAP configuration variables.</p></div></div></div></body></html>